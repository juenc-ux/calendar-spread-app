{"ast":null,"code":"import{useState,useEffect}from'react';import{Download,Moon,Sun}from'lucide-react';import{Analytics}from'@vercel/analytics/react';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function ForwardVolCalculator(){const[date1,setDate1]=useState('2025-10-24');const[date2,setDate2]=useState('2025-10-31');const[iv1,setIv1]=useState('50');const[iv2,setIv2]=useState('40');const[spotPrice,setSpotPrice]=useState('100');const[strikePrice,setStrikePrice]=useState('100');const[riskFreeRate,setRiskFreeRate]=useState('4');const[dividend,setDividend]=useState('0');const[result,setResult]=useState(null);const[darkMode,setDarkMode]=useState(false);const[tradeHistory,setTradeHistory]=useState([]);const[callPriceSlider,setCallPriceSlider]=useState(null);const[putPriceSlider,setPutPriceSlider]=useState(null);const[adjustedFFCall,setAdjustedFFCall]=useState(null);const[adjustedFFPut,setAdjustedFFPut]=useState(null);const[pricingModel,setPricingModel]=useState('blackscholes');const[ticker,setTicker]=useState('');const[loading,setLoading]=useState(false);const[loadError,setLoadError]=useState(null);const[apiKey,setApiKey]=useState(localStorage.getItem('polygonKey')||'');const[showTickerDropdown,setShowTickerDropdown]=useState(false);const[filteredTickers,setFilteredTickers]=useState([]);const[volumeCallT1,setVolumeCallT1]=useState(null);const[volumeCallT2,setVolumeCallT2]=useState(null);const[oiCallT1,setOiCallT1]=useState(null);const[oiCallT2,setOiCallT2]=useState(null);const[availableExpirations,setAvailableExpirations]=useState(()=>{// Default: next 50 Fridays\nconst today=new Date();const fridays=[];let currentDate=new Date(today);while(fridays.length<50){currentDate.setDate(currentDate.getDate()+1);if(currentDate.getDay()===5){fridays.push(currentDate.toISOString().split('T')[0]);}}return fridays;});const[marketCap,setMarketCap]=useState(null);const[avgOptionsVolume,setAvgOptionsVolume]=useState(null);const[recommendedSpreads,setRecommendedSpreads]=useState([]);const[scanningForSpreads,setScanningForSpreads]=useState(false);const[nextEarningsDate,setNextEarningsDate]=useState(null);const[earningsTime,setEarningsTime]=useState(null);const[earningsConflict,setEarningsConflict]=useState(null);const[currentUser,setCurrentUser]=useState(()=>{return localStorage.getItem('currentUser')||'Nils';});const[hidePostEarningsSpreads,setHidePostEarningsSpreads]=useState(false);const[marketScanResults,setMarketScanResults]=useState([]);const[loadingMarketScan,setLoadingMarketScan]=useState(false);const[lastMarketScan,setLastMarketScan]=useState(null);const[minOpenInterest,setMinOpenInterest]=useState(100);const[minVolume,setMinVolume]=useState(0);const[maxDTEGap,setMaxDTEGap]=useState(200);// Maximum gap between expirations in days\nconst[recentTickers,setRecentTickers]=useState(()=>{const saved=localStorage.getItem(\"recentTickers_\".concat(currentUser));return saved?JSON.parse(saved):[];});const[watchlist,setWatchlist]=useState(()=>{const saved=localStorage.getItem(\"watchlist_\".concat(currentUser));return saved?JSON.parse(saved):[];});// Reload user-specific data when user changes\nuseEffect(()=>{const savedWatchlist=localStorage.getItem(\"watchlist_\".concat(currentUser));const savedRecent=localStorage.getItem(\"recentTickers_\".concat(currentUser));setWatchlist(savedWatchlist?JSON.parse(savedWatchlist):[]);setRecentTickers(savedRecent?JSON.parse(savedRecent):[]);},[currentUser]);// Popular US stocks for autocomplete\nconst popularStocks=[{symbol:'AAPL',name:'Apple Inc.'},{symbol:'MSFT',name:'Microsoft Corporation'},{symbol:'GOOGL',name:'Alphabet Inc.'},{symbol:'AMZN',name:'Amazon.com Inc.'},{symbol:'NVDA',name:'NVIDIA Corporation'},{symbol:'META',name:'Meta Platforms Inc.'},{symbol:'TSLA',name:'Tesla Inc.'},{symbol:'BRK.B',name:'Berkshire Hathaway Inc.'},{symbol:'V',name:'Visa Inc.'},{symbol:'JPM',name:'JPMorgan Chase & Co.'},{symbol:'WMT',name:'Walmart Inc.'},{symbol:'JNJ',name:'Johnson & Johnson'},{symbol:'MA',name:'Mastercard Inc.'},{symbol:'PG',name:'Procter & Gamble Co.'},{symbol:'UNH',name:'UnitedHealth Group Inc.'},{symbol:'HD',name:'Home Depot Inc.'},{symbol:'DIS',name:'Walt Disney Co.'},{symbol:'BAC',name:'Bank of America Corp.'},{symbol:'ADBE',name:'Adobe Inc.'},{symbol:'CRM',name:'Salesforce Inc.'},{symbol:'NFLX',name:'Netflix Inc.'},{symbol:'CMCSA',name:'Comcast Corporation'},{symbol:'XOM',name:'Exxon Mobil Corporation'},{symbol:'COST',name:'Costco Wholesale Corp.'},{symbol:'PEP',name:'PepsiCo Inc.'},{symbol:'TMO',name:'Thermo Fisher Scientific Inc.'},{symbol:'ABT',name:'Abbott Laboratories'},{symbol:'NKE',name:'Nike Inc.'},{symbol:'CSCO',name:'Cisco Systems Inc.'},{symbol:'ORCL',name:'Oracle Corporation'},{symbol:'AMD',name:'Advanced Micro Devices Inc.'},{symbol:'INTC',name:'Intel Corporation'},{symbol:'QCOM',name:'Qualcomm Inc.'},{symbol:'TXN',name:'Texas Instruments Inc.'},{symbol:'AVGO',name:'Broadcom Inc.'},{symbol:'CVX',name:'Chevron Corporation'},{symbol:'KO',name:'Coca-Cola Co.'},{symbol:'MCD',name:'McDonald\\'s Corporation'},{symbol:'PYPL',name:'PayPal Holdings Inc.'},{symbol:'UBER',name:'Uber Technologies Inc.'},{symbol:'BA',name:'Boeing Co.'},{symbol:'CAT',name:'Caterpillar Inc.'},{symbol:'GE',name:'General Electric Co.'},{symbol:'F',name:'Ford Motor Co.'},{symbol:'GM',name:'General Motors Co.'},{symbol:'SBUX',name:'Starbucks Corporation'},{symbol:'PLTR',name:'Palantir Technologies Inc.'},{symbol:'COIN',name:'Coinbase Global Inc.'},{symbol:'SQ',name:'Block Inc.'},{symbol:'SNOW',name:'Snowflake Inc.'},{symbol:'SPY',name:'SPDR S&P 500 ETF Trust'},{symbol:'QQQ',name:'Invesco QQQ Trust'},{symbol:'IWM',name:'iShares Russell 2000 ETF'},{symbol:'DIA',name:'SPDR Dow Jones Industrial Average ETF'},{symbol:'VTI',name:'Vanguard Total Stock Market ETF'},{symbol:'VOO',name:'Vanguard S&P 500 ETF'},{symbol:'GLD',name:'SPDR Gold Trust'},{symbol:'SLV',name:'iShares Silver Trust'},{symbol:'TLT',name:'iShares 20+ Year Treasury Bond ETF'},{symbol:'XLE',name:'Energy Select Sector SPDR Fund'},{symbol:'XLF',name:'Financial Select Sector SPDR Fund'},{symbol:'XLK',name:'Technology Select Sector SPDR Fund'}];const handleTickerChange=value=>{const upper=value.toUpperCase();setTicker(upper);if(upper.length>0){const matches=popularStocks.filter(stock=>stock.symbol.startsWith(upper)||stock.name.toUpperCase().includes(upper)).slice(0,10);setFilteredTickers(matches);setShowTickerDropdown(matches.length>0);}else{setFilteredTickers([]);setShowTickerDropdown(false);}};const selectTicker=symbol=>{setTicker(symbol);setShowTickerDropdown(false);setFilteredTickers([]);};const loadDemoData=()=>{// Demo data for SPY\nsetTicker('SPY');setSpotPrice('580.25');setStrikePrice('580');setDate1('2025-10-24');setDate2('2025-10-31');setIv1('12.5');setIv2('11.8');setRiskFreeRate('4.5');setDividend('1.2');// Auto-calculate\nsetTimeout(()=>calculateResults(),100);};// Add ticker to recent tickers list\nconst addToRecentTickers=symbol=>{const upperSymbol=symbol.toUpperCase().trim();const updated=[upperSymbol,...recentTickers.filter(t=>t!==upperSymbol)].slice(0,6);setRecentTickers(updated);localStorage.setItem(\"recentTickers_\".concat(currentUser),JSON.stringify(updated));};const addToWatchlist=function(symbol,bestFF,hasEarnings,earningsDate,price){let spreadData=arguments.length>5&&arguments[5]!==undefined?arguments[5]:null;const upperSymbol=symbol.toUpperCase().trim();const updated=[{symbol:upperSymbol,bestFF:bestFF,hasEarnings:hasEarnings,earningsDate:earningsDate,price:price,spreadData:spreadData,// Calendar spread details if applicable\nlastUpdated:new Date().toISOString()},...watchlist.filter(item=>item.symbol!==upperSymbol)].slice(0,10);// Keep max 10 items\nsetWatchlist(updated);localStorage.setItem(\"watchlist_\".concat(currentUser),JSON.stringify(updated));};const addSpreadToWatchlist=spread=>{const spreadId=\"\".concat(spread.date1,\"-\").concat(spread.date2,\"-\").concat(spread.strike);const updated=[{id:spreadId,type:'spread',symbol:ticker,date1:spread.date1,date2:spread.date2,dte1:spread.dte1,dte2:spread.dte2,ff:spread.ff,strike:spread.strike,iv1:spread.iv1,iv2:spread.iv2,callSpread:spread.callSpread,lastUpdated:new Date().toISOString()},...watchlist.filter(item=>item.id!==spreadId)].slice(0,10);// Keep max 10 items\nsetWatchlist(updated);localStorage.setItem(\"watchlist_\".concat(currentUser),JSON.stringify(updated));};const fetchMarketScan=async()=>{console.log('🔍 Starting market scan...');setLoadingMarketScan(true);try{console.log('📡 Fetching /api/market-scan...');const response=await fetch('/api/market-scan');console.log('📡 Response status:',response.status);const data=await response.json();console.log('📡 Response data:',data);if(data.success){console.log('✅ Market scan successful, setting results:',data.results.length,'stocks');setMarketScanResults(data.results);setLastMarketScan(data.lastScan);}else{console.log('❌ Market scan failed:',data);}}catch(error){console.error('❌ Error fetching market scan:',error);}setLoadingMarketScan(false);console.log('🔍 Market scan completed');};const fetchOptionData=async tickerSymbol=>{if(!tickerSymbol||tickerSymbol.trim()===''){setLoadError('Please enter a ticker symbol');return;}if(!apiKey||apiKey.trim()===''){setLoadError('Please enter your Polygon.io API key');return;}setLoading(true);setLoadError(null);// Reset earnings data when loading new ticker\nsetNextEarningsDate(null);setEarningsTime(null);try{const symbol=tickerSymbol.toUpperCase().trim();console.log('Fetching data for:',symbol);// Save API key to localStorage\nlocalStorage.setItem('polygonKey',apiKey);// 1. Get current price (real-time data)\nconst today=new Date();const quoteUrl=\"https://api.polygon.io/v2/aggs/ticker/\".concat(symbol,\"/prev?adjusted=true&apiKey=\").concat(apiKey);console.log('Fetching current price from Polygon.io...');const quoteResponse=await fetch(quoteUrl);if(!quoteResponse.ok){throw new Error(\"API Error (\".concat(quoteResponse.status,\"). Check your API key.\"));}const quoteData=await quoteResponse.json();console.log('Quote data:',quoteData);if(quoteData.status==='ERROR'){throw new Error(quoteData.error||'Invalid ticker symbol');}if(!quoteData.results||quoteData.results.length===0){throw new Error('No price data available for this ticker');}const result=quoteData.results[0];const currentPrice=result.c;// closing price\nif(!currentPrice||currentPrice<=0){throw new Error('No valid price data available');}setSpotPrice(currentPrice.toFixed(2));// 2. Get ticker details (market cap)\ntry{const tickerDetailsUrl=\"https://api.polygon.io/v3/reference/tickers/\".concat(symbol,\"?apiKey=\").concat(apiKey);const tickerDetailsResponse=await fetch(tickerDetailsUrl);if(tickerDetailsResponse.ok){var _tickerDetailsData$re;const tickerDetailsData=await tickerDetailsResponse.json();if((_tickerDetailsData$re=tickerDetailsData.results)!==null&&_tickerDetailsData$re!==void 0&&_tickerDetailsData$re.market_cap){setMarketCap(tickerDetailsData.results.market_cap);}}}catch(error){console.log('Could not load market cap:',error);}// 3. Load available expiration dates using Options Contracts Reference API\nlet expirationDates=[];try{console.log('Fetching available expiration dates...');let contractsUrl=\"https://api.polygon.io/v3/reference/options/contracts?underlying_ticker=\".concat(symbol,\"&expired=false&limit=1000&apiKey=\").concat(apiKey);const allDates=new Set();// Fetch all pages (pagination)\nwhile(contractsUrl){const contractsResponse=await fetch(contractsUrl);if(contractsResponse.ok){const contractsData=await contractsResponse.json();if(contractsData.results&&contractsData.results.length>0){contractsData.results.forEach(contract=>{if(contract.expiration_date){allDates.add(contract.expiration_date);}});}// Check for next page\ncontractsUrl=contractsData.next_url?\"\".concat(contractsData.next_url,\"&apiKey=\").concat(apiKey):null;}else{break;}}// Sort dates and filter future dates only\nexpirationDates=Array.from(allDates).sort().filter(date=>new Date(date)>today);setAvailableExpirations(expirationDates);console.log(\"Found \".concat(expirationDates.length,\" available expiration dates\"));}catch(error){console.log('Could not load expiration dates:',error);}// 4. Set default dates (use first two available, or calculate Fridays as fallback)\nlet exp1Date,exp2Date;if(expirationDates.length>=2){exp1Date=expirationDates[0];exp2Date=expirationDates[1];setDate1(exp1Date);setDate2(exp2Date);}else{// Fallback: Calculate next two Fridays\nconst fridays=[];let currentDate=new Date(today);while(fridays.length<2){if(currentDate.getDay()===5&&currentDate>today){fridays.push(new Date(currentDate));}currentDate.setDate(currentDate.getDate()+1);}exp1Date=fridays[0].toISOString().split('T')[0];exp2Date=fridays[1].toISOString().split('T')[0];setDate1(exp1Date);setDate2(exp2Date);}// 4.5. Calculate average options volume (20 trading days)\nconst avgVol=await calculateAvgOptionsVolume(symbol,apiKey);if(avgVol!==null){setAvgOptionsVolume(avgVol);}// 4.6. Fetch earnings date\nconsole.log('About to fetch earnings date...');await fetchEarningsDate(symbol,apiKey);console.log('Earnings fetch completed');// 5. Set ATM strike (rounded to nearest $5)\nconst roundedStrike=Math.round(currentPrice/5)*5;setStrikePrice(roundedStrike.toFixed(2));// 6. Try to get options data using Option Chain Snapshot API with date filters\nlet gotRealIV1=false;let gotRealIV2=false;let totalVolume=0;let volumeCount=0;try{// Fetch expiration 1 options with date filter\nconst chain1Url=\"https://api.polygon.io/v3/snapshot/options/\".concat(symbol,\"?expiration_date.gte=\").concat(exp1Date,\"&expiration_date.lte=\").concat(exp1Date,\"&contract_type=call&limit=250&apiKey=\").concat(apiKey);console.log('Fetching options chain for expiration 1...');const chain1Response=await fetch(chain1Url);if(chain1Response.ok){const chain1Data=await chain1Response.json();console.log('Expiration 1 options data:',chain1Data);if(chain1Data.status==='OK'&&chain1Data.results&&chain1Data.results.length>0){// Find ATM call option - closest to rounded strike\nconst atmCall=chain1Data.results.filter(opt=>{var _opt$details;return((_opt$details=opt.details)===null||_opt$details===void 0?void 0:_opt$details.strike_price)&&Math.abs(opt.details.strike_price-roundedStrike)<20;}).sort((a,b)=>Math.abs(a.details.strike_price-roundedStrike)-Math.abs(b.details.strike_price-roundedStrike))[0];if(atmCall){var _atmCall$day;if(atmCall.implied_volatility!==undefined&&atmCall.implied_volatility>0){const iv1Value=(atmCall.implied_volatility*100).toFixed(2);setIv1(iv1Value);gotRealIV1=true;}if(((_atmCall$day=atmCall.day)===null||_atmCall$day===void 0?void 0:_atmCall$day.volume)!==undefined){setVolumeCallT1(atmCall.day.volume);totalVolume+=atmCall.day.volume;volumeCount++;}if(atmCall.open_interest!==undefined){setOiCallT1(atmCall.open_interest);}}// Calculate average volume from all options in this expiration\nchain1Data.results.forEach(opt=>{var _opt$day;if(((_opt$day=opt.day)===null||_opt$day===void 0?void 0:_opt$day.volume)!==undefined&&opt.day.volume>0){totalVolume+=opt.day.volume;volumeCount++;}});}}// Fetch expiration 2 options with date filter\nconst chain2Url=\"https://api.polygon.io/v3/snapshot/options/\".concat(symbol,\"?expiration_date.gte=\").concat(exp2Date,\"&expiration_date.lte=\").concat(exp2Date,\"&contract_type=call&limit=250&apiKey=\").concat(apiKey);console.log('Fetching options chain for expiration 2...');const chain2Response=await fetch(chain2Url);if(chain2Response.ok){const chain2Data=await chain2Response.json();console.log('Expiration 2 options data:',chain2Data);if(chain2Data.status==='OK'&&chain2Data.results&&chain2Data.results.length>0){// Find ATM call option - closest to rounded strike\nconst atmCall=chain2Data.results.filter(opt=>{var _opt$details2;return((_opt$details2=opt.details)===null||_opt$details2===void 0?void 0:_opt$details2.strike_price)&&Math.abs(opt.details.strike_price-roundedStrike)<20;}).sort((a,b)=>Math.abs(a.details.strike_price-roundedStrike)-Math.abs(b.details.strike_price-roundedStrike))[0];if(atmCall){var _atmCall$day2;if(atmCall.implied_volatility!==undefined&&atmCall.implied_volatility>0){const iv2Value=(atmCall.implied_volatility*100).toFixed(2);setIv2(iv2Value);gotRealIV2=true;}if(((_atmCall$day2=atmCall.day)===null||_atmCall$day2===void 0?void 0:_atmCall$day2.volume)!==undefined){setVolumeCallT2(atmCall.day.volume);totalVolume+=atmCall.day.volume;volumeCount++;}if(atmCall.open_interest!==undefined){setOiCallT2(atmCall.open_interest);}}// Calculate average volume from all options in this expiration\nchain2Data.results.forEach(opt=>{var _opt$day2;if(((_opt$day2=opt.day)===null||_opt$day2===void 0?void 0:_opt$day2.volume)!==undefined&&opt.day.volume>0){totalVolume+=opt.day.volume;volumeCount++;}});}}// Calculate and set average options volume\nif(volumeCount>0){const avgVol=Math.round(totalVolume/volumeCount);setAvgOptionsVolume(avgVol);console.log(\"Average options volume: \".concat(avgVol,\" (from \").concat(volumeCount,\" contracts)\"));}// If we didn't get real IV data, use defaults\nif(!gotRealIV1||!gotRealIV2){console.log('Options data not available (expected with free tier), using defaults');if(!gotRealIV1)setIv1('30');if(!gotRealIV2)setIv2('28');}}catch(optError){console.log('Error fetching options data:',optError);// Use reasonable defaults based on historical volatility\nsetIv1('30');setIv2('28');}setLoading(false);setLoadError(null);if(gotRealIV1&&gotRealIV2){console.log('✅ Stock price and real IV data loaded from Polygon.io!');}else{console.log('✅ Stock price loaded! IV values are estimates (upgrade for real IV data)');}// Auto-calculate after loading data\nsetTimeout(()=>calculateResults(),100);// Scan for best calendar spreads\nsetTimeout(()=>scanCalendarSpreads(),500);// Add to recent tickers on successful load\naddToRecentTickers(symbol);}catch(error){console.error('Error fetching option data:',error);setLoadError(error.message||'Failed to load option data');setLoading(false);}};// Fetch next earnings date using our serverless API (bypasses CORS)\nconst fetchEarningsDate=async symbol=>{try{console.log('📊 Fetching earnings date for:',symbol);// Use our serverless API endpoint (works both locally and deployed)\nconst apiUrl=\"/api/earnings?symbol=\".concat(symbol);console.log('Fetching from API:',apiUrl);const response=await fetch(apiUrl);console.log('API response status:',response.status);if(response.ok){const data=await response.json();console.log('API data received:',data);if(data.success&&data.earningsDate){setNextEarningsDate(data.earningsDate);setEarningsTime(data.earningsTime||'Scheduled');console.log('✅ Successfully set earnings date:',data.earningsDate,data.earningsTime);return;}else{console.log('No earnings data in response');}}else{const errorData=await response.json();console.error('API error:',response.status,errorData);}// If no earnings found\nsetNextEarningsDate(null);setEarningsTime(null);console.log('ℹ️ No upcoming earnings found for',symbol);}catch(error){console.error('❌ Error fetching earnings date:',error);setNextEarningsDate(null);setEarningsTime(null);}};// Calculate average TOTAL options volume (puts + calls) over last 20 trading days\nconst calculateAvgOptionsVolume=async(symbol,apiKey)=>{try{console.log('Calculating average TOTAL options volume (puts + calls, 20 days)...');// Calculate last 20 trading days (skip weekends)\nconst tradingDays=[];let currentDate=new Date();while(tradingDays.length<20){currentDate.setDate(currentDate.getDate()-1);const dayOfWeek=currentDate.getDay();// Skip weekends (0 = Sunday, 6 = Saturday)\nif(dayOfWeek!==0&&dayOfWeek!==6){tradingDays.push(currentDate.toISOString().split('T')[0]);}}// Fetch snapshots for all 20 days in parallel (no rate limit!)\nconst promises=tradingDays.map(date=>fetch(\"https://api.polygon.io/v3/snapshot/options/\".concat(symbol,\"?expiration_date=\").concat(date,\"&limit=1000&apiKey=\").concat(apiKey)).then(res=>res.json()).catch(err=>{console.log(\"Failed to fetch snapshot for \".concat(date,\":\"),err);return null;}));const responses=await Promise.all(promises);// Calculate total volume per day, then average across days\nconst dailyVolumes=[];responses.forEach((data,index)=>{if(data!==null&&data!==void 0&&data.results&&data.results.length>0){let dayTotal=0;data.results.forEach(opt=>{var _opt$day3;if((_opt$day3=opt.day)!==null&&_opt$day3!==void 0&&_opt$day3.volume&&opt.day.volume>0){dayTotal+=opt.day.volume;}});if(dayTotal>0){dailyVolumes.push(dayTotal);}}});if(dailyVolumes.length>0){const totalVolume=dailyVolumes.reduce((sum,vol)=>sum+vol,0);const avgDailyVol=Math.round(totalVolume/dailyVolumes.length);console.log(\"Average daily TOTAL options volume (puts + calls): \".concat(avgDailyVol.toLocaleString(),\" (from \").concat(dailyVolumes.length,\" days)\"));return avgDailyVol;}return null;}catch(error){console.error('Error calculating avg options volume:',error);return null;}};// Scan all expiration combinations to find highest FF spreads\nconst scanCalendarSpreads=async()=>{if(!ticker||!apiKey||availableExpirations.length<2)return;setScanningForSpreads(true);setRecommendedSpreads([]);try{const symbol=ticker.toUpperCase().trim();const S=parseFloat(spotPrice);const r=parseFloat(riskFreeRate)/100;const q=parseFloat(dividend)/100;// Check if we have enough expirations\nif(availableExpirations.length<2){setLoadError(\"Not enough expirations found for \".concat(symbol,\". Found \").concat(availableExpirations.length,\" expirations, need at least 2. This ticker may not have active options trading. Try a major stock like AAPL, TSLA, or SPY.\"));setScanningForSpreads(false);return;}// Fetch IV data for up to first 20 expirations (to avoid too many API calls)\nconst expsToScan=availableExpirations.slice(0,20);// Back to original: scan all available expirations\nconsole.log('=== SCAN START ===');console.log('Ticker:',symbol);console.log('Spot Price:',S);console.log('Available expirations:',availableExpirations.length);console.log('Will scan first:',expsToScan.length);console.log('Expirations to scan:',expsToScan);// Fetch IV for all expirations in parallel (both calls and puts)\nconst ivPromises=expsToScan.map(async(expDate,index)=>{const maxRetries=2;// Back to original: more reliable API calls\nlet retryCount=0;while(retryCount<=maxRetries){try{console.log(\"[\".concat(index+1,\"/\").concat(expsToScan.length,\"] Fetching IV for \").concat(expDate).concat(retryCount>0?\" (retry \".concat(retryCount,\")\"):'',\"...\"));// Add timeout for API calls\nconst timeoutPromise=new Promise((_,reject)=>setTimeout(()=>reject(new Error('API timeout')),15000)// Back to original: longer timeout for reliability\n);// Fetch both calls and puts with timeout\nconst[callsResponse,putsResponse]=await Promise.race([Promise.all([fetch(\"https://api.polygon.io/v3/snapshot/options/\".concat(symbol,\"?expiration_date.gte=\").concat(expDate,\"&expiration_date.lte=\").concat(expDate,\"&contract_type=call&limit=250&apiKey=\").concat(apiKey)),fetch(\"https://api.polygon.io/v3/snapshot/options/\".concat(symbol,\"?expiration_date.gte=\").concat(expDate,\"&expiration_date.lte=\").concat(expDate,\"&contract_type=put&limit=250&apiKey=\").concat(apiKey))]),timeoutPromise]);console.log(\"  \\u2192 Calls response status: \".concat(callsResponse.status));console.log(\"  \\u2192 Puts response status: \".concat(putsResponse.status));if(callsResponse.ok&&putsResponse.ok){var _callsData$results,_putsData$results;const[callsData,putsData]=await Promise.all([callsResponse.json(),putsResponse.json()]);console.log(\"  \\u2192 Calls API Status: \".concat(callsData.status,\", Results: \").concat(((_callsData$results=callsData.results)===null||_callsData$results===void 0?void 0:_callsData$results.length)||0));console.log(\"  \\u2192 Puts API Status: \".concat(putsData.status,\", Results: \").concat(((_putsData$results=putsData.results)===null||_putsData$results===void 0?void 0:_putsData$results.length)||0));if(callsData.status==='OK'&&callsData.results&&callsData.results.length>0){var _putsData$results2;// Find strike closest to 0.5 delta, fallback to ATM\n// For stocks under $10, use $1 increments, otherwise $5 increments\nconst atmStrike=S<10?Math.round(S):Math.round(S/5)*5;console.log(\"  \\u2192 Current price: $\".concat(S,\", ATM strike: $\").concat(atmStrike));const calls=callsData.results.filter(opt=>{var _opt$details3,_opt$details4;return((_opt$details3=opt.details)===null||_opt$details3===void 0?void 0:_opt$details3.strike_price)&&((_opt$details4=opt.details)===null||_opt$details4===void 0?void 0:_opt$details4.contract_type)==='call'&&opt.implied_volatility>0;});const puts=((_putsData$results2=putsData.results)===null||_putsData$results2===void 0?void 0:_putsData$results2.filter(opt=>{var _opt$details5,_opt$details6;return((_opt$details5=opt.details)===null||_opt$details5===void 0?void 0:_opt$details5.strike_price)&&((_opt$details6=opt.details)===null||_opt$details6===void 0?void 0:_opt$details6.contract_type)==='put'&&opt.implied_volatility>0;}))||[];if(calls.length>0){// Find strike with delta closest to 0.5 (for calls)\nconst callsWithDelta=calls.filter(opt=>{var _opt$greeks;return((_opt$greeks=opt.greeks)===null||_opt$greeks===void 0?void 0:_opt$greeks.delta)!==undefined;});if(callsWithDelta.length>0){// Sort by delta closest to 0.5\nconst sortedCalls=callsWithDelta.sort((a,b)=>{const deltaA=Math.abs(a.greeks.delta-0.5);const deltaB=Math.abs(b.greeks.delta-0.5);return deltaA-deltaB;});const selectedCall=sortedCalls[0];if(selectedCall&&selectedCall.implied_volatility>0){console.log(\"  \\u2713 Found call at strike \".concat(selectedCall.details.strike_price,\", IV: \").concat((selectedCall.implied_volatility*100).toFixed(2),\"%, Delta: \").concat((selectedCall.greeks.delta*100).toFixed(1),\"% (closest to 0.5 delta)\"));// Find corresponding put option\nconst correspondingPut=puts.find(put=>{var _put$details;return((_put$details=put.details)===null||_put$details===void 0?void 0:_put$details.strike_price)===selectedCall.details.strike_price;});return{date:expDate,iv:selectedCall.implied_volatility,strike:selectedCall.details.strike_price,delta:selectedCall.greeks.delta,callOpenInterest:selectedCall.open_interest||0,callVolume:selectedCall.volume||0,putOpenInterest:(correspondingPut===null||correspondingPut===void 0?void 0:correspondingPut.open_interest)||0,putVolume:(correspondingPut===null||correspondingPut===void 0?void 0:correspondingPut.volume)||0,putIv:(correspondingPut===null||correspondingPut===void 0?void 0:correspondingPut.implied_volatility)||0};}}else{// Fallback: closest to ATM if no delta data\nconsole.log(\"  \\u2192 No delta data available, using ATM fallback\");const sortedCalls=calls.sort((a,b)=>{const distA=Math.abs(a.details.strike_price-atmStrike);const distB=Math.abs(b.details.strike_price-atmStrike);return distA-distB;});const selectedCall=sortedCalls[0];if(selectedCall&&selectedCall.implied_volatility>0){console.log(\"  \\u2713 Found call at strike \".concat(selectedCall.details.strike_price,\", IV: \").concat((selectedCall.implied_volatility*100).toFixed(2),\"% (ATM fallback)\"));// Find corresponding put option\nconst correspondingPut=puts.find(put=>{var _put$details2;return((_put$details2=put.details)===null||_put$details2===void 0?void 0:_put$details2.strike_price)===selectedCall.details.strike_price;});return{date:expDate,iv:selectedCall.implied_volatility,strike:selectedCall.details.strike_price,delta:null,callOpenInterest:selectedCall.open_interest||0,callVolume:selectedCall.volume||0,putOpenInterest:(correspondingPut===null||correspondingPut===void 0?void 0:correspondingPut.open_interest)||0,putVolume:(correspondingPut===null||correspondingPut===void 0?void 0:correspondingPut.volume)||0,putIv:(correspondingPut===null||correspondingPut===void 0?void 0:correspondingPut.implied_volatility)||0};}}}console.log(\"  \\u2717 No suitable call found for \".concat(expDate,\" (\").concat(calls.length,\" calls available)\"));}else{console.log(\"  \\u2717 No valid results in response\");}}else{console.warn(\"  \\u2717 HTTP Error: Calls \".concat(callsResponse.status,\", Puts \").concat(putsResponse.status));if(!callsResponse.ok){const errorText=await callsResponse.text();console.warn(\"  \\u2717 Calls error: \".concat(errorText.substring(0,200),\"...\"));}if(!putsResponse.ok){const errorText=await putsResponse.text();console.warn(\"  \\u2717 Puts error: \".concat(errorText.substring(0,200),\"...\"));}}}catch(error){retryCount++;if(retryCount<=maxRetries){console.warn(\"  \\u26A0\\uFE0F Attempt \".concat(retryCount,\" failed for \").concat(expDate,\": \").concat(error.message,\". Retrying...\"));await new Promise(resolve=>setTimeout(resolve,1000*retryCount));// Exponential backoff\ncontinue;}else{if(error.message==='API timeout'){console.warn(\"  \\u23F0 Timeout for \".concat(expDate,\" after \").concat(maxRetries,\" retries - skipping\"));}else{console.error(\"  \\u2717 Exception for \".concat(expDate,\" after \").concat(maxRetries,\" retries:\"),error.message);}break;}}}return null;});const ivResults=(await Promise.all(ivPromises)).filter(r=>r!==null);console.log('=== IV FETCH COMPLETE ===');console.log(\"Successfully fetched IV for \".concat(ivResults.length,\"/\").concat(expsToScan.length,\" expirations\"));console.log('IV Results:',ivResults);if(ivResults.length<2){console.warn('❌ NOT ENOUGH IV DATA');console.warn(\"Only \".concat(ivResults.length,\" expirations had valid IV data\"));console.warn('Expirations scanned:',expsToScan);console.warn('IV Results:',ivResults);if(ivResults.length===0){setLoadError(\"No options data found for \".concat(symbol,\". This ticker may not have active options trading. Try a major stock like AAPL, TSLA, or SPY.\"));}else{setLoadError(\"Scanner found IV data for only \".concat(ivResults.length,\"/\").concat(expsToScan.length,\" expirations. This ticker may have limited options data. Try a major stock like AAPL, TSLA, or SPY.\"));}setScanningForSpreads(false);return;}// Calculate FF for all combinations\nconst spreads=[];const now=new Date();for(let i=0;i<ivResults.length-1;i++){for(let j=i+1;j<ivResults.length;j++){const exp1=ivResults[i];const exp2=ivResults[j];const d1=new Date(exp1.date+'T16:00:00-04:00');const d2=new Date(exp2.date+'T16:00:00-04:00');const daysToExp1=(d1-now)/(1000*60*60*24);const daysToExp2=(d2-now)/(1000*60*60*24);if(daysToExp1<=0||daysToExp2<=0)continue;const T1=daysToExp1/365;const T2=daysToExp2/365;const v1=exp1.iv;const v2=exp2.iv;const numerator=T2*v2*v2-T1*v1*v1;const denominator=T2-T1;if(numerator>0&&denominator>0){const forwardVol=Math.sqrt(numerator/denominator);const ff=(v1/forwardVol-1)*100;// Use the strike from the selected option (prefer delta-based selection)\nconst strike1=exp1.strike||Math.round(S/5)*5;const strike2=exp2.strike||Math.round(S/5)*5;// Calculate call spread price using the selected strikes\nconst callT1=getOptionPrice(S,strike1,T1,r,v1,q,true);const callT2=getOptionPrice(S,strike2,T2,r,v2,q,true);const callSpread=callT2-callT1;// Calculate put spread price using the selected strikes\nconst putT1=getOptionPrice(S,strike1,T1,r,v1,q,false);const putT2=getOptionPrice(S,strike2,T2,r,v2,q,false);const putSpread=putT2-putT1;// Check if front expiration is after earnings\nlet isPostEarnings=false;if(nextEarningsDate){const earningsDate=new Date(nextEarningsDate);const frontExpDate=new Date(exp1.date);// Post-earnings if front exp is after earnings\nisPostEarnings=frontExpDate>earningsDate;}spreads.push({date1:exp1.date,date2:exp2.date,dte1:Math.floor(daysToExp1),dte2:Math.floor(daysToExp2),ff:ff,iv1:(v1*100).toFixed(2),iv2:(v2*100).toFixed(2),callSpread:callSpread.toFixed(2),putSpread:putSpread.toFixed(2),strike:strike1,// Use the selected strike from delta-based selection\nisPostEarnings:isPostEarnings,// Liquidity data from exp1 (front expiration)\ncallOpenInterest1:exp1.callOpenInterest||0,callVolume1:exp1.callVolume||0,putOpenInterest1:exp1.putOpenInterest||0,putVolume1:exp1.putVolume||0,// Liquidity data from exp2 (back expiration)\ncallOpenInterest2:exp2.callOpenInterest||0,callVolume2:exp2.callVolume||0,putOpenInterest2:exp2.putOpenInterest||0,putVolume2:exp2.putVolume||0});}else{// Invalid IV combination - Forward Vol would be imaginary\nconst strike1=exp1.strike||Math.round(S/5)*5;const strike2=exp2.strike||Math.round(S/5)*5;// Calculate call spread price using the selected strikes\nconst callT1=getOptionPrice(S,strike1,T1,r,v1,q,true);const callT2=getOptionPrice(S,strike2,T2,r,v2,q,true);const callSpread=callT2-callT1;// Calculate put spread price using the selected strikes\nconst putT1=getOptionPrice(S,strike1,T1,r,v1,q,false);const putT2=getOptionPrice(S,strike2,T2,r,v2,q,false);const putSpread=putT2-putT1;// Check if front expiration is after earnings\nlet isPostEarnings=false;if(nextEarningsDate){const earningsDate=new Date(nextEarningsDate);const frontExpDate=new Date(exp1.date);// Post-earnings if front exp is after earnings\nisPostEarnings=frontExpDate>earningsDate;}spreads.push({date1:exp1.date,date2:exp2.date,dte1:Math.floor(daysToExp1),dte2:Math.floor(daysToExp2),ff:'∞',// Infinity symbol for invalid IV combination\niv1:(v1*100).toFixed(2),iv2:(v2*100).toFixed(2),callSpread:callSpread.toFixed(2),putSpread:putSpread.toFixed(2),strike:strike1,isPostEarnings:isPostEarnings,// Liquidity data from exp1 (front expiration)\ncallOpenInterest1:exp1.callOpenInterest||0,callVolume1:exp1.callVolume||0,putOpenInterest1:exp1.putOpenInterest||0,putVolume1:exp1.putVolume||0,// Liquidity data from exp2 (back expiration)\ncallOpenInterest2:exp2.callOpenInterest||0,callVolume2:exp2.callVolume||0,putOpenInterest2:exp2.putOpenInterest||0,putVolume2:exp2.putVolume||0});}}}console.log('=== CALCULATING SPREADS ===');console.log(\"Calculating spreads from \".concat(ivResults.length,\" expirations...\"));console.log(\"Generated \".concat(spreads.length,\" total spreads\"));// Filter out post-earnings spreads if requested\nlet filteredSpreads=spreads;if(hidePostEarningsSpreads){filteredSpreads=spreads.filter(s=>!s.isPostEarnings);console.log(\"Filtered to \".concat(filteredSpreads.length,\" spreads (removed post-earnings)\"));}// Always filter out options with zero open interest\nfilteredSpreads=filteredSpreads.filter(s=>{const callHasOI=s.callOpenInterest1>0&&s.callOpenInterest2>0;const putHasOI=s.putOpenInterest1>0&&s.putOpenInterest2>0;// At least one option type (call or put) must have open interest\nreturn callHasOI||putHasOI;});console.log(\"Filtered to \".concat(filteredSpreads.length,\" spreads (removed zero OI options)\"));// Apply additional liquidity filters\nif(minOpenInterest>0||minVolume>0){filteredSpreads=filteredSpreads.filter(s=>{const callOIMeets=s.callOpenInterest1>=minOpenInterest&&s.callOpenInterest2>=minOpenInterest;const putOIMeets=s.putOpenInterest1>=minOpenInterest&&s.putOpenInterest2>=minOpenInterest;const callVolMeets=s.callVolume1>=minVolume&&s.callVolume2>=minVolume;const putVolMeets=s.putVolume1>=minVolume&&s.putVolume2>=minVolume;// At least one option type (call or put) must meet the criteria\nreturn callOIMeets&&callVolMeets||putOIMeets&&putVolMeets;});console.log(\"Filtered to \".concat(filteredSpreads.length,\" spreads (applied additional liquidity filters)\"));}// Apply DTE gap filter\nif(maxDTEGap>0){filteredSpreads=filteredSpreads.filter(s=>{const dteGap=s.dte2-s.dte1;return dteGap<=maxDTEGap;});console.log(\"Filtered to \".concat(filteredSpreads.length,\" spreads (applied DTE gap filter: max \").concat(maxDTEGap,\" days)\"));}// Sort by FF descending and take top 10\nfilteredSpreads.sort((a,b)=>b.ff-a.ff);const topSpreads=filteredSpreads.slice(0,10);console.log('=== SCAN COMPLETE ===');console.log(\"Found \".concat(filteredSpreads.length,\" valid spreads, showing top \").concat(Math.min(10,topSpreads.length)));console.log('Top 10 spreads:',topSpreads);console.log('Setting recommended spreads...',topSpreads.length,'spreads');setRecommendedSpreads(topSpreads);console.log('Recommended spreads set successfully');// Add to watchlist with best FF\nif(topSpreads.length>0){const bestSpread=topSpreads[0];addToWatchlist(symbol,bestSpread.ff.toFixed(2),nextEarningsDate!==null,nextEarningsDate,S.toFixed(2));}}catch(error){console.error('=== SCAN ERROR ===');console.error('Error scanning calendar spreads:',error);console.error('Error stack:',error.stack);setLoadError(\"Scan failed: \".concat(error.message));}setScanningForSpreads(false);};// Calculate DTE (Days to Expiration) for a given date\nconst calculateDTE=expirationDate=>{const expDate=new Date(expirationDate+'T16:00:00-04:00');// 4 PM EST\nconst now=new Date();const diffMs=expDate-now;const diffDays=diffMs/(1000*60*60*24);return Math.max(0,Math.floor(diffDays));};// Function to update IV based on selected expiration date\nconst updateIVForDate=async(expirationDate,isFirstDate)=>{if(!ticker||!apiKey||!expirationDate)return;try{const symbol=ticker.toUpperCase().trim();const roundedStrike=Math.round(parseFloat(spotPrice)/5)*5;const chainUrl=\"https://api.polygon.io/v3/snapshot/options/\".concat(symbol,\"?expiration_date.gte=\").concat(expirationDate,\"&expiration_date.lte=\").concat(expirationDate,\"&contract_type=call&limit=250&apiKey=\").concat(apiKey);console.log(\"Fetching IV for \".concat(expirationDate,\"...\"));const chainResponse=await fetch(chainUrl);if(chainResponse.ok){const chainData=await chainResponse.json();if(chainData.status==='OK'&&chainData.results&&chainData.results.length>0){// Find ATM call option - closest to rounded strike\nconst atmCall=chainData.results.filter(opt=>{var _opt$details7;return((_opt$details7=opt.details)===null||_opt$details7===void 0?void 0:_opt$details7.strike_price)&&Math.abs(opt.details.strike_price-roundedStrike)<20;}).sort((a,b)=>Math.abs(a.details.strike_price-roundedStrike)-Math.abs(b.details.strike_price-roundedStrike))[0];if(atmCall){var _atmCall$day3;if(atmCall.implied_volatility!==undefined&&atmCall.implied_volatility>0){const ivValue=(atmCall.implied_volatility*100).toFixed(2);if(isFirstDate){setIv1(ivValue);}else{setIv2(ivValue);}}if(((_atmCall$day3=atmCall.day)===null||_atmCall$day3===void 0?void 0:_atmCall$day3.volume)!==undefined){if(isFirstDate){setVolumeCallT1(atmCall.day.volume);}else{setVolumeCallT2(atmCall.day.volume);}}if(atmCall.open_interest!==undefined){if(isFirstDate){setOiCallT1(atmCall.open_interest);}else{setOiCallT2(atmCall.open_interest);}}}}}}catch(error){console.error('Error updating IV:',error);}};const normDist=x=>{const a1=0.254829592;const a2=-0.284496736;const a3=1.421413741;const a4=-1.453152027;const a5=1.061405429;const p=0.3275911;const sign=x<0?-1:1;x=Math.abs(x)/Math.sqrt(2);const t=1.0/(1.0+p*x);const y=1.0-((((a5*t+a4)*t+a3)*t+a2)*t+a1)*t*Math.exp(-x*x);return 0.5*(1.0+sign*y);};const blackScholesCall=function(S,K,T,r,sigma){let q=arguments.length>5&&arguments[5]!==undefined?arguments[5]:0;if(T<=0||sigma<=0)return Math.max(S-K,0);const sqrtT=Math.sqrt(T);const d1=(Math.log(S/K)+(r-q+0.5*sigma*sigma)*T)/(sigma*sqrtT);const d2=d1-sigma*sqrtT;const callPrice=S*Math.exp(-q*T)*normDist(d1)-K*Math.exp(-r*T)*normDist(d2);return Math.max(callPrice,0);};const blackScholesPut=function(S,K,T,r,sigma){let q=arguments.length>5&&arguments[5]!==undefined?arguments[5]:0;if(T<=0||sigma<=0)return Math.max(K-S,0);const sqrtT=Math.sqrt(T);const d1=(Math.log(S/K)+(r-q+0.5*sigma*sigma)*T)/(sigma*sqrtT);const d2=d1-sigma*sqrtT;const putPrice=K*Math.exp(-r*T)*normDist(-d2)-S*Math.exp(-q*T)*normDist(-d1);return Math.max(putPrice,0);};const black76Call=(F,K,T,r,sigma)=>{if(T<=0||sigma<=0)return Math.max(F-K,0);const sqrtT=Math.sqrt(T);const d1=(Math.log(F/K)+0.5*sigma*sigma*T)/(sigma*sqrtT);const d2=d1-sigma*sqrtT;const callPrice=Math.exp(-r*T)*(F*normDist(d1)-K*normDist(d2));return Math.max(callPrice,0);};const black76Put=(F,K,T,r,sigma)=>{if(T<=0||sigma<=0)return Math.max(K-F,0);const sqrtT=Math.sqrt(T);const d1=(Math.log(F/K)+0.5*sigma*sigma*T)/(sigma*sqrtT);const d2=d1-sigma*sqrtT;const putPrice=Math.exp(-r*T)*(K*normDist(-d2)-F*normDist(-d1));return Math.max(putPrice,0);};const binomialCall=function(S,K,T,r,sigma){let q=arguments.length>5&&arguments[5]!==undefined?arguments[5]:0;let steps=arguments.length>6&&arguments[6]!==undefined?arguments[6]:50;const dt=T/steps;const u=Math.exp(sigma*Math.sqrt(dt));const d=1/u;const p=(Math.exp((r-q)*dt)-d)/(u-d);// Stock prices at maturity\nconst prices=[];for(let i=0;i<=steps;i++){prices[i]=S*Math.pow(u,steps-i)*Math.pow(d,i);}// Option values at maturity\nconst values=prices.map(price=>Math.max(price-K,0));// Backward induction\nfor(let j=steps-1;j>=0;j--){for(let i=0;i<=j;i++){values[i]=Math.exp(-r*dt)*(p*values[i]+(1-p)*values[i+1]);}}return values[0];};const binomialPut=function(S,K,T,r,sigma){let q=arguments.length>5&&arguments[5]!==undefined?arguments[5]:0;let steps=arguments.length>6&&arguments[6]!==undefined?arguments[6]:50;const dt=T/steps;const u=Math.exp(sigma*Math.sqrt(dt));const d=1/u;const p=(Math.exp((r-q)*dt)-d)/(u-d);// Stock prices at maturity\nconst prices=[];for(let i=0;i<=steps;i++){prices[i]=S*Math.pow(u,steps-i)*Math.pow(d,i);}// Option values at maturity\nconst values=prices.map(price=>Math.max(K-price,0));// Backward induction\nfor(let j=steps-1;j>=0;j--){for(let i=0;i<=j;i++){values[i]=Math.exp(-r*dt)*(p*values[i]+(1-p)*values[i+1]);}}return values[0];};const getOptionPrice=(S,K,T,r,sigma,q,isCall)=>{switch(pricingModel){case'black76':const F=S*Math.exp((r-q)*T);return isCall?black76Call(F,K,T,r,sigma):black76Put(F,K,T,r,sigma);case'binomial':return isCall?binomialCall(S,K,T,r,sigma,q):binomialPut(S,K,T,r,sigma,q);case'blackscholes':default:return isCall?blackScholesCall(S,K,T,r,sigma,q):blackScholesPut(S,K,T,r,sigma,q);}};const handlePriceSlider=(newPrice,isCallSpread)=>{if(!result)return;const S=parseFloat(spotPrice);const K=parseFloat(strikePrice);const v1=parseFloat(iv1)/100;const r=parseFloat(riskFreeRate)/100;const q=parseFloat(dividend)/100;const d1=new Date(date1);const d2=new Date(date2);const now=new Date();const d1_16NY=new Date(d1);d1_16NY.setHours(22,0,0,0);const d2_16NY=new Date(d2);d2_16NY.setHours(22,0,0,0);const msPerDay=24*60*60*1000;const daysToExp1=(d1_16NY-now)/msPerDay;const daysToExp2=(d2_16NY-now)/msPerDay;const T1=daysToExp1/365;const T2=daysToExp2/365;const frontPrice=isCallSpread?getOptionPrice(S,K,T1,r,v1,q,true):getOptionPrice(S,K,T1,r,v1,q,false);// Target Back-Option Preis basierend auf neuer Spread-Preis\nconst targetBackPrice=newPrice+frontPrice;// Binäre Suche nach der IV2, die zu targetBackPrice führt\nlet v2Low=0.001;let v2High=3.0;let v2Mid=1.0;for(let iteration=0;iteration<100;iteration++){v2Mid=(v2Low+v2High)/2;const backPrice=isCallSpread?getOptionPrice(S,K,T2,r,v2Mid,q,true):getOptionPrice(S,K,T2,r,v2Mid,q,false);const diff=backPrice-targetBackPrice;if(Math.abs(diff)<0.00001)break;if(diff>0){v2High=v2Mid;}else{v2Low=v2Mid;}}// Mit dieser gefundenen IV2 berechne den echten FF\nconst numerator=T2*v2Mid*v2Mid-T1*v1*v1;const denominator=T2-T1;let newFF;if(numerator>=0&&denominator>0){const forwardVol=Math.sqrt(numerator/denominator);newFF=(v1/forwardVol-1)*100;}else{newFF=parseFloat(result.forwardFactor);}if(isCallSpread){setCallPriceSlider(newPrice);setAdjustedFFCall(newFF);}else{setPutPriceSlider(newPrice);setAdjustedFFPut(newFF);}};const calculateResults=()=>{try{const d1=new Date(date1);const d2=new Date(date2);if(d2<=d1){setResult({error:'Expiration 2 muss nach Expiration 1 liegen'});return;}// Berechne verbleibende Zeit mit Berücksichtigung der NY-Schließzeit (16:00 EST = 22:00 Berlin)\nconst now=new Date();const d1_16NY=new Date(d1);d1_16NY.setHours(22,0,0,0);// 16:00 EST = 22:00 Berlin (CET)\nconst d2_16NY=new Date(d2);d2_16NY.setHours(22,0,0,0);// 16:00 EST = 22:00 Berlin (CET)\n// Berechne verbleibende Tage mit Dezimalgenauigkeit (keine Rundung)\nconst msPerDay=24*60*60*1000;const daysToExp1=(d1_16NY-now)/msPerDay;const daysToExp2=(d2_16NY-now)/msPerDay;if(daysToExp1<=0||daysToExp2<=0){setResult({error:'Ablaufdatum liegt in der Vergangenheit'});return;}// Zeitberechnung in Jahren - KEINE Rundung!\nconst T1=daysToExp1/365;const T2=daysToExp2/365;const v1=parseFloat(iv1)/100;const v2=parseFloat(iv2)/100;const S=parseFloat(spotPrice);const K=parseFloat(strikePrice);const r=parseFloat(riskFreeRate)/100;const q=parseFloat(dividend)/100;if(v1<=0||v2<=0||S<=0||K<=0){setResult({error:'Bitte überprüfe deine Eingaben'});return;}const numerator=T2*v2*v2-T1*v1*v1;const denominator=T2-T1;if(numerator<0){setResult({error:'Ungültige IV Kombination - Forward Vol wäre imaginär'});return;}const forwardVol=Math.sqrt(numerator/denominator);const forwardVolPct=forwardVol*100;const forwardFactor=v1/forwardVol-1;const callT1=getOptionPrice(S,K,T1,r,v1,q,true);const callT2=getOptionPrice(S,K,T2,r,v2,q,true);const callCalendarSpread=callT2-callT1;const putT1=getOptionPrice(S,K,T1,r,v1,q,false);const putT2=getOptionPrice(S,K,T2,r,v2,q,false);const putCalendarSpread=putT2-putT1;// FF = 30%\nconst targetForwardFactor30=0.30;const requiredForwardVol30=v1/(1+targetForwardFactor30);const iv2Squared30=(requiredForwardVol30*requiredForwardVol30*(T2-T1)+T1*v1*v1)/T2;const requiredIV230=Math.sqrt(Math.max(0,iv2Squared30));const callT2At30=getOptionPrice(S,K,T2,r,requiredIV230,q,true);const maxCallCalendarPrice30=callT2At30-callT1;const putT2At30=getOptionPrice(S,K,T2,r,requiredIV230,q,false);const maxPutCalendarPrice30=putT2At30-putT1;// FF = 0%\nconst targetForwardFactor0=0;const requiredForwardVol0=v1/(1+targetForwardFactor0);const iv2Squared0=(requiredForwardVol0*requiredForwardVol0*(T2-T1)+T1*v1*v1)/T2;const requiredIV20=Math.sqrt(Math.max(0,iv2Squared0));const callT2At0=getOptionPrice(S,K,T2,r,requiredIV20,q,true);const callCalendarSpreadAt0=callT2At0-callT1;const putT2At0=getOptionPrice(S,K,T2,r,requiredIV20,q,false);const putCalendarSpreadAt0=putT2At0-putT1;const newResult={forwardVolPct:parseFloat(forwardVolPct).toFixed(2),forwardFactor:(parseFloat(forwardFactor)*100).toFixed(2),daysToExp1:parseFloat(daysToExp1).toFixed(2),daysToExp2:parseFloat(daysToExp2).toFixed(2),callT1:parseFloat(callT1).toFixed(2),callT2:parseFloat(callT2).toFixed(2),callCalendarSpread:parseFloat(callCalendarSpread).toFixed(2),putT1:parseFloat(putT1).toFixed(2),putT2:parseFloat(putT2).toFixed(2),putCalendarSpread:parseFloat(putCalendarSpread).toFixed(2),maxCallCalendarPrice30:Math.max(0,parseFloat(maxCallCalendarPrice30)).toFixed(2),maxPutCalendarPrice30:Math.max(0,parseFloat(maxPutCalendarPrice30)).toFixed(2),callCalendarSpreadAt0:parseFloat(callCalendarSpreadAt0).toFixed(2),putCalendarSpreadAt0:parseFloat(putCalendarSpreadAt0).toFixed(2),error:null,timestamp:new Date().toLocaleString('de-DE')};setResult(newResult);const historyEntry={ticker:ticker||'N/A',date:date1,ff:parseFloat(newResult.forwardFactor),callSpreadCurrent:newResult.callCalendarSpread,putSpreadCurrent:newResult.putCalendarSpread,callSpreadFF30:newResult.maxCallCalendarPrice30,putSpreadFF30:newResult.maxPutCalendarPrice30,callSpreadFF0:newResult.callCalendarSpreadAt0,putSpreadFF0:newResult.putCalendarSpreadAt0,timestamp:newResult.timestamp};setTradeHistory([historyEntry,...tradeHistory.slice(0,9)]);}catch(err){setResult({error:'Fehler bei der Berechnung: '+err.message});}};const getFFColor=ff=>{const ffNum=parseFloat(ff);if(ffNum>=30)return'bg-green-100 border-green-500 text-green-900';if(ffNum>=16)return'bg-yellow-100 border-yellow-500 text-yellow-900';return darkMode?'bg-gray-700 border-gray-600 text-gray-300':'bg-gray-50 border-gray-300 text-gray-900';};const exportCSV=()=>{if(!result||result.error)return;const csv=[['Calendar Spread Trade'],['Datum',new Date().toLocaleString('de-DE')],[],['Expiration 1',date1],['Expiration 2',date2],['IV Exp 1',iv1+'%'],['IV Exp 2',iv2+'%'],['Aktienkurs',spotPrice],['Strike',strikePrice],[],['Forward Volatility',result.forwardVolPct+'%'],['Forward Faktor',result.forwardFactor+'%'],['Call Calendar Spread',result.callCalendarSpread],['Put Calendar Spread',result.putCalendarSpread],['Max Call für FF +30%',result.maxCallCalendarPrice30],['Max Put für FF +30%',result.maxPutCalendarPrice30]].map(row=>row.join(',')).join('\\n');const blob=new Blob([csv],{type:'text/csv'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=\"calendar-trade-\".concat(new Date().toISOString().split('T')[0],\".csv\");a.click();};// Auto-calculate when parameters change\nuseEffect(()=>{// Only auto-calculate if we have all required values\nif(date1&&date2&&iv1&&iv2&&spotPrice&&strikePrice){const timeoutId=setTimeout(()=>{calculateResults();},500);// Debounce for 500ms\nreturn()=>clearTimeout(timeoutId);}},[date1,date2,iv1,iv2,spotPrice,strikePrice,riskFreeRate,dividend,pricingModel]);// Debug: Log when recommended spreads change\nuseEffect(()=>{console.log('Recommended spreads updated:',recommendedSpreads.length,'spreads');if(recommendedSpreads.length>0){console.log('First spread:',recommendedSpreads[0]);}},[recommendedSpreads]);// Check if earnings overlaps with strategy dates\nuseEffect(()=>{if(!nextEarningsDate||!date1||!date2){setEarningsConflict(null);return;}const earningsDate=new Date(nextEarningsDate);const strategyStart=new Date(date1);const strategyEnd=new Date(date2);// Check if earnings falls within strategy window (inclusive)\nif(earningsDate>=strategyStart&&earningsDate<=strategyEnd){const daysUntilEarnings=Math.ceil((earningsDate-new Date())/(1000*60*60*24));setEarningsConflict({date:nextEarningsDate,timing:earningsTime,daysAway:daysUntilEarnings});}else{setEarningsConflict(null);}},[nextEarningsDate,earningsTime,date1,date2]);const bgClass=darkMode?'bg-gray-900':'bg-gradient-to-br from-blue-50 to-indigo-100';const cardClass=darkMode?'bg-gray-800 text-white':'bg-white text-gray-900';const borderClass=darkMode?'border-gray-700':'border-gray-200';return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen \".concat(bgClass,\" p-6\"),children:[/*#__PURE__*/_jsx(\"div\",{className:\"max-w-[1800px] mx-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(cardClass,\" rounded-lg shadow-lg p-8\"),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 mb-2\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl font-bold\",children:\"Calendar Spread Calculator\"}),/*#__PURE__*/_jsx(\"span\",{className:\"px-3 py-1 rounded-full text-xs font-semibold \".concat(darkMode?'bg-yellow-900 text-yellow-200':'bg-yellow-200 text-yellow-800'),children:\"v1.0 BETA\"})]}),/*#__PURE__*/_jsx(\"p\",{className:darkMode?'text-gray-400':'text-gray-600',children:\"Forward Volatility, Forward Factor & Calendar Spread Pricing\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsxs(\"select\",{value:pricingModel,onChange:e=>setPricingModel(e.target.value),className:\"px-4 py-2 rounded-lg font-semibold \".concat(darkMode?'bg-gray-700 border border-gray-600 text-white':'bg-white border border-blue-300 text-gray-900'),children:[/*#__PURE__*/_jsx(\"option\",{value:\"blackscholes\",children:\"Black-Scholes\"}),/*#__PURE__*/_jsx(\"option\",{value:\"black76\",children:\"Black-76\"}),/*#__PURE__*/_jsx(\"option\",{value:\"binomial\",children:\"Binomial\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setDarkMode(!darkMode),className:\"p-2 rounded-lg \".concat(darkMode?'bg-gray-700 text-yellow-400':'bg-gray-200 text-gray-800'),children:darkMode?/*#__PURE__*/_jsx(Sun,{size:24}):/*#__PURE__*/_jsx(Moon,{size:24})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm opacity-75\",children:\"User:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-2\",children:['Nils','Mr. FF'].map(user=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setCurrentUser(user);localStorage.setItem('currentUser',user);},className:\"px-4 py-2 rounded-lg font-semibold transition-all \".concat(currentUser===user?darkMode?'bg-blue-600 text-white':'bg-blue-500 text-white':darkMode?'bg-gray-700 hover:bg-gray-600 text-gray-300':'bg-gray-200 hover:bg-gray-300 text-gray-700'),children:user},user))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm opacity-50\",children:[\"Welcome, \",currentUser,\"!\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-7 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-1 space-y-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-bold mb-4\",children:\"Parameters\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold mb-2\",children:\"Polygon.io API Key\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:apiKey,onChange:e=>setApiKey(e.target.value),className:\"w-full px-4 py-2 border-2 rounded-lg focus:outline-none \".concat(darkMode?'bg-gray-700 border-gray-600 focus:border-blue-400':'bg-white border-blue-300 focus:border-blue-500'),placeholder:\"Paste your Polygon.io API key\"}),/*#__PURE__*/_jsx(\"a\",{href:\"https://polygon.io/dashboard/signup\",target:\"_blank\",rel:\"noopener noreferrer\",className:\"text-xs text-blue-500 hover:underline mt-1 block\",children:\"Get free API key \\u2192 (End-of-Day data)\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold mb-2\",children:\"Ticker Symbol\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 relative\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:ticker,onChange:e=>handleTickerChange(e.target.value),onFocus:()=>{if(ticker.length>0){handleTickerChange(ticker);}},onBlur:()=>{// Delay to allow click on dropdown\nsetTimeout(()=>setShowTickerDropdown(false),200);},onKeyDown:e=>{if(e.key==='Enter'){setShowTickerDropdown(false);fetchOptionData(ticker);}else if(e.key==='Escape'){setShowTickerDropdown(false);}else if(e.key==='ArrowDown'){if(ticker.length>0){handleTickerChange(ticker);}}},className:\"w-full px-4 py-2 border-2 rounded-lg focus:outline-none \".concat(darkMode?'bg-gray-700 border-gray-600 focus:border-blue-400':'bg-white border-blue-300 focus:border-blue-500'),placeholder:\"e.g. AAPL, SPY, TSLA...\",disabled:loading}),showTickerDropdown&&filteredTickers.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute z-50 w-full mt-1 max-h-64 overflow-y-auto rounded-lg shadow-lg border-2 \".concat(darkMode?'bg-gray-800 border-gray-600':'bg-white border-gray-300'),children:filteredTickers.map(stock=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>selectTicker(stock.symbol),className:\"w-full text-left px-4 py-2 hover:bg-opacity-80 transition-colors \".concat(darkMode?'hover:bg-gray-700 text-white':'hover:bg-gray-100 text-gray-900'),children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-bold\",children:stock.symbol}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs \".concat(darkMode?'text-gray-400':'text-gray-600'),children:stock.name})]},stock.symbol))})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>fetchOptionData(ticker),disabled:loading,className:\"px-4 py-2 rounded-lg font-semibold transition-all \".concat(loading?'bg-gray-400 cursor-not-allowed':darkMode?'bg-slate-600 hover:bg-slate-700 text-white':'bg-slate-500 hover:bg-slate-600 text-white'),children:loading?'...':'Load'})]}),loadError&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-500 text-xs mt-1\",children:loadError}),loading&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs mt-1 \".concat(darkMode?'text-blue-400':'text-blue-600'),children:\"Loading stock data...\"}),recentTickers.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs opacity-75 mb-1\",children:\"Recent:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-1\",children:recentTickers.map(recentTicker=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setTicker(recentTicker);fetchOptionData(recentTicker);},className:\"px-2 py-1 text-xs rounded font-medium transition-colors \".concat(darkMode?'bg-gray-700 hover:bg-gray-600 text-gray-200':'bg-gray-200 hover:bg-gray-300 text-gray-700'),children:recentTicker},recentTicker))})]}),/*#__PURE__*/_jsx(\"button\",{onClick:loadDemoData,className:\"w-full mt-2 px-4 py-2 rounded-lg font-semibold text-xs \".concat(darkMode?'bg-green-700 hover:bg-green-800 text-white':'bg-green-500 hover:bg-green-600 text-white'),children:\"Load Demo Data (SPY)\"}),(marketCap!==null||avgOptionsVolume!==null||nextEarningsDate!==null)&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 p-3 rounded-lg border-2 \".concat(darkMode?'bg-gray-700 border-gray-600':'bg-blue-50 border-blue-200'),children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-semibold mb-2\",children:\"Market Info\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-2 text-xs\",children:[marketCap!==null&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"opacity-75\",children:\"Market Cap\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"font-bold\",children:[\"$\",(marketCap/1e9).toFixed(2),\"B\"]})]}),avgOptionsVolume!==null&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"opacity-75\",children:\"Total Opt Vol (20d)\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-bold\",children:avgOptionsVolume.toLocaleString()})]})]}),nextEarningsDate!==null&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 p-2 rounded border \".concat(darkMode?'bg-yellow-900 border-yellow-600':'bg-yellow-100 border-yellow-400'),children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-semibold mb-1\",children:\"\\uD83D\\uDCCA Next Earnings\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-bold\",children:new Date(nextEarningsDate).toLocaleDateString('en-US',{weekday:'short',year:'numeric',month:'short',day:'numeric'})}),earningsTime&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs opacity-75 mt-1\",children:earningsTime}),(()=>{const daysAway=Math.floor((new Date(nextEarningsDate)-new Date())/(1000*60*60*24));return/*#__PURE__*/_jsx(\"p\",{className:\"text-xs opacity-75 mt-1\",children:daysAway>0?\"\".concat(daysAway,\" days away\"):daysAway===0?'Today!':\"\".concat(Math.abs(daysAway),\" days ago\")});})()]})]}),earningsConflict&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 p-3 rounded-lg border-2 \".concat(darkMode?'bg-red-900 border-red-600':'bg-red-50 border-red-400'),children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-semibold mb-1\",children:\"\\u26A0\\uFE0F Earnings During Strategy\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs\",children:[\"Earnings on \",/*#__PURE__*/_jsx(\"span\",{className:\"font-bold\",children:new Date(earningsConflict.date).toLocaleDateString('en-US',{month:'short',day:'numeric'})}),\" falls within your selected dates.\"]}),earningsConflict.timing&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs opacity-75 mt-1\",children:earningsConflict.timing}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs opacity-75 mt-1\",children:earningsConflict.daysAway>0?\"\".concat(earningsConflict.daysAway,\" days away\"):earningsConflict.daysAway===0?'Today!':\"\".concat(Math.abs(earningsConflict.daysAway),\" days ago\")})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold mb-2\",children:\"Expiration 1\"}),/*#__PURE__*/_jsx(\"select\",{value:date1,onChange:e=>{setDate1(e.target.value);updateIVForDate(e.target.value,true);},className:\"w-full px-4 py-2 border-2 rounded-lg \".concat(darkMode?'bg-gray-700 border-gray-600 text-white':'bg-white border-blue-300 text-gray-900'),children:availableExpirations.length>0?availableExpirations.map(date=>{const dte=calculateDTE(date);return/*#__PURE__*/_jsxs(\"option\",{value:date,children:[new Date(date).toLocaleDateString('en-US',{weekday:'short',year:'numeric',month:'short',day:'numeric'}),\" (\",dte,\" DTE)\"]},date);}):/*#__PURE__*/_jsx(\"option\",{value:date1,children:new Date(date1).toLocaleDateString('en-US')})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold mb-2\",children:\"Expiration 2\"}),/*#__PURE__*/_jsx(\"select\",{value:date2,onChange:e=>{setDate2(e.target.value);updateIVForDate(e.target.value,false);},className:\"w-full px-4 py-2 border-2 rounded-lg \".concat(darkMode?'bg-gray-700 border-gray-600 text-white':'bg-white border-blue-300 text-gray-900'),children:availableExpirations.length>0?availableExpirations.map(date=>{const dte=calculateDTE(date);return/*#__PURE__*/_jsxs(\"option\",{value:date,children:[new Date(date).toLocaleDateString('en-US',{weekday:'short',year:'numeric',month:'short',day:'numeric'}),\" (\",dte,\" DTE)\"]},date);}):/*#__PURE__*/_jsx(\"option\",{value:date2,children:new Date(date2).toLocaleDateString('en-US')})})]}),[{label:'IV Exp 1 (%)',value:iv1,setter:setIv1},{label:'IV Exp 2 (%)',value:iv2,setter:setIv2},{label:'Stock Price',value:spotPrice,setter:setSpotPrice},{label:'Strike',value:strikePrice,setter:setStrikePrice},{label:'Risk-Free Rate (%)',value:riskFreeRate,setter:setRiskFreeRate},{label:'Dividend (%)',value:dividend,setter:setDividend}].map((field,idx)=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-semibold mb-2\",children:field.label}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:field.value,onChange:e=>field.setter(e.target.value),className:\"w-full px-4 py-2 border-2 rounded-lg focus:outline-none \".concat(darkMode?'bg-gray-700 border-gray-600 focus:border-blue-400':'bg-white border-blue-300 focus:border-blue-500'),step:\"0.01\"})]},idx)),/*#__PURE__*/_jsx(\"button\",{onClick:calculateResults,className:\"w-full bg-gradient-to-r from-blue-500 to-indigo-600 text-white font-bold py-3 rounded-lg hover:shadow-lg transition-all transform hover:scale-105\",children:\"Calculate\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-5 space-y-4\",children:[result&&!result.error&&/*#__PURE__*/_jsxs(\"div\",{className:\"sticky top-0 z-40 px-4 py-2 rounded-lg shadow-md flex items-center justify-between \".concat(darkMode?'bg-gray-800':'bg-white'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[ticker&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://img.logokit.com/ticker/\".concat(ticker,\"?token=pk_fr93b6bfb5c425f6e3db62&format=png\"),alt:ticker,className:\"w-8 h-8 rounded-lg object-contain\",onError:e=>{// Fallback to colored circle with letter if logo fails\ne.target.style.display='none';e.target.nextElementSibling.style.display='flex';}}),/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 rounded-full hidden items-center justify-center font-bold text-white \".concat(ticker[0]<='F'?'bg-blue-500':ticker[0]<='L'?'bg-purple-500':ticker[0]<='R'?'bg-green-500':ticker[0]<='W'?'bg-orange-500':'bg-red-500'),children:ticker[0]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-baseline gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-bold\",children:ticker}),spotPrice&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-lg font-semibold \".concat(darkMode?'text-blue-400':'text-blue-600'),children:[\"$\",parseFloat(spotPrice).toFixed(2)]})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-[10px] opacity-50\",children:\"Options data 15 min delayed, stock price last close\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs opacity-75\",children:\"Forward Vol:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 text-lg font-bold text-green-600\",children:[result.forwardVolPct,\"%\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"px-3 py-1 rounded \".concat(parseFloat(result.forwardFactor)>=30?'bg-green-100 text-green-900':parseFloat(result.forwardFactor)>=16?'bg-yellow-100 text-yellow-900':darkMode?'bg-gray-700 text-gray-300':'bg-gray-100 text-gray-900'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs opacity-75\",children:\"FF:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 text-xl font-bold\",children:[result.forwardFactor,\"%\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs opacity-75\",children:[result.daysToExp1,\"-\",result.daysToExp2,\" DTE\"]})]}),(scanningForSpreads||recommendedSpreads.length>0)&&/*#__PURE__*/_jsxs(\"div\",{className:\"border-2 \".concat(borderClass,\" p-4 rounded-lg \").concat(darkMode?'bg-slate-800':'bg-slate-50'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-3\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold text-lg\",children:[\"\\uD83D\\uDCCA Recommended Calendar Spreads\",ticker&&\" for \".concat(ticker)]}),scanningForSpreads&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xs \".concat(darkMode?'text-blue-400':'text-blue-600'),children:\"Scanning...\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-3 pb-3 border-b border-opacity-30\",style:{borderColor:darkMode?'#ffffff40':'#00000020'},children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2 cursor-pointer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:hidePostEarningsSpreads,onChange:e=>{setHidePostEarningsSpreads(e.target.checked);// Re-trigger scan with new filter\nsetTimeout(()=>scanCalendarSpreads(),100);},className:\"w-4 h-4 rounded\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Hide post-earnings front expirations\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs opacity-50\",title:\"For pure forward volatility plays, avoid spreads where the front leg expires after earnings\",children:\"\\u2139\\uFE0F\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4 mb-3 pb-3 border-b border-opacity-30\",style:{borderColor:darkMode?'#ffffff40':'#00000020'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-sm\",children:\"Min Open Interest:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:minOpenInterest,onChange:e=>setMinOpenInterest(parseInt(e.target.value)||0),className:\"w-20 px-2 py-1 text-xs rounded border \".concat(darkMode?'bg-slate-700 border-slate-600 text-white placeholder-slate-400':'bg-white border-gray-300 text-gray-900 placeholder-gray-500'),placeholder:\"0\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-sm\",children:\"Min Volume:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:minVolume,onChange:e=>setMinVolume(parseInt(e.target.value)||0),className:\"w-20 px-2 py-1 text-xs rounded border \".concat(darkMode?'bg-slate-700 border-slate-600 text-white placeholder-slate-400':'bg-white border-gray-300 text-gray-900 placeholder-gray-500'),placeholder:\"0\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"text-sm\",children:\"Max DTE Gap:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:maxDTEGap,onChange:e=>setMaxDTEGap(parseInt(e.target.value)||0),className:\"w-20 px-2 py-1 text-xs rounded border \".concat(darkMode?'bg-slate-700 border-slate-600 text-white placeholder-slate-400':'bg-white border-gray-300 text-gray-900 placeholder-gray-500'),placeholder:\"200\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{// Just re-filter existing data, don't re-scan\nsetRecommendedSpreads(prevSpreads=>{let filtered=prevSpreads;if(hidePostEarningsSpreads){filtered=filtered.filter(s=>!s.isPostEarnings);}if(minOpenInterest>0||minVolume>0){filtered=filtered.filter(s=>{const callOIMeets=s.callOpenInterest1>=minOpenInterest&&s.callOpenInterest2>=minOpenInterest;const putOIMeets=s.putOpenInterest1>=minOpenInterest&&s.putOpenInterest2>=minOpenInterest;const callVolMeets=s.callVolume1>=minVolume&&s.callVolume2>=minVolume;const putVolMeets=s.putVolume1>=minVolume&&s.putVolume2>=minVolume;return callOIMeets&&callVolMeets||putOIMeets&&putVolMeets;});}if(maxDTEGap>0){filtered=filtered.filter(s=>{const dteGap=s.dte2-s.dte1;return dteGap<=maxDTEGap;});}return filtered;});},className:\"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors\",children:\"Apply Filters\"})]}),scanningForSpreads?/*#__PURE__*/_jsx(\"p\",{className:\"text-sm opacity-75\",children:\"Analyzing expiration combinations...\"}):recommendedSpreads.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2 max-h-96 overflow-y-auto\",children:recommendedSpreads.map((spread,idx)=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setDate1(spread.date1);setDate2(spread.date2);setIv1(spread.iv1);setIv2(spread.iv2);setStrikePrice(spread.strike.toString());},className:\"w-full text-left p-3 rounded transition-all hover:scale-[1.02] \".concat(spread.ff==='∞'?darkMode?'bg-red-900 hover:bg-red-800':'bg-red-100 hover:bg-red-200':parseFloat(spread.ff)>=30?darkMode?'bg-slate-800 hover:bg-slate-700':'bg-slate-100 hover:bg-slate-200':parseFloat(spread.ff)>=16?darkMode?'bg-yellow-900 hover:bg-yellow-800':'bg-yellow-100 hover:bg-yellow-200':darkMode?'bg-gray-700 hover:bg-gray-600':'bg-gray-100 hover:bg-gray-200'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold text-lg\",children:[\"#\",idx+1]}),/*#__PURE__*/_jsxs(\"span\",{className:\"ml-3 font-semibold\",children:[new Date(spread.date1).toLocaleDateString('en-US',{month:'short',day:'numeric'}),\" \\u2192 \",new Date(spread.date2).toLocaleDateString('en-US',{month:'short',day:'numeric'})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 text-xs opacity-75\",children:[\"(\",Math.floor(spread.dte1),\" \\u2192 \",Math.floor(spread.dte2),\" DTE)\"]}),spread.isPostEarnings&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 px-2 py-0.5 text-[10px] font-semibold rounded bg-orange-500 text-white\",title:\"Front expiration is after earnings\",children:\"POST-\\uD83D\\uDCCA\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-2xl font-bold\",children:[\"FF: \",spread.ff==='∞'?'∞':\"\".concat(spread.ff.toFixed(2),\"%\")]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-semibold mb-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Call: $\",spread.callSpread]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Put: $\",spread.putSpread]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-bold mb-1\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-blue-600\",children:[\"Call OI: \",spread.callOpenInterest1,\" \\u2192 \",spread.callOpenInterest2]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-red-600\",children:[\"Put OI: \",spread.putOpenInterest1,\" \\u2192 \",spread.putOpenInterest2]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-bold\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-blue-500\",children:[\"Call Vol: \",spread.callVolume1,\" \\u2192 \",spread.callVolume2]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-red-500\",children:[\"Put Vol: \",spread.putVolume1,\" \\u2192 \",spread.putVolume2]})]})}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();addSpreadToWatchlist(spread);},className:\"mt-2 px-2 py-1 text-[10px] bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors\",title:\"Add to Watchlist\",children:\"+ Watch\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs mt-2 opacity-75 flex gap-4\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"IV: \",spread.iv1,\"% \\u2192 \",spread.iv2,\"%\"]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Strike: $\",spread.strike]})]})]},idx))}):/*#__PURE__*/_jsx(\"p\",{className:\"text-sm opacity-75\",children:\"No spreads found\"}),/*#__PURE__*/_jsx(\"button\",{onClick:scanCalendarSpreads,disabled:scanningForSpreads||!ticker||!apiKey,className:\"w-full mt-3 px-4 py-2 rounded-lg font-semibold text-sm transition-all \".concat(scanningForSpreads||!ticker||!apiKey?'bg-gray-400 cursor-not-allowed':darkMode?'bg-slate-600 hover:bg-slate-700 text-white':'bg-slate-500 hover:bg-slate-600 text-white'),children:scanningForSpreads?'Scanning...':'Rescan for Best Spreads'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-2 \".concat(borderClass,\" p-4 rounded-lg \").concat(darkMode?'bg-indigo-900':'bg-indigo-50'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-3\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-lg\",children:\"\\uD83D\\uDD0D Market Scanner: Top FF Opportunities\"}),/*#__PURE__*/_jsx(\"button\",{onClick:fetchMarketScan,disabled:loadingMarketScan,className:\"text-xs px-3 py-1 rounded transition-all \".concat(loadingMarketScan?'bg-gray-400 cursor-not-allowed text-white':'bg-indigo-500 hover:bg-indigo-600 text-white'),children:loadingMarketScan?'Scanning...':'Start Market Scan'})]}),lastMarketScan&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs opacity-75 mb-3\",children:[\"Last scan: \",new Date(lastMarketScan).toLocaleString()]}),loadingMarketScan&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm opacity-75\",children:\"Scanning market for best FF opportunities...\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs opacity-50 mt-1\",children:\"This may take 2-5 minutes\"})]}),!loadingMarketScan&&marketScanResults.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2 max-h-96 overflow-y-auto\",children:marketScanResults.slice(0,20).map((stock,idx)=>{var _stock$price;return/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setTicker(stock.symbol);fetchOptionData(stock.symbol);},className:\"w-full text-left p-3 rounded transition-all hover:scale-[1.01] \".concat(parseFloat(stock.bestFF)>=30?darkMode?'bg-slate-800 hover:bg-slate-700':'bg-slate-100 hover:bg-slate-200':parseFloat(stock.bestFF)>=20?darkMode?'bg-yellow-900 hover:bg-yellow-800':'bg-yellow-100 hover:bg-yellow-200':darkMode?'bg-gray-700 hover:bg-gray-600':'bg-gray-100 hover:bg-gray-200'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold\",children:[\"#\",idx+1,\" \",stock.symbol]}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-xs opacity-75\",children:stock.name}),stock.hasEarnings&&/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 px-1.5 py-0.5 text-[10px] font-semibold rounded bg-yellow-500 text-black\",title:\"Has upcoming earnings\",children:\"\\uD83D\\uDCCA\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-xl font-bold\",children:[\"FF: \",stock.bestFF,\"%\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs opacity-75\",children:[\"$\",(_stock$price=stock.price)===null||_stock$price===void 0?void 0:_stock$price.toFixed(2)]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs mt-1 opacity-75 flex gap-3\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"MC: $\",(stock.marketCap/1e9).toFixed(1),\"B\"]}),stock.spread&&/*#__PURE__*/_jsxs(\"span\",{children:[stock.spread.exp1,\" \\u2192 \",stock.spread.exp2]})]})]},idx);})}),!loadingMarketScan&&marketScanResults.length===0&&lastMarketScan&&/*#__PURE__*/_jsx(\"p\",{className:\"text-sm opacity-75 text-center py-4\",children:\"No opportunities found. Try running a market scan.\"})]}),result&&/*#__PURE__*/_jsx(_Fragment,{children:result.error?/*#__PURE__*/_jsx(\"div\",{className:\"border-2 border-red-500 p-6 rounded-lg \".concat(darkMode?'bg-red-900 text-red-100':'bg-red-50 text-red-900'),children:/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold\",children:result.error})}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"border-2 border-slate-500 p-4 rounded-lg \".concat(darkMode?'bg-slate-800 text-slate-100':'bg-slate-50 text-slate-900'),children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs mb-1 opacity-75\",children:\"Forward Volatility\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-3xl font-bold\",children:[result.forwardVolPct,\"%\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs mt-2 opacity-75\",children:[result.daysToExp1,\"-\",result.daysToExp2,\" DTE\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-4 p-4 rounded-lg \".concat(getFFColor(result.forwardFactor)),children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs mb-1 opacity-75\",children:\"Forward Faktor\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-3xl font-bold\",children:[result.forwardFactor,\"%\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs mt-2 opacity-75\",children:parseFloat(result.forwardFactor)>=30?'✓ Excellent':parseFloat(result.forwardFactor)>=16?'✓ Good':'Below threshold'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-4 border-red-600 p-6 rounded-lg \".concat(darkMode?'bg-red-900 text-red-100':'bg-red-50 text-red-900'),children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-bold mb-4\",children:\"TARGET PRICE FOR FF 30%\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"border-2 border-red-400 p-4 rounded\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-semibold mb-2\",children:\"CALL SPREAD\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-5xl font-bold text-red-600\",children:[\"$\",result.maxCallCalendarPrice30]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs opacity-75 mt-2\",children:\"Max Entry Price\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-2 border-red-400 p-4 rounded\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-semibold mb-2\",children:\"PUT SPREAD\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-5xl font-bold text-red-600\",children:[\"$\",result.maxPutCalendarPrice30]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs opacity-75 mt-2\",children:\"Max Entry Price\"})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-4 border-blue-600 p-6 rounded-lg \".concat(darkMode?'bg-blue-900 text-blue-100':'bg-blue-50 text-blue-900'),children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-bold mb-4\",children:\"CURRENT CALENDAR SPREADS\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"border-2 border-blue-400 p-4 rounded\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-semibold mb-2\",children:\"CALL SPREAD\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Current Price:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold text-2xl text-blue-600\",children:[\"$\",result.callCalendarSpread]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-xs opacity-75\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"For FF 0%:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-semibold\",children:[\"$\",result.callCalendarSpreadAt0]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-2 border-pink-400 p-4 rounded\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-semibold mb-2\",children:\"PUT SPREAD\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Current Price:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold text-2xl text-pink-600\",children:[\"$\",result.putCalendarSpread]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-xs opacity-75\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"For FF 0%:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-semibold\",children:[\"$\",result.putCalendarSpreadAt0]})]})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"border-2 border-blue-500 p-4 rounded-lg \".concat(darkMode?'bg-blue-900 text-blue-100':'bg-blue-50 text-blue-900'),children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold mb-3\",children:\"Call Calendar Spread\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-3 gap-2 text-sm mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs opacity-75\",children:\"Front (T1)\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"font-bold\",children:[\"$\",result.callT1]}),volumeCallT1!==null&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs opacity-60\",children:[\"Vol: \",volumeCallT1.toLocaleString()]}),oiCallT1!==null&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs opacity-60\",children:[\"OI: \",oiCallT1.toLocaleString()]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs opacity-75\",children:\"Back (T2)\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"font-bold\",children:[\"$\",result.callT2]}),volumeCallT2!==null&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs opacity-60\",children:[\"Vol: \",volumeCallT2.toLocaleString()]}),oiCallT2!==null&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs opacity-60\",children:[\"OI: \",oiCallT2.toLocaleString()]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs opacity-75\",children:\"Spread\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"font-bold text-lg\",children:[\"$\",result.callCalendarSpread]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-2 rounded text-xs opacity-75 mb-3\",children:[\"Max f\\xFCr FF +30%: \",/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold\",children:[\"$\",result.maxCallCalendarPrice30]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-semibold\",children:\"Preis-Simulator\"}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",min:\"0\",max:parseFloat(result.callCalendarSpread)*4,step:\"0.01\",defaultValue:result.callCalendarSpread,onChange:e=>handlePriceSlider(parseFloat(e.target.value),true),className:\"w-full h-2 bg-blue-300 rounded-lg appearance-none cursor-pointer\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-xs\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",parseFloat(result.maxCallCalendarPrice30).toFixed(2),\" (FF 30%)\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold\",children:[\"$\",callPriceSlider!==null?callPriceSlider.toFixed(2):result.callCalendarSpread]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",(parseFloat(result.callCalendarSpread)*4).toFixed(2),\" (max)\"]})]}),callPriceSlider!==null&&adjustedFFCall!==null&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-2 rounded text-center text-sm font-bold border-2 \".concat(adjustedFFCall>=30?'border-green-500 bg-green-200':adjustedFFCall>=16?'border-yellow-500 bg-yellow-200':'border-gray-400 bg-gray-200'),children:[\"Angepasster FF: \",adjustedFFCall.toFixed(2),\"%\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-2 border-pink-500 p-4 rounded-lg \".concat(darkMode?'bg-pink-900 text-pink-100':'bg-pink-50 text-pink-900'),children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold mb-3\",children:\"Put Calendar Spread\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-3 gap-2 text-sm mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs opacity-75\",children:\"Front (T1)\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"font-bold\",children:[\"$\",result.putT1]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs opacity-75\",children:\"Back (T2)\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"font-bold\",children:[\"$\",result.putT2]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs opacity-75\",children:\"Spread\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"font-bold text-lg\",children:[\"$\",result.putCalendarSpread]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-2 rounded text-xs opacity-75 mb-3\",children:[\"Max f\\xFCr FF +30%: \",/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold\",children:[\"$\",result.maxPutCalendarPrice30]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-semibold\",children:\"Preis-Simulator\"}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",min:\"0\",max:parseFloat(result.putCalendarSpread)*4,step:\"0.01\",defaultValue:result.putCalendarSpread,onChange:e=>handlePriceSlider(parseFloat(e.target.value),false),className:\"w-full h-2 bg-pink-300 rounded-lg appearance-none cursor-pointer\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-xs\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",parseFloat(result.maxPutCalendarPrice30).toFixed(2),\" (FF 30%)\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold\",children:[\"$\",putPriceSlider!==null?putPriceSlider.toFixed(2):result.putCalendarSpread]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",(parseFloat(result.putCalendarSpread)*4).toFixed(2),\" (max)\"]})]}),putPriceSlider!==null&&adjustedFFPut!==null&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-2 rounded text-center text-sm font-bold border-2 \".concat(adjustedFFPut>=30?'border-green-500 bg-green-200':adjustedFFPut>=16?'border-yellow-500 bg-yellow-200':'border-gray-400 bg-gray-200'),children:[\"Angepasster FF: \",adjustedFFPut.toFixed(2),\"%\"]})]})]})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:exportCSV,className:\"w-full bg-slate-600 hover:bg-slate-700 text-white font-bold py-2 rounded-lg flex items-center justify-center gap-2\",children:[/*#__PURE__*/_jsx(Download,{size:20}),\" Ergebnis als CSV exportieren\"]}),tradeHistory.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"border-2 \".concat(borderClass,\" p-4 rounded-lg\"),children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold mb-3\",children:\"Trade History (letzte 10)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm space-y-2 max-h-96 overflow-y-auto\",children:tradeHistory.map((trade,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 rounded \".concat(parseFloat(trade.ff)>=30?darkMode?'bg-slate-800':'bg-slate-100':parseFloat(trade.ff)>=16?darkMode?'bg-yellow-900':'bg-yellow-100':darkMode?'bg-gray-700':'bg-gray-100'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 font-semibold mb-2\",children:[trade.ticker&&trade.ticker!=='N/A'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://img.logokit.com/ticker/\".concat(trade.ticker,\"?token=pk_fr93b6bfb5c425f6e3db62&format=png\"),alt:trade.ticker,className:\"w-6 h-6 rounded object-contain\",onError:e=>{e.target.style.display='none';e.target.nextElementSibling.style.display='flex';}}),/*#__PURE__*/_jsx(\"div\",{className:\"w-6 h-6 rounded-full hidden items-center justify-center text-xs font-bold text-white \".concat(trade.ticker[0]<='F'?'bg-blue-500':trade.ticker[0]<='L'?'bg-purple-500':trade.ticker[0]<='R'?'bg-green-500':trade.ticker[0]<='W'?'bg-orange-500':'bg-red-500'),children:trade.ticker[0]})]}),/*#__PURE__*/_jsxs(\"span\",{children:[trade.ticker,\" - \",trade.date,\" | FF: \",trade.ff.toFixed(2),\"%\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs mt-1 space-y-1\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"Aktuell: Call $\",parseFloat(trade.callSpreadCurrent).toFixed(4),\" | Put $\",parseFloat(trade.putSpreadCurrent).toFixed(4)]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"@ FF 30%: Call $\",parseFloat(trade.callSpreadFF30).toFixed(4),\" | Put $\",parseFloat(trade.putSpreadFF30).toFixed(4)]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"@ FF 0%: Call $\",parseFloat(trade.callSpreadFF0).toFixed(4),\" | Put $\",parseFloat(trade.putSpreadFF0).toFixed(4)]})]})]},idx))})]})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-1 space-y-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-bold mb-4\",children:\"Watchlist\"}),watchlist.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"p-4 rounded-lg border-2 \".concat(darkMode?'bg-gray-800 border-gray-700':'bg-gray-50 border-gray-200'),children:/*#__PURE__*/_jsx(\"p\",{className:\"text-sm opacity-75 text-center\",children:\"Scan tickers to build your watchlist\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:watchlist.map((item,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"w-full text-left p-3 rounded-lg border-2 transition-all hover:scale-[1.02] \".concat(item.type==='spread'?darkMode?'bg-slate-800 border-slate-600':'bg-slate-50 border-slate-200':ticker===item.symbol?darkMode?'bg-blue-900 border-blue-500':'bg-blue-50 border-blue-500':darkMode?'bg-gray-800 border-gray-700 hover:bg-gray-700':'bg-gray-50 border-gray-200 hover:bg-gray-100'),children:[item.type==='spread'?/*#__PURE__*/// Calendar Spread Watchlist Item\n_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs font-semibold bg-slate-500 text-white px-2 py-0.5 rounded\",children:\"SPREAD\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-bold\",children:item.symbol})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm mb-2\",children:[new Date(item.date1).toLocaleDateString('en-US',{month:'short',day:'numeric'}),\" \\u2192 \",new Date(item.date2).toLocaleDateString('en-US',{month:'short',day:'numeric'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs opacity-75\",children:\"FF\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-lg font-bold \".concat(parseFloat(item.ff)>=30?'text-green-500':parseFloat(item.ff)>=16?'text-yellow-500':'text-gray-500'),children:[item.ff,\"%\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs opacity-75\",children:\"Strike\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm font-bold\",children:[\"$\",item.strike]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs mt-2 opacity-75 flex gap-2\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"IV: \",item.iv1,\"% \\u2192 \",item.iv2,\"%\"]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"DTE: \",item.dte1,\" \\u2192 \",item.dte2]})]})]}):/*#__PURE__*/// Stock Watchlist Item\n_jsxs(\"button\",{onClick:()=>{setTicker(item.symbol);fetchOptionData(item.symbol);},className:\"w-full text-left\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-2\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://img.logokit.com/ticker/\".concat(item.symbol,\"?token=pk_fr93b6bfb5c425f6e3db62&format=png\"),alt:item.symbol,className:\"w-6 h-6 rounded object-contain\",onError:e=>{e.target.style.display='none';}}),/*#__PURE__*/_jsx(\"span\",{className:\"font-bold\",children:item.symbol}),item.hasEarnings&&/*#__PURE__*/_jsx(\"span\",{className:\"px-1.5 py-0.5 text-[10px] font-semibold rounded bg-yellow-500 text-black\",title:\"Has upcoming earnings\",children:\"\\uD83D\\uDCCA\"})]}),item.price&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm mb-1\",children:[\"$\",parseFloat(item.price).toFixed(2)]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs opacity-75\",children:\"Best FF\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-lg font-bold \".concat(parseFloat(item.bestFF)>=30?'text-green-500':parseFloat(item.bestFF)>=16?'text-yellow-500':'text-gray-500'),children:[item.bestFF,\"%\"]})]}),item.hasEarnings&&item.earningsDate&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs opacity-75\",children:\"Earnings\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs font-semibold\",children:new Date(item.earningsDate).toLocaleDateString('en-US',{month:'short',day:'numeric'})})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-[10px] opacity-50 mt-2\",children:new Date(item.lastUpdated).toLocaleDateString('en-US',{month:'short',day:'numeric',hour:'2-digit',minute:'2-digit'})})]},idx))}),watchlist.length>0&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setWatchlist([]);localStorage.removeItem('watchlist');},className:\"w-full px-3 py-2 text-xs rounded transition-all \".concat(darkMode?'bg-gray-700 hover:bg-gray-600 text-gray-300':'bg-gray-200 hover:bg-gray-300 text-gray-700'),children:\"Clear Watchlist\"})]})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-12 max-w-[1800px] mx-auto px-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(cardClass,\" rounded-lg shadow-lg p-6\"),children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold mb-4\",children:\"\\uD83D\\uDCDD Changelog\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"border-l-4 border-blue-500 pl-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-blue-600\",children:\"Latest Updates\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"text-sm mt-2 space-y-1\",children:[/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Enhanced Watchlist:\"}),\" Now supports both stocks and calendar spreads\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"User Profiles:\"}),\" Separate watchlists for Nils and Mr. FF\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Market Scanner:\"}),\" On-demand scan for best FF opportunities (\\u2265$500M market cap)\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Total Options Volume:\"}),\" Now shows complete options volume (puts + calls, all strikes)\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Post-Earnings Filter:\"}),\" Hide spreads with front expiration after earnings\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Wider Layout:\"}),\" Optimized for larger screens (1800px max-width)\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-l-4 border-green-500 pl-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-green-600\",children:\"Previous Features\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"text-sm mt-2 space-y-1\",children:[/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Forward Volatility Calculator:\"}),\" Black-Scholes based FF calculations\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Earnings Integration:\"}),\" Finnhub API for upcoming earnings dates\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Calendar Spread Scanner:\"}),\" Automated spread recommendations\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Real-time Data:\"}),\" Polygon.io integration for live options data\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Dark Mode:\"}),\" Toggle between light and dark themes\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Recent Tickers:\"}),\" Quick access to recently viewed stocks\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-l-4 border-purple-500 pl-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-purple-600\",children:\"Technical Details\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"text-sm mt-2 space-y-1\",children:[/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Built with:\"}),\" React, Tailwind CSS, Vercel Serverless Functions\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Data Sources:\"}),\" Polygon.io (options), Finnhub (earnings), Yahoo Finance (prices)\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Storage:\"}),\" LocalStorage for user preferences and watchlists\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Performance:\"}),\" 4-hour caching for market scans, non-blocking UI\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Forward Volatility:\"}),\" Based on SSRN research paper methodology\"]})]})]})]})]})}),/*#__PURE__*/_jsx(Analytics,{})]});}","map":{"version":3,"names":["useState","useEffect","Download","Moon","Sun","Analytics","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ForwardVolCalculator","date1","setDate1","date2","setDate2","iv1","setIv1","iv2","setIv2","spotPrice","setSpotPrice","strikePrice","setStrikePrice","riskFreeRate","setRiskFreeRate","dividend","setDividend","result","setResult","darkMode","setDarkMode","tradeHistory","setTradeHistory","callPriceSlider","setCallPriceSlider","putPriceSlider","setPutPriceSlider","adjustedFFCall","setAdjustedFFCall","adjustedFFPut","setAdjustedFFPut","pricingModel","setPricingModel","ticker","setTicker","loading","setLoading","loadError","setLoadError","apiKey","setApiKey","localStorage","getItem","showTickerDropdown","setShowTickerDropdown","filteredTickers","setFilteredTickers","volumeCallT1","setVolumeCallT1","volumeCallT2","setVolumeCallT2","oiCallT1","setOiCallT1","oiCallT2","setOiCallT2","availableExpirations","setAvailableExpirations","today","Date","fridays","currentDate","length","setDate","getDate","getDay","push","toISOString","split","marketCap","setMarketCap","avgOptionsVolume","setAvgOptionsVolume","recommendedSpreads","setRecommendedSpreads","scanningForSpreads","setScanningForSpreads","nextEarningsDate","setNextEarningsDate","earningsTime","setEarningsTime","earningsConflict","setEarningsConflict","currentUser","setCurrentUser","hidePostEarningsSpreads","setHidePostEarningsSpreads","marketScanResults","setMarketScanResults","loadingMarketScan","setLoadingMarketScan","lastMarketScan","setLastMarketScan","minOpenInterest","setMinOpenInterest","minVolume","setMinVolume","maxDTEGap","setMaxDTEGap","recentTickers","setRecentTickers","saved","concat","JSON","parse","watchlist","setWatchlist","savedWatchlist","savedRecent","popularStocks","symbol","name","handleTickerChange","value","upper","toUpperCase","matches","filter","stock","startsWith","includes","slice","selectTicker","loadDemoData","setTimeout","calculateResults","addToRecentTickers","upperSymbol","trim","updated","t","setItem","stringify","addToWatchlist","bestFF","hasEarnings","earningsDate","price","spreadData","arguments","undefined","lastUpdated","item","addSpreadToWatchlist","spread","spreadId","strike","id","type","dte1","dte2","ff","callSpread","fetchMarketScan","console","log","response","fetch","status","data","json","success","results","lastScan","error","fetchOptionData","tickerSymbol","quoteUrl","quoteResponse","ok","Error","quoteData","currentPrice","c","toFixed","tickerDetailsUrl","tickerDetailsResponse","_tickerDetailsData$re","tickerDetailsData","market_cap","expirationDates","contractsUrl","allDates","Set","contractsResponse","contractsData","forEach","contract","expiration_date","add","next_url","Array","from","sort","date","exp1Date","exp2Date","avgVol","calculateAvgOptionsVolume","fetchEarningsDate","roundedStrike","Math","round","gotRealIV1","gotRealIV2","totalVolume","volumeCount","chain1Url","chain1Response","chain1Data","atmCall","opt","_opt$details","details","strike_price","abs","a","b","_atmCall$day","implied_volatility","iv1Value","day","volume","open_interest","_opt$day","chain2Url","chain2Response","chain2Data","_opt$details2","_atmCall$day2","iv2Value","_opt$day2","optError","scanCalendarSpreads","message","apiUrl","errorData","tradingDays","dayOfWeek","promises","map","then","res","catch","err","responses","Promise","all","dailyVolumes","index","dayTotal","_opt$day3","reduce","sum","vol","avgDailyVol","toLocaleString","S","parseFloat","r","q","expsToScan","ivPromises","expDate","maxRetries","retryCount","timeoutPromise","_","reject","callsResponse","putsResponse","race","_callsData$results","_putsData$results","callsData","putsData","_putsData$results2","atmStrike","calls","_opt$details3","_opt$details4","contract_type","puts","_opt$details5","_opt$details6","callsWithDelta","_opt$greeks","greeks","delta","sortedCalls","deltaA","deltaB","selectedCall","correspondingPut","find","put","_put$details","iv","callOpenInterest","callVolume","putOpenInterest","putVolume","putIv","distA","distB","_put$details2","warn","errorText","text","substring","resolve","ivResults","spreads","now","i","j","exp1","exp2","d1","d2","daysToExp1","daysToExp2","T1","T2","v1","v2","numerator","denominator","forwardVol","sqrt","strike1","strike2","callT1","getOptionPrice","callT2","putT1","putT2","putSpread","isPostEarnings","frontExpDate","floor","callOpenInterest1","callVolume1","putOpenInterest1","putVolume1","callOpenInterest2","callVolume2","putOpenInterest2","putVolume2","filteredSpreads","s","callHasOI","putHasOI","callOIMeets","putOIMeets","callVolMeets","putVolMeets","dteGap","topSpreads","min","bestSpread","stack","calculateDTE","expirationDate","diffMs","diffDays","max","updateIVForDate","isFirstDate","chainUrl","chainResponse","chainData","_opt$details7","_atmCall$day3","ivValue","normDist","x","a1","a2","a3","a4","a5","p","sign","y","exp","blackScholesCall","K","T","sigma","sqrtT","callPrice","blackScholesPut","putPrice","black76Call","F","black76Put","binomialCall","steps","dt","u","d","prices","pow","values","binomialPut","isCall","handlePriceSlider","newPrice","isCallSpread","d1_16NY","setHours","d2_16NY","msPerDay","frontPrice","targetBackPrice","v2Low","v2High","v2Mid","iteration","backPrice","diff","newFF","forwardFactor","forwardVolPct","callCalendarSpread","putCalendarSpread","targetForwardFactor30","requiredForwardVol30","iv2Squared30","requiredIV230","callT2At30","maxCallCalendarPrice30","putT2At30","maxPutCalendarPrice30","targetForwardFactor0","requiredForwardVol0","iv2Squared0","requiredIV20","callT2At0","callCalendarSpreadAt0","putT2At0","putCalendarSpreadAt0","newResult","timestamp","historyEntry","callSpreadCurrent","putSpreadCurrent","callSpreadFF30","putSpreadFF30","callSpreadFF0","putSpreadFF0","getFFColor","ffNum","exportCSV","csv","row","join","blob","Blob","url","URL","createObjectURL","document","createElement","href","download","click","timeoutId","clearTimeout","strategyStart","strategyEnd","daysUntilEarnings","ceil","timing","daysAway","bgClass","cardClass","borderClass","className","children","onChange","e","target","onClick","size","user","placeholder","rel","onFocus","onBlur","onKeyDown","key","disabled","recentTicker","toLocaleDateString","weekday","year","month","dte","label","setter","field","idx","step","src","alt","onError","style","display","nextElementSibling","borderColor","checked","title","parseInt","prevSpreads","filtered","toString","stopPropagation","_stock$price","defaultValue","trade","hour","minute","removeItem"],"sources":["/workspace/src/App.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { Download, Moon, Sun } from 'lucide-react';\nimport { Analytics } from '@vercel/analytics/react';\n\nexport default function ForwardVolCalculator() {\n  const [date1, setDate1] = useState('2025-10-24');\n  const [date2, setDate2] = useState('2025-10-31');\n  const [iv1, setIv1] = useState('50');\n  const [iv2, setIv2] = useState('40');\n  const [spotPrice, setSpotPrice] = useState('100');\n  const [strikePrice, setStrikePrice] = useState('100');\n  const [riskFreeRate, setRiskFreeRate] = useState('4');\n  const [dividend, setDividend] = useState('0');\n  const [result, setResult] = useState(null);\n  const [darkMode, setDarkMode] = useState(false);\n  const [tradeHistory, setTradeHistory] = useState([]);\n  const [callPriceSlider, setCallPriceSlider] = useState(null);\n  const [putPriceSlider, setPutPriceSlider] = useState(null);\n  const [adjustedFFCall, setAdjustedFFCall] = useState(null);\n  const [adjustedFFPut, setAdjustedFFPut] = useState(null);\n  const [pricingModel, setPricingModel] = useState('blackscholes');\n  const [ticker, setTicker] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [loadError, setLoadError] = useState(null);\n  const [apiKey, setApiKey] = useState(localStorage.getItem('polygonKey') || '');\n  const [showTickerDropdown, setShowTickerDropdown] = useState(false);\n  const [filteredTickers, setFilteredTickers] = useState([]);\n  const [volumeCallT1, setVolumeCallT1] = useState(null);\n  const [volumeCallT2, setVolumeCallT2] = useState(null);\n  const [oiCallT1, setOiCallT1] = useState(null);\n  const [oiCallT2, setOiCallT2] = useState(null);\n  const [availableExpirations, setAvailableExpirations] = useState(() => {\n    // Default: next 50 Fridays\n    const today = new Date();\n    const fridays = [];\n    let currentDate = new Date(today);\n\n    while (fridays.length < 50) {\n      currentDate.setDate(currentDate.getDate() + 1);\n      if (currentDate.getDay() === 5) {\n        fridays.push(currentDate.toISOString().split('T')[0]);\n      }\n    }\n\n    return fridays;\n  });\n  const [marketCap, setMarketCap] = useState(null);\n  const [avgOptionsVolume, setAvgOptionsVolume] = useState(null);\n  const [recommendedSpreads, setRecommendedSpreads] = useState([]);\n  const [scanningForSpreads, setScanningForSpreads] = useState(false);\n  const [nextEarningsDate, setNextEarningsDate] = useState(null);\n  const [earningsTime, setEarningsTime] = useState(null);\n  const [earningsConflict, setEarningsConflict] = useState(null);\n  const [currentUser, setCurrentUser] = useState(() => {\n    return localStorage.getItem('currentUser') || 'Nils';\n  });\n  const [hidePostEarningsSpreads, setHidePostEarningsSpreads] = useState(false);\n  const [marketScanResults, setMarketScanResults] = useState([]);\n  const [loadingMarketScan, setLoadingMarketScan] = useState(false);\n  const [lastMarketScan, setLastMarketScan] = useState(null);\n  const [minOpenInterest, setMinOpenInterest] = useState(100);\n  const [minVolume, setMinVolume] = useState(0);\n  const [maxDTEGap, setMaxDTEGap] = useState(200); // Maximum gap between expirations in days\n  const [recentTickers, setRecentTickers] = useState(() => {\n    const saved = localStorage.getItem(`recentTickers_${currentUser}`);\n    return saved ? JSON.parse(saved) : [];\n  });\n  const [watchlist, setWatchlist] = useState(() => {\n    const saved = localStorage.getItem(`watchlist_${currentUser}`);\n    return saved ? JSON.parse(saved) : [];\n  });\n\n  // Reload user-specific data when user changes\n  useEffect(() => {\n    const savedWatchlist = localStorage.getItem(`watchlist_${currentUser}`);\n    const savedRecent = localStorage.getItem(`recentTickers_${currentUser}`);\n    setWatchlist(savedWatchlist ? JSON.parse(savedWatchlist) : []);\n    setRecentTickers(savedRecent ? JSON.parse(savedRecent) : []);\n  }, [currentUser]);\n\n  // Popular US stocks for autocomplete\n  const popularStocks = [\n    { symbol: 'AAPL', name: 'Apple Inc.' },\n    { symbol: 'MSFT', name: 'Microsoft Corporation' },\n    { symbol: 'GOOGL', name: 'Alphabet Inc.' },\n    { symbol: 'AMZN', name: 'Amazon.com Inc.' },\n    { symbol: 'NVDA', name: 'NVIDIA Corporation' },\n    { symbol: 'META', name: 'Meta Platforms Inc.' },\n    { symbol: 'TSLA', name: 'Tesla Inc.' },\n    { symbol: 'BRK.B', name: 'Berkshire Hathaway Inc.' },\n    { symbol: 'V', name: 'Visa Inc.' },\n    { symbol: 'JPM', name: 'JPMorgan Chase & Co.' },\n    { symbol: 'WMT', name: 'Walmart Inc.' },\n    { symbol: 'JNJ', name: 'Johnson & Johnson' },\n    { symbol: 'MA', name: 'Mastercard Inc.' },\n    { symbol: 'PG', name: 'Procter & Gamble Co.' },\n    { symbol: 'UNH', name: 'UnitedHealth Group Inc.' },\n    { symbol: 'HD', name: 'Home Depot Inc.' },\n    { symbol: 'DIS', name: 'Walt Disney Co.' },\n    { symbol: 'BAC', name: 'Bank of America Corp.' },\n    { symbol: 'ADBE', name: 'Adobe Inc.' },\n    { symbol: 'CRM', name: 'Salesforce Inc.' },\n    { symbol: 'NFLX', name: 'Netflix Inc.' },\n    { symbol: 'CMCSA', name: 'Comcast Corporation' },\n    { symbol: 'XOM', name: 'Exxon Mobil Corporation' },\n    { symbol: 'COST', name: 'Costco Wholesale Corp.' },\n    { symbol: 'PEP', name: 'PepsiCo Inc.' },\n    { symbol: 'TMO', name: 'Thermo Fisher Scientific Inc.' },\n    { symbol: 'ABT', name: 'Abbott Laboratories' },\n    { symbol: 'NKE', name: 'Nike Inc.' },\n    { symbol: 'CSCO', name: 'Cisco Systems Inc.' },\n    { symbol: 'ORCL', name: 'Oracle Corporation' },\n    { symbol: 'AMD', name: 'Advanced Micro Devices Inc.' },\n    { symbol: 'INTC', name: 'Intel Corporation' },\n    { symbol: 'QCOM', name: 'Qualcomm Inc.' },\n    { symbol: 'TXN', name: 'Texas Instruments Inc.' },\n    { symbol: 'AVGO', name: 'Broadcom Inc.' },\n    { symbol: 'CVX', name: 'Chevron Corporation' },\n    { symbol: 'KO', name: 'Coca-Cola Co.' },\n    { symbol: 'MCD', name: 'McDonald\\'s Corporation' },\n    { symbol: 'PYPL', name: 'PayPal Holdings Inc.' },\n    { symbol: 'UBER', name: 'Uber Technologies Inc.' },\n    { symbol: 'BA', name: 'Boeing Co.' },\n    { symbol: 'CAT', name: 'Caterpillar Inc.' },\n    { symbol: 'GE', name: 'General Electric Co.' },\n    { symbol: 'F', name: 'Ford Motor Co.' },\n    { symbol: 'GM', name: 'General Motors Co.' },\n    { symbol: 'SBUX', name: 'Starbucks Corporation' },\n    { symbol: 'PLTR', name: 'Palantir Technologies Inc.' },\n    { symbol: 'COIN', name: 'Coinbase Global Inc.' },\n    { symbol: 'SQ', name: 'Block Inc.' },\n    { symbol: 'SNOW', name: 'Snowflake Inc.' },\n    { symbol: 'SPY', name: 'SPDR S&P 500 ETF Trust' },\n    { symbol: 'QQQ', name: 'Invesco QQQ Trust' },\n    { symbol: 'IWM', name: 'iShares Russell 2000 ETF' },\n    { symbol: 'DIA', name: 'SPDR Dow Jones Industrial Average ETF' },\n    { symbol: 'VTI', name: 'Vanguard Total Stock Market ETF' },\n    { symbol: 'VOO', name: 'Vanguard S&P 500 ETF' },\n    { symbol: 'GLD', name: 'SPDR Gold Trust' },\n    { symbol: 'SLV', name: 'iShares Silver Trust' },\n    { symbol: 'TLT', name: 'iShares 20+ Year Treasury Bond ETF' },\n    { symbol: 'XLE', name: 'Energy Select Sector SPDR Fund' },\n    { symbol: 'XLF', name: 'Financial Select Sector SPDR Fund' },\n    { symbol: 'XLK', name: 'Technology Select Sector SPDR Fund' },\n  ];\n\n  const handleTickerChange = (value) => {\n    const upper = value.toUpperCase();\n    setTicker(upper);\n\n    if (upper.length > 0) {\n      const matches = popularStocks.filter(stock =>\n        stock.symbol.startsWith(upper) ||\n        stock.name.toUpperCase().includes(upper)\n      ).slice(0, 10);\n      setFilteredTickers(matches);\n      setShowTickerDropdown(matches.length > 0);\n    } else {\n      setFilteredTickers([]);\n      setShowTickerDropdown(false);\n    }\n  };\n\n  const selectTicker = (symbol) => {\n    setTicker(symbol);\n    setShowTickerDropdown(false);\n    setFilteredTickers([]);\n  };\n\n  const loadDemoData = () => {\n    // Demo data for SPY\n    setTicker('SPY');\n    setSpotPrice('580.25');\n    setStrikePrice('580');\n    setDate1('2025-10-24');\n    setDate2('2025-10-31');\n    setIv1('12.5');\n    setIv2('11.8');\n    setRiskFreeRate('4.5');\n    setDividend('1.2');\n\n    // Auto-calculate\n    setTimeout(() => calculateResults(), 100);\n  };\n\n  // Add ticker to recent tickers list\n  const addToRecentTickers = (symbol) => {\n    const upperSymbol = symbol.toUpperCase().trim();\n    const updated = [upperSymbol, ...recentTickers.filter(t => t !== upperSymbol)].slice(0, 6);\n    setRecentTickers(updated);\n    localStorage.setItem(`recentTickers_${currentUser}`, JSON.stringify(updated));\n  };\n\n  const addToWatchlist = (symbol, bestFF, hasEarnings, earningsDate, price, spreadData = null) => {\n    const upperSymbol = symbol.toUpperCase().trim();\n    const updated = [\n      {\n        symbol: upperSymbol,\n        bestFF: bestFF,\n        hasEarnings: hasEarnings,\n        earningsDate: earningsDate,\n        price: price,\n        spreadData: spreadData, // Calendar spread details if applicable\n        lastUpdated: new Date().toISOString()\n      },\n      ...watchlist.filter(item => item.symbol !== upperSymbol)\n    ].slice(0, 10); // Keep max 10 items\n    setWatchlist(updated);\n    localStorage.setItem(`watchlist_${currentUser}`, JSON.stringify(updated));\n  };\n\n  const addSpreadToWatchlist = (spread) => {\n    const spreadId = `${spread.date1}-${spread.date2}-${spread.strike}`;\n    const updated = [\n      {\n        id: spreadId,\n        type: 'spread',\n        symbol: ticker,\n        date1: spread.date1,\n        date2: spread.date2,\n        dte1: spread.dte1,\n        dte2: spread.dte2,\n        ff: spread.ff,\n        strike: spread.strike,\n        iv1: spread.iv1,\n        iv2: spread.iv2,\n        callSpread: spread.callSpread,\n        lastUpdated: new Date().toISOString()\n      },\n      ...watchlist.filter(item => item.id !== spreadId)\n    ].slice(0, 10); // Keep max 10 items\n    setWatchlist(updated);\n    localStorage.setItem(`watchlist_${currentUser}`, JSON.stringify(updated));\n  };\n\n  const fetchMarketScan = async () => {\n    console.log('🔍 Starting market scan...');\n    setLoadingMarketScan(true);\n    try {\n      console.log('📡 Fetching /api/market-scan...');\n      const response = await fetch('/api/market-scan');\n      console.log('📡 Response status:', response.status);\n      const data = await response.json();\n      console.log('📡 Response data:', data);\n      if (data.success) {\n        console.log('✅ Market scan successful, setting results:', data.results.length, 'stocks');\n        setMarketScanResults(data.results);\n        setLastMarketScan(data.lastScan);\n      } else {\n        console.log('❌ Market scan failed:', data);\n      }\n    } catch (error) {\n      console.error('❌ Error fetching market scan:', error);\n    }\n    setLoadingMarketScan(false);\n    console.log('🔍 Market scan completed');\n  };\n\n  const fetchOptionData = async (tickerSymbol) => {\n    if (!tickerSymbol || tickerSymbol.trim() === '') {\n      setLoadError('Please enter a ticker symbol');\n      return;\n    }\n\n    if (!apiKey || apiKey.trim() === '') {\n      setLoadError('Please enter your Polygon.io API key');\n      return;\n    }\n\n    setLoading(true);\n    setLoadError(null);\n    \n    // Reset earnings data when loading new ticker\n    setNextEarningsDate(null);\n    setEarningsTime(null);\n\n    try {\n      const symbol = tickerSymbol.toUpperCase().trim();\n      console.log('Fetching data for:', symbol);\n\n      // Save API key to localStorage\n      localStorage.setItem('polygonKey', apiKey);\n\n      // 1. Get current price (real-time data)\n      const today = new Date();\n      const quoteUrl = `https://api.polygon.io/v2/aggs/ticker/${symbol}/prev?adjusted=true&apiKey=${apiKey}`;\n      console.log('Fetching current price from Polygon.io...');\n\n      const quoteResponse = await fetch(quoteUrl);\n\n      if (!quoteResponse.ok) {\n        throw new Error(`API Error (${quoteResponse.status}). Check your API key.`);\n      }\n\n      const quoteData = await quoteResponse.json();\n      console.log('Quote data:', quoteData);\n\n      if (quoteData.status === 'ERROR') {\n        throw new Error(quoteData.error || 'Invalid ticker symbol');\n      }\n\n      if (!quoteData.results || quoteData.results.length === 0) {\n        throw new Error('No price data available for this ticker');\n      }\n\n      const result = quoteData.results[0];\n      const currentPrice = result.c; // closing price\n\n      if (!currentPrice || currentPrice <= 0) {\n        throw new Error('No valid price data available');\n      }\n\n      setSpotPrice(currentPrice.toFixed(2));\n\n      // 2. Get ticker details (market cap)\n      try {\n        const tickerDetailsUrl = `https://api.polygon.io/v3/reference/tickers/${symbol}?apiKey=${apiKey}`;\n        const tickerDetailsResponse = await fetch(tickerDetailsUrl);\n        if (tickerDetailsResponse.ok) {\n          const tickerDetailsData = await tickerDetailsResponse.json();\n          if (tickerDetailsData.results?.market_cap) {\n            setMarketCap(tickerDetailsData.results.market_cap);\n          }\n        }\n      } catch (error) {\n        console.log('Could not load market cap:', error);\n      }\n\n      // 3. Load available expiration dates using Options Contracts Reference API\n      let expirationDates = [];\n      try {\n        console.log('Fetching available expiration dates...');\n        let contractsUrl = `https://api.polygon.io/v3/reference/options/contracts?underlying_ticker=${symbol}&expired=false&limit=1000&apiKey=${apiKey}`;\n        const allDates = new Set();\n\n        // Fetch all pages (pagination)\n        while (contractsUrl) {\n          const contractsResponse = await fetch(contractsUrl);\n          if (contractsResponse.ok) {\n            const contractsData = await contractsResponse.json();\n\n            if (contractsData.results && contractsData.results.length > 0) {\n              contractsData.results.forEach(contract => {\n                if (contract.expiration_date) {\n                  allDates.add(contract.expiration_date);\n                }\n              });\n            }\n\n            // Check for next page\n            contractsUrl = contractsData.next_url ? `${contractsData.next_url}&apiKey=${apiKey}` : null;\n          } else {\n            break;\n          }\n        }\n\n        // Sort dates and filter future dates only\n        expirationDates = Array.from(allDates)\n          .sort()\n          .filter(date => new Date(date) > today);\n\n        setAvailableExpirations(expirationDates);\n        console.log(`Found ${expirationDates.length} available expiration dates`);\n      } catch (error) {\n        console.log('Could not load expiration dates:', error);\n      }\n\n      // 4. Set default dates (use first two available, or calculate Fridays as fallback)\n      let exp1Date, exp2Date;\n\n      if (expirationDates.length >= 2) {\n        exp1Date = expirationDates[0];\n        exp2Date = expirationDates[1];\n        setDate1(exp1Date);\n        setDate2(exp2Date);\n      } else {\n        // Fallback: Calculate next two Fridays\n        const fridays = [];\n        let currentDate = new Date(today);\n\n        while (fridays.length < 2) {\n          if (currentDate.getDay() === 5 && currentDate > today) {\n            fridays.push(new Date(currentDate));\n          }\n          currentDate.setDate(currentDate.getDate() + 1);\n        }\n\n        exp1Date = fridays[0].toISOString().split('T')[0];\n        exp2Date = fridays[1].toISOString().split('T')[0];\n        setDate1(exp1Date);\n        setDate2(exp2Date);\n      }\n\n      // 4.5. Calculate average options volume (20 trading days)\n      const avgVol = await calculateAvgOptionsVolume(symbol, apiKey);\n      if (avgVol !== null) {\n        setAvgOptionsVolume(avgVol);\n      }\n\n      // 4.6. Fetch earnings date\n      console.log('About to fetch earnings date...');\n      await fetchEarningsDate(symbol, apiKey);\n      console.log('Earnings fetch completed');\n\n      // 5. Set ATM strike (rounded to nearest $5)\n      const roundedStrike = Math.round(currentPrice / 5) * 5;\n      setStrikePrice(roundedStrike.toFixed(2));\n\n      // 6. Try to get options data using Option Chain Snapshot API with date filters\n      let gotRealIV1 = false;\n      let gotRealIV2 = false;\n      let totalVolume = 0;\n      let volumeCount = 0;\n\n      try {\n        // Fetch expiration 1 options with date filter\n        const chain1Url = `https://api.polygon.io/v3/snapshot/options/${symbol}?expiration_date.gte=${exp1Date}&expiration_date.lte=${exp1Date}&contract_type=call&limit=250&apiKey=${apiKey}`;\n        console.log('Fetching options chain for expiration 1...');\n\n        const chain1Response = await fetch(chain1Url);\n\n        if (chain1Response.ok) {\n          const chain1Data = await chain1Response.json();\n          console.log('Expiration 1 options data:', chain1Data);\n\n          if (chain1Data.status === 'OK' && chain1Data.results && chain1Data.results.length > 0) {\n            // Find ATM call option - closest to rounded strike\n            const atmCall = chain1Data.results\n              .filter(opt => opt.details?.strike_price && Math.abs(opt.details.strike_price - roundedStrike) < 20)\n              .sort((a, b) => Math.abs(a.details.strike_price - roundedStrike) - Math.abs(b.details.strike_price - roundedStrike))[0];\n\n            if (atmCall) {\n              if (atmCall.implied_volatility !== undefined && atmCall.implied_volatility > 0) {\n                const iv1Value = (atmCall.implied_volatility * 100).toFixed(2);\n                setIv1(iv1Value);\n                gotRealIV1 = true;\n              }\n              if (atmCall.day?.volume !== undefined) {\n                setVolumeCallT1(atmCall.day.volume);\n                totalVolume += atmCall.day.volume;\n                volumeCount++;\n              }\n              if (atmCall.open_interest !== undefined) {\n                setOiCallT1(atmCall.open_interest);\n              }\n            }\n\n            // Calculate average volume from all options in this expiration\n            chain1Data.results.forEach(opt => {\n              if (opt.day?.volume !== undefined && opt.day.volume > 0) {\n                totalVolume += opt.day.volume;\n                volumeCount++;\n              }\n            });\n          }\n        }\n\n        // Fetch expiration 2 options with date filter\n        const chain2Url = `https://api.polygon.io/v3/snapshot/options/${symbol}?expiration_date.gte=${exp2Date}&expiration_date.lte=${exp2Date}&contract_type=call&limit=250&apiKey=${apiKey}`;\n        console.log('Fetching options chain for expiration 2...');\n\n        const chain2Response = await fetch(chain2Url);\n\n        if (chain2Response.ok) {\n          const chain2Data = await chain2Response.json();\n          console.log('Expiration 2 options data:', chain2Data);\n\n          if (chain2Data.status === 'OK' && chain2Data.results && chain2Data.results.length > 0) {\n            // Find ATM call option - closest to rounded strike\n            const atmCall = chain2Data.results\n              .filter(opt => opt.details?.strike_price && Math.abs(opt.details.strike_price - roundedStrike) < 20)\n              .sort((a, b) => Math.abs(a.details.strike_price - roundedStrike) - Math.abs(b.details.strike_price - roundedStrike))[0];\n\n            if (atmCall) {\n              if (atmCall.implied_volatility !== undefined && atmCall.implied_volatility > 0) {\n                const iv2Value = (atmCall.implied_volatility * 100).toFixed(2);\n                setIv2(iv2Value);\n                gotRealIV2 = true;\n              }\n              if (atmCall.day?.volume !== undefined) {\n                setVolumeCallT2(atmCall.day.volume);\n                totalVolume += atmCall.day.volume;\n                volumeCount++;\n              }\n              if (atmCall.open_interest !== undefined) {\n                setOiCallT2(atmCall.open_interest);\n              }\n            }\n\n            // Calculate average volume from all options in this expiration\n            chain2Data.results.forEach(opt => {\n              if (opt.day?.volume !== undefined && opt.day.volume > 0) {\n                totalVolume += opt.day.volume;\n                volumeCount++;\n              }\n            });\n          }\n        }\n\n        // Calculate and set average options volume\n        if (volumeCount > 0) {\n          const avgVol = Math.round(totalVolume / volumeCount);\n          setAvgOptionsVolume(avgVol);\n          console.log(`Average options volume: ${avgVol} (from ${volumeCount} contracts)`);\n        }\n\n        // If we didn't get real IV data, use defaults\n        if (!gotRealIV1 || !gotRealIV2) {\n          console.log('Options data not available (expected with free tier), using defaults');\n          if (!gotRealIV1) setIv1('30');\n          if (!gotRealIV2) setIv2('28');\n        }\n\n      } catch (optError) {\n        console.log('Error fetching options data:', optError);\n        // Use reasonable defaults based on historical volatility\n        setIv1('30');\n        setIv2('28');\n      }\n\n      setLoading(false);\n      setLoadError(null);\n\n      if (gotRealIV1 && gotRealIV2) {\n        console.log('✅ Stock price and real IV data loaded from Polygon.io!');\n      } else {\n        console.log('✅ Stock price loaded! IV values are estimates (upgrade for real IV data)');\n      }\n\n      // Auto-calculate after loading data\n      setTimeout(() => calculateResults(), 100);\n\n      // Scan for best calendar spreads\n      setTimeout(() => scanCalendarSpreads(), 500);\n\n      // Add to recent tickers on successful load\n      addToRecentTickers(symbol);\n\n    } catch (error) {\n      console.error('Error fetching option data:', error);\n      setLoadError(error.message || 'Failed to load option data');\n      setLoading(false);\n    }\n  };\n\n  // Fetch next earnings date using our serverless API (bypasses CORS)\n  const fetchEarningsDate = async (symbol) => {\n    try {\n      console.log('📊 Fetching earnings date for:', symbol);\n      \n      // Use our serverless API endpoint (works both locally and deployed)\n      const apiUrl = `/api/earnings?symbol=${symbol}`;\n      console.log('Fetching from API:', apiUrl);\n      \n      const response = await fetch(apiUrl);\n      console.log('API response status:', response.status);\n      \n      if (response.ok) {\n        const data = await response.json();\n        console.log('API data received:', data);\n        \n        if (data.success && data.earningsDate) {\n          setNextEarningsDate(data.earningsDate);\n          setEarningsTime(data.earningsTime || 'Scheduled');\n          console.log('✅ Successfully set earnings date:', data.earningsDate, data.earningsTime);\n          return;\n        } else {\n          console.log('No earnings data in response');\n        }\n      } else {\n        const errorData = await response.json();\n        console.error('API error:', response.status, errorData);\n      }\n      \n      // If no earnings found\n      setNextEarningsDate(null);\n      setEarningsTime(null);\n      console.log('ℹ️ No upcoming earnings found for', symbol);\n      \n    } catch (error) {\n      console.error('❌ Error fetching earnings date:', error);\n      setNextEarningsDate(null);\n      setEarningsTime(null);\n    }\n  };\n\n  // Calculate average TOTAL options volume (puts + calls) over last 20 trading days\n  const calculateAvgOptionsVolume = async (symbol, apiKey) => {\n    try {\n      console.log('Calculating average TOTAL options volume (puts + calls, 20 days)...');\n\n      // Calculate last 20 trading days (skip weekends)\n      const tradingDays = [];\n      let currentDate = new Date();\n\n      while (tradingDays.length < 20) {\n        currentDate.setDate(currentDate.getDate() - 1);\n        const dayOfWeek = currentDate.getDay();\n        // Skip weekends (0 = Sunday, 6 = Saturday)\n        if (dayOfWeek !== 0 && dayOfWeek !== 6) {\n          tradingDays.push(currentDate.toISOString().split('T')[0]);\n        }\n      }\n\n      // Fetch snapshots for all 20 days in parallel (no rate limit!)\n      const promises = tradingDays.map(date =>\n        fetch(`https://api.polygon.io/v3/snapshot/options/${symbol}?expiration_date=${date}&limit=1000&apiKey=${apiKey}`)\n          .then(res => res.json())\n          .catch(err => {\n            console.log(`Failed to fetch snapshot for ${date}:`, err);\n            return null;\n          })\n      );\n\n      const responses = await Promise.all(promises);\n\n      // Calculate total volume per day, then average across days\n      const dailyVolumes = [];\n\n      responses.forEach((data, index) => {\n        if (data?.results && data.results.length > 0) {\n          let dayTotal = 0;\n          data.results.forEach(opt => {\n            if (opt.day?.volume && opt.day.volume > 0) {\n              dayTotal += opt.day.volume;\n            }\n          });\n          if (dayTotal > 0) {\n            dailyVolumes.push(dayTotal);\n          }\n        }\n      });\n\n      if (dailyVolumes.length > 0) {\n        const totalVolume = dailyVolumes.reduce((sum, vol) => sum + vol, 0);\n        const avgDailyVol = Math.round(totalVolume / dailyVolumes.length);\n        console.log(`Average daily TOTAL options volume (puts + calls): ${avgDailyVol.toLocaleString()} (from ${dailyVolumes.length} days)`);\n        return avgDailyVol;\n      }\n\n      return null;\n    } catch (error) {\n      console.error('Error calculating avg options volume:', error);\n      return null;\n    }\n  };\n\n  // Scan all expiration combinations to find highest FF spreads\n  const scanCalendarSpreads = async () => {\n    if (!ticker || !apiKey || availableExpirations.length < 2) return;\n\n    setScanningForSpreads(true);\n    setRecommendedSpreads([]);\n\n    try {\n      const symbol = ticker.toUpperCase().trim();\n      const S = parseFloat(spotPrice);\n      const r = parseFloat(riskFreeRate) / 100;\n      const q = parseFloat(dividend) / 100;\n\n      // Check if we have enough expirations\n      if (availableExpirations.length < 2) {\n        setLoadError(`Not enough expirations found for ${symbol}. Found ${availableExpirations.length} expirations, need at least 2. This ticker may not have active options trading. Try a major stock like AAPL, TSLA, or SPY.`);\n        setScanningForSpreads(false);\n        return;\n      }\n\n      // Fetch IV data for up to first 20 expirations (to avoid too many API calls)\n      const expsToScan = availableExpirations.slice(0, 20); // Back to original: scan all available expirations\n      \n      console.log('=== SCAN START ===');\n      console.log('Ticker:', symbol);\n      console.log('Spot Price:', S);\n      console.log('Available expirations:', availableExpirations.length);\n      console.log('Will scan first:', expsToScan.length);\n      console.log('Expirations to scan:', expsToScan);\n\n      // Fetch IV for all expirations in parallel (both calls and puts)\n      const ivPromises = expsToScan.map(async (expDate, index) => {\n        const maxRetries = 2; // Back to original: more reliable API calls\n        let retryCount = 0;\n        \n        while (retryCount <= maxRetries) {\n          try {\n            console.log(`[${index + 1}/${expsToScan.length}] Fetching IV for ${expDate}${retryCount > 0 ? ` (retry ${retryCount})` : ''}...`);\n            \n            // Add timeout for API calls\n            const timeoutPromise = new Promise((_, reject) => \n              setTimeout(() => reject(new Error('API timeout')), 15000) // Back to original: longer timeout for reliability\n            );\n            \n            // Fetch both calls and puts with timeout\n            const [callsResponse, putsResponse] = await Promise.race([\n              Promise.all([\n                fetch(`https://api.polygon.io/v3/snapshot/options/${symbol}?expiration_date.gte=${expDate}&expiration_date.lte=${expDate}&contract_type=call&limit=250&apiKey=${apiKey}`),\n                fetch(`https://api.polygon.io/v3/snapshot/options/${symbol}?expiration_date.gte=${expDate}&expiration_date.lte=${expDate}&contract_type=put&limit=250&apiKey=${apiKey}`)\n              ]),\n              timeoutPromise\n            ]);\n\n          console.log(`  → Calls response status: ${callsResponse.status}`);\n          console.log(`  → Puts response status: ${putsResponse.status}`);\n\n          if (callsResponse.ok && putsResponse.ok) {\n            const [callsData, putsData] = await Promise.all([\n              callsResponse.json(),\n              putsResponse.json()\n            ]);\n            console.log(`  → Calls API Status: ${callsData.status}, Results: ${callsData.results?.length || 0}`);\n            console.log(`  → Puts API Status: ${putsData.status}, Results: ${putsData.results?.length || 0}`);\n            \n            if (callsData.status === 'OK' && callsData.results && callsData.results.length > 0) {\n              // Find strike closest to 0.5 delta, fallback to ATM\n              // For stocks under $10, use $1 increments, otherwise $5 increments\n              const atmStrike = S < 10 ? Math.round(S) : Math.round(S / 5) * 5;\n              console.log(`  → Current price: $${S}, ATM strike: $${atmStrike}`);\n              const calls = callsData.results.filter(opt => \n                opt.details?.strike_price && \n                opt.details?.contract_type === 'call' &&\n                opt.implied_volatility > 0\n              );\n              \n              const puts = putsData.results?.filter(opt => \n                opt.details?.strike_price && \n                opt.details?.contract_type === 'put' &&\n                opt.implied_volatility > 0\n              ) || [];\n              \n              if (calls.length > 0) {\n                // Find strike with delta closest to 0.5 (for calls)\n                const callsWithDelta = calls.filter(opt => opt.greeks?.delta !== undefined);\n                \n                if (callsWithDelta.length > 0) {\n                  // Sort by delta closest to 0.5\n                  const sortedCalls = callsWithDelta.sort((a, b) => {\n                    const deltaA = Math.abs(a.greeks.delta - 0.5);\n                    const deltaB = Math.abs(b.greeks.delta - 0.5);\n                    return deltaA - deltaB;\n                  });\n\n                  const selectedCall = sortedCalls[0];\n                  if (selectedCall && selectedCall.implied_volatility > 0) {\n                    console.log(`  ✓ Found call at strike ${selectedCall.details.strike_price}, IV: ${(selectedCall.implied_volatility * 100).toFixed(2)}%, Delta: ${(selectedCall.greeks.delta * 100).toFixed(1)}% (closest to 0.5 delta)`);\n                    // Find corresponding put option\n                    const correspondingPut = puts.find(put => \n                      put.details?.strike_price === selectedCall.details.strike_price\n                    );\n                    \n                    return { \n                      date: expDate, \n                      iv: selectedCall.implied_volatility,\n                      strike: selectedCall.details.strike_price,\n                      delta: selectedCall.greeks.delta,\n                      callOpenInterest: selectedCall.open_interest || 0,\n                      callVolume: selectedCall.volume || 0,\n                      putOpenInterest: correspondingPut?.open_interest || 0,\n                      putVolume: correspondingPut?.volume || 0,\n                      putIv: correspondingPut?.implied_volatility || 0\n                    };\n                  }\n                } else {\n                  // Fallback: closest to ATM if no delta data\n                  console.log(`  → No delta data available, using ATM fallback`);\n                  const sortedCalls = calls\n                    .sort((a, b) => {\n                      const distA = Math.abs(a.details.strike_price - atmStrike);\n                      const distB = Math.abs(b.details.strike_price - atmStrike);\n                      return distA - distB;\n                    });\n\n                  const selectedCall = sortedCalls[0];\n                  if (selectedCall && selectedCall.implied_volatility > 0) {\n                    console.log(`  ✓ Found call at strike ${selectedCall.details.strike_price}, IV: ${(selectedCall.implied_volatility * 100).toFixed(2)}% (ATM fallback)`);\n                    // Find corresponding put option\n                    const correspondingPut = puts.find(put => \n                      put.details?.strike_price === selectedCall.details.strike_price\n                    );\n                    \n                    return { \n                      date: expDate, \n                      iv: selectedCall.implied_volatility,\n                      strike: selectedCall.details.strike_price,\n                      delta: null,\n                      callOpenInterest: selectedCall.open_interest || 0,\n                      callVolume: selectedCall.volume || 0,\n                      putOpenInterest: correspondingPut?.open_interest || 0,\n                      putVolume: correspondingPut?.volume || 0,\n                      putIv: correspondingPut?.implied_volatility || 0\n                    };\n                  }\n                }\n              }\n              \n              console.log(`  ✗ No suitable call found for ${expDate} (${calls.length} calls available)`);\n            } else {\n              console.log(`  ✗ No valid results in response`);\n            }\n          } else {\n            console.warn(`  ✗ HTTP Error: Calls ${callsResponse.status}, Puts ${putsResponse.status}`);\n            if (!callsResponse.ok) {\n              const errorText = await callsResponse.text();\n              console.warn(`  ✗ Calls error: ${errorText.substring(0, 200)}...`);\n            }\n            if (!putsResponse.ok) {\n              const errorText = await putsResponse.text();\n              console.warn(`  ✗ Puts error: ${errorText.substring(0, 200)}...`);\n            }\n          }\n        } catch (error) {\n            retryCount++;\n            if (retryCount <= maxRetries) {\n              console.warn(`  ⚠️ Attempt ${retryCount} failed for ${expDate}: ${error.message}. Retrying...`);\n              await new Promise(resolve => setTimeout(resolve, 1000 * retryCount)); // Exponential backoff\n              continue;\n            } else {\n              if (error.message === 'API timeout') {\n                console.warn(`  ⏰ Timeout for ${expDate} after ${maxRetries} retries - skipping`);\n              } else {\n                console.error(`  ✗ Exception for ${expDate} after ${maxRetries} retries:`, error.message);\n              }\n              break;\n            }\n          }\n        }\n        return null;\n      });\n\n      const ivResults = (await Promise.all(ivPromises)).filter(r => r !== null);\n\n      console.log('=== IV FETCH COMPLETE ===');\n      console.log(`Successfully fetched IV for ${ivResults.length}/${expsToScan.length} expirations`);\n      console.log('IV Results:', ivResults);\n\n      if (ivResults.length < 2) {\n        console.warn('❌ NOT ENOUGH IV DATA');\n        console.warn(`Only ${ivResults.length} expirations had valid IV data`);\n        console.warn('Expirations scanned:', expsToScan);\n        console.warn('IV Results:', ivResults);\n        \n        if (ivResults.length === 0) {\n          setLoadError(`No options data found for ${symbol}. This ticker may not have active options trading. Try a major stock like AAPL, TSLA, or SPY.`);\n        } else {\n          setLoadError(`Scanner found IV data for only ${ivResults.length}/${expsToScan.length} expirations. This ticker may have limited options data. Try a major stock like AAPL, TSLA, or SPY.`);\n        }\n        setScanningForSpreads(false);\n        return;\n      }\n\n      // Calculate FF for all combinations\n      const spreads = [];\n      const now = new Date();\n\n      for (let i = 0; i < ivResults.length - 1; i++) {\n        for (let j = i + 1; j < ivResults.length; j++) {\n          const exp1 = ivResults[i];\n          const exp2 = ivResults[j];\n\n          const d1 = new Date(exp1.date + 'T16:00:00-04:00');\n          const d2 = new Date(exp2.date + 'T16:00:00-04:00');\n\n          const daysToExp1 = (d1 - now) / (1000 * 60 * 60 * 24);\n          const daysToExp2 = (d2 - now) / (1000 * 60 * 60 * 24);\n\n          if (daysToExp1 <= 0 || daysToExp2 <= 0) continue;\n\n          const T1 = daysToExp1 / 365;\n          const T2 = daysToExp2 / 365;\n\n          const v1 = exp1.iv;\n          const v2 = exp2.iv;\n\n          const numerator = (T2 * v2 * v2) - (T1 * v1 * v1);\n          const denominator = T2 - T1;\n\n          if (numerator > 0 && denominator > 0) {\n            const forwardVol = Math.sqrt(numerator / denominator);\n            const ff = ((v1 / forwardVol) - 1) * 100;\n\n            // Use the strike from the selected option (prefer delta-based selection)\n            const strike1 = exp1.strike || Math.round(S / 5) * 5;\n            const strike2 = exp2.strike || Math.round(S / 5) * 5;\n            \n            // Calculate call spread price using the selected strikes\n            const callT1 = getOptionPrice(S, strike1, T1, r, v1, q, true);\n            const callT2 = getOptionPrice(S, strike2, T2, r, v2, q, true);\n            const callSpread = callT2 - callT1;\n\n            // Calculate put spread price using the selected strikes\n            const putT1 = getOptionPrice(S, strike1, T1, r, v1, q, false);\n            const putT2 = getOptionPrice(S, strike2, T2, r, v2, q, false);\n            const putSpread = putT2 - putT1;\n\n            // Check if front expiration is after earnings\n            let isPostEarnings = false;\n            if (nextEarningsDate) {\n              const earningsDate = new Date(nextEarningsDate);\n              const frontExpDate = new Date(exp1.date);\n              // Post-earnings if front exp is after earnings\n              isPostEarnings = frontExpDate > earningsDate;\n            }\n\n            spreads.push({\n              date1: exp1.date,\n              date2: exp2.date,\n              dte1: Math.floor(daysToExp1),\n              dte2: Math.floor(daysToExp2),\n              ff: ff,\n              iv1: (v1 * 100).toFixed(2),\n              iv2: (v2 * 100).toFixed(2),\n              callSpread: callSpread.toFixed(2),\n              putSpread: putSpread.toFixed(2),\n              strike: strike1, // Use the selected strike from delta-based selection\n              isPostEarnings: isPostEarnings,\n              // Liquidity data from exp1 (front expiration)\n              callOpenInterest1: exp1.callOpenInterest || 0,\n              callVolume1: exp1.callVolume || 0,\n              putOpenInterest1: exp1.putOpenInterest || 0,\n              putVolume1: exp1.putVolume || 0,\n              // Liquidity data from exp2 (back expiration)\n              callOpenInterest2: exp2.callOpenInterest || 0,\n              callVolume2: exp2.callVolume || 0,\n              putOpenInterest2: exp2.putOpenInterest || 0,\n              putVolume2: exp2.putVolume || 0\n            });\n          } else {\n            // Invalid IV combination - Forward Vol would be imaginary\n            const strike1 = exp1.strike || Math.round(S / 5) * 5;\n            const strike2 = exp2.strike || Math.round(S / 5) * 5;\n            \n            // Calculate call spread price using the selected strikes\n            const callT1 = getOptionPrice(S, strike1, T1, r, v1, q, true);\n            const callT2 = getOptionPrice(S, strike2, T2, r, v2, q, true);\n            const callSpread = callT2 - callT1;\n\n            // Calculate put spread price using the selected strikes\n            const putT1 = getOptionPrice(S, strike1, T1, r, v1, q, false);\n            const putT2 = getOptionPrice(S, strike2, T2, r, v2, q, false);\n            const putSpread = putT2 - putT1;\n\n            // Check if front expiration is after earnings\n            let isPostEarnings = false;\n            if (nextEarningsDate) {\n              const earningsDate = new Date(nextEarningsDate);\n              const frontExpDate = new Date(exp1.date);\n              // Post-earnings if front exp is after earnings\n              isPostEarnings = frontExpDate > earningsDate;\n            }\n\n            spreads.push({\n              date1: exp1.date,\n              date2: exp2.date,\n              dte1: Math.floor(daysToExp1),\n              dte2: Math.floor(daysToExp2),\n              ff: '∞', // Infinity symbol for invalid IV combination\n              iv1: (v1 * 100).toFixed(2),\n              iv2: (v2 * 100).toFixed(2),\n              callSpread: callSpread.toFixed(2),\n              putSpread: putSpread.toFixed(2),\n              strike: strike1,\n              isPostEarnings: isPostEarnings,\n              // Liquidity data from exp1 (front expiration)\n              callOpenInterest1: exp1.callOpenInterest || 0,\n              callVolume1: exp1.callVolume || 0,\n              putOpenInterest1: exp1.putOpenInterest || 0,\n              putVolume1: exp1.putVolume || 0,\n              // Liquidity data from exp2 (back expiration)\n              callOpenInterest2: exp2.callOpenInterest || 0,\n              callVolume2: exp2.callVolume || 0,\n              putOpenInterest2: exp2.putOpenInterest || 0,\n              putVolume2: exp2.putVolume || 0\n            });\n          }\n        }\n      }\n\n      console.log('=== CALCULATING SPREADS ===');\n      console.log(`Calculating spreads from ${ivResults.length} expirations...`);\n      console.log(`Generated ${spreads.length} total spreads`);\n\n      // Filter out post-earnings spreads if requested\n      let filteredSpreads = spreads;\n      if (hidePostEarningsSpreads) {\n        filteredSpreads = spreads.filter(s => !s.isPostEarnings);\n        console.log(`Filtered to ${filteredSpreads.length} spreads (removed post-earnings)`);\n      }\n\n      // Always filter out options with zero open interest\n      filteredSpreads = filteredSpreads.filter(s => {\n        const callHasOI = (s.callOpenInterest1 > 0 && s.callOpenInterest2 > 0);\n        const putHasOI = (s.putOpenInterest1 > 0 && s.putOpenInterest2 > 0);\n        \n        // At least one option type (call or put) must have open interest\n        return callHasOI || putHasOI;\n      });\n      console.log(`Filtered to ${filteredSpreads.length} spreads (removed zero OI options)`);\n\n      // Apply additional liquidity filters\n      if (minOpenInterest > 0 || minVolume > 0) {\n        filteredSpreads = filteredSpreads.filter(s => {\n          const callOIMeets = (s.callOpenInterest1 >= minOpenInterest && s.callOpenInterest2 >= minOpenInterest);\n          const putOIMeets = (s.putOpenInterest1 >= minOpenInterest && s.putOpenInterest2 >= minOpenInterest);\n          const callVolMeets = (s.callVolume1 >= minVolume && s.callVolume2 >= minVolume);\n          const putVolMeets = (s.putVolume1 >= minVolume && s.putVolume2 >= minVolume);\n          \n          // At least one option type (call or put) must meet the criteria\n          return (callOIMeets && callVolMeets) || (putOIMeets && putVolMeets);\n        });\n        console.log(`Filtered to ${filteredSpreads.length} spreads (applied additional liquidity filters)`);\n      }\n\n      // Apply DTE gap filter\n      if (maxDTEGap > 0) {\n        filteredSpreads = filteredSpreads.filter(s => {\n          const dteGap = s.dte2 - s.dte1;\n          return dteGap <= maxDTEGap;\n        });\n        console.log(`Filtered to ${filteredSpreads.length} spreads (applied DTE gap filter: max ${maxDTEGap} days)`);\n      }\n\n      // Sort by FF descending and take top 10\n      filteredSpreads.sort((a, b) => b.ff - a.ff);\n      const topSpreads = filteredSpreads.slice(0, 10);\n\n      console.log('=== SCAN COMPLETE ===');\n      console.log(`Found ${filteredSpreads.length} valid spreads, showing top ${Math.min(10, topSpreads.length)}`);\n      console.log('Top 10 spreads:', topSpreads);\n      console.log('Setting recommended spreads...', topSpreads.length, 'spreads');\n      setRecommendedSpreads(topSpreads);\n      console.log('Recommended spreads set successfully');\n\n      // Add to watchlist with best FF\n      if (topSpreads.length > 0) {\n        const bestSpread = topSpreads[0];\n        addToWatchlist(\n          symbol,\n          bestSpread.ff.toFixed(2),\n          nextEarningsDate !== null,\n          nextEarningsDate,\n          S.toFixed(2)\n        );\n      }\n\n    } catch (error) {\n      console.error('=== SCAN ERROR ===');\n      console.error('Error scanning calendar spreads:', error);\n      console.error('Error stack:', error.stack);\n      setLoadError(`Scan failed: ${error.message}`);\n    }\n\n    setScanningForSpreads(false);\n  };\n\n  // Calculate DTE (Days to Expiration) for a given date\n  const calculateDTE = (expirationDate) => {\n    const expDate = new Date(expirationDate + 'T16:00:00-04:00'); // 4 PM EST\n    const now = new Date();\n    const diffMs = expDate - now;\n    const diffDays = diffMs / (1000 * 60 * 60 * 24);\n    return Math.max(0, Math.floor(diffDays));\n  };\n\n  // Function to update IV based on selected expiration date\n  const updateIVForDate = async (expirationDate, isFirstDate) => {\n    if (!ticker || !apiKey || !expirationDate) return;\n\n    try {\n      const symbol = ticker.toUpperCase().trim();\n      const roundedStrike = Math.round(parseFloat(spotPrice) / 5) * 5;\n\n      const chainUrl = `https://api.polygon.io/v3/snapshot/options/${symbol}?expiration_date.gte=${expirationDate}&expiration_date.lte=${expirationDate}&contract_type=call&limit=250&apiKey=${apiKey}`;\n      console.log(`Fetching IV for ${expirationDate}...`);\n\n      const chainResponse = await fetch(chainUrl);\n\n      if (chainResponse.ok) {\n        const chainData = await chainResponse.json();\n\n        if (chainData.status === 'OK' && chainData.results && chainData.results.length > 0) {\n          // Find ATM call option - closest to rounded strike\n          const atmCall = chainData.results\n            .filter(opt => opt.details?.strike_price && Math.abs(opt.details.strike_price - roundedStrike) < 20)\n            .sort((a, b) => Math.abs(a.details.strike_price - roundedStrike) - Math.abs(b.details.strike_price - roundedStrike))[0];\n\n          if (atmCall) {\n            if (atmCall.implied_volatility !== undefined && atmCall.implied_volatility > 0) {\n              const ivValue = (atmCall.implied_volatility * 100).toFixed(2);\n              if (isFirstDate) {\n                setIv1(ivValue);\n              } else {\n                setIv2(ivValue);\n              }\n            }\n            if (atmCall.day?.volume !== undefined) {\n              if (isFirstDate) {\n                setVolumeCallT1(atmCall.day.volume);\n              } else {\n                setVolumeCallT2(atmCall.day.volume);\n              }\n            }\n            if (atmCall.open_interest !== undefined) {\n              if (isFirstDate) {\n                setOiCallT1(atmCall.open_interest);\n              } else {\n                setOiCallT2(atmCall.open_interest);\n              }\n            }\n          }\n        }\n      }\n    } catch (error) {\n      console.error('Error updating IV:', error);\n    }\n  };\n\n\n  const normDist = (x) => {\n    const a1 = 0.254829592;\n    const a2 = -0.284496736;\n    const a3 = 1.421413741;\n    const a4 = -1.453152027;\n    const a5 = 1.061405429;\n    const p = 0.3275911;\n\n    const sign = x < 0 ? -1 : 1;\n    x = Math.abs(x) / Math.sqrt(2);\n\n    const t = 1.0 / (1.0 + p * x);\n    const y = 1.0 - (((((a5 * t + a4) * t + a3) * t + a2) * t + a1) * t * Math.exp(-x * x));\n\n    return 0.5 * (1.0 + sign * y);\n  };\n\n  const blackScholesCall = (S, K, T, r, sigma, q = 0) => {\n    if (T <= 0 || sigma <= 0) return Math.max(S - K, 0);\n    \n    const sqrtT = Math.sqrt(T);\n    const d1 = (Math.log(S / K) + (r - q + 0.5 * sigma * sigma) * T) / (sigma * sqrtT);\n    const d2 = d1 - sigma * sqrtT;\n    \n    const callPrice = S * Math.exp(-q * T) * normDist(d1) - K * Math.exp(-r * T) * normDist(d2);\n    return Math.max(callPrice, 0);\n  };\n\n  const blackScholesPut = (S, K, T, r, sigma, q = 0) => {\n    if (T <= 0 || sigma <= 0) return Math.max(K - S, 0);\n    \n    const sqrtT = Math.sqrt(T);\n    const d1 = (Math.log(S / K) + (r - q + 0.5 * sigma * sigma) * T) / (sigma * sqrtT);\n    const d2 = d1 - sigma * sqrtT;\n    \n    const putPrice = K * Math.exp(-r * T) * normDist(-d2) - S * Math.exp(-q * T) * normDist(-d1);\n    return Math.max(putPrice, 0);\n  };\n\n  const black76Call = (F, K, T, r, sigma) => {\n    if (T <= 0 || sigma <= 0) return Math.max(F - K, 0);\n    \n    const sqrtT = Math.sqrt(T);\n    const d1 = (Math.log(F / K) + (0.5 * sigma * sigma) * T) / (sigma * sqrtT);\n    const d2 = d1 - sigma * sqrtT;\n    \n    const callPrice = Math.exp(-r * T) * (F * normDist(d1) - K * normDist(d2));\n    return Math.max(callPrice, 0);\n  };\n\n  const black76Put = (F, K, T, r, sigma) => {\n    if (T <= 0 || sigma <= 0) return Math.max(K - F, 0);\n    \n    const sqrtT = Math.sqrt(T);\n    const d1 = (Math.log(F / K) + (0.5 * sigma * sigma) * T) / (sigma * sqrtT);\n    const d2 = d1 - sigma * sqrtT;\n    \n    const putPrice = Math.exp(-r * T) * (K * normDist(-d2) - F * normDist(-d1));\n    return Math.max(putPrice, 0);\n  };\n\n  const binomialCall = (S, K, T, r, sigma, q = 0, steps = 50) => {\n    const dt = T / steps;\n    const u = Math.exp(sigma * Math.sqrt(dt));\n    const d = 1 / u;\n    const p = (Math.exp((r - q) * dt) - d) / (u - d);\n    \n    // Stock prices at maturity\n    const prices = [];\n    for (let i = 0; i <= steps; i++) {\n      prices[i] = S * Math.pow(u, steps - i) * Math.pow(d, i);\n    }\n    \n    // Option values at maturity\n    const values = prices.map(price => Math.max(price - K, 0));\n    \n    // Backward induction\n    for (let j = steps - 1; j >= 0; j--) {\n      for (let i = 0; i <= j; i++) {\n        values[i] = Math.exp(-r * dt) * (p * values[i] + (1 - p) * values[i + 1]);\n      }\n    }\n    \n    return values[0];\n  };\n\n  const binomialPut = (S, K, T, r, sigma, q = 0, steps = 50) => {\n    const dt = T / steps;\n    const u = Math.exp(sigma * Math.sqrt(dt));\n    const d = 1 / u;\n    const p = (Math.exp((r - q) * dt) - d) / (u - d);\n    \n    // Stock prices at maturity\n    const prices = [];\n    for (let i = 0; i <= steps; i++) {\n      prices[i] = S * Math.pow(u, steps - i) * Math.pow(d, i);\n    }\n    \n    // Option values at maturity\n    const values = prices.map(price => Math.max(K - price, 0));\n    \n    // Backward induction\n    for (let j = steps - 1; j >= 0; j--) {\n      for (let i = 0; i <= j; i++) {\n        values[i] = Math.exp(-r * dt) * (p * values[i] + (1 - p) * values[i + 1]);\n      }\n    }\n    \n    return values[0];\n  };\n\n  const getOptionPrice = (S, K, T, r, sigma, q, isCall) => {\n    switch(pricingModel) {\n      case 'black76':\n        const F = S * Math.exp((r - q) * T);\n        return isCall ? black76Call(F, K, T, r, sigma) : black76Put(F, K, T, r, sigma);\n      case 'binomial':\n        return isCall ? binomialCall(S, K, T, r, sigma, q) : binomialPut(S, K, T, r, sigma, q);\n      case 'blackscholes':\n      default:\n        return isCall ? blackScholesCall(S, K, T, r, sigma, q) : blackScholesPut(S, K, T, r, sigma, q);\n    }\n  };\n\n  const handlePriceSlider = (newPrice, isCallSpread) => {\n    if (!result) return;\n\n    const S = parseFloat(spotPrice);\n    const K = parseFloat(strikePrice);\n    const v1 = parseFloat(iv1) / 100;\n    const r = parseFloat(riskFreeRate) / 100;\n    const q = parseFloat(dividend) / 100;\n    \n    const d1 = new Date(date1);\n    const d2 = new Date(date2);\n    const now = new Date();\n    \n    const d1_16NY = new Date(d1);\n    d1_16NY.setHours(22, 0, 0, 0);\n    \n    const d2_16NY = new Date(d2);\n    d2_16NY.setHours(22, 0, 0, 0);\n\n    const msPerDay = 24 * 60 * 60 * 1000;\n    const daysToExp1 = (d1_16NY - now) / msPerDay;\n    const daysToExp2 = (d2_16NY - now) / msPerDay;\n    \n    const T1 = daysToExp1 / 365;\n    const T2 = daysToExp2 / 365;\n    \n    const frontPrice = isCallSpread \n      ? getOptionPrice(S, K, T1, r, v1, q, true)\n      : getOptionPrice(S, K, T1, r, v1, q, false);\n    \n    // Target Back-Option Preis basierend auf neuer Spread-Preis\n    const targetBackPrice = newPrice + frontPrice;\n    \n    // Binäre Suche nach der IV2, die zu targetBackPrice führt\n    let v2Low = 0.001;\n    let v2High = 3.0;\n    let v2Mid = 1.0;\n    \n    for (let iteration = 0; iteration < 100; iteration++) {\n      v2Mid = (v2Low + v2High) / 2;\n      const backPrice = isCallSpread \n        ? getOptionPrice(S, K, T2, r, v2Mid, q, true)\n        : getOptionPrice(S, K, T2, r, v2Mid, q, false);\n      \n      const diff = backPrice - targetBackPrice;\n      \n      if (Math.abs(diff) < 0.00001) break;\n      \n      if (diff > 0) {\n        v2High = v2Mid;\n      } else {\n        v2Low = v2Mid;\n      }\n    }\n    \n    // Mit dieser gefundenen IV2 berechne den echten FF\n    const numerator = (T2 * v2Mid * v2Mid) - (T1 * v1 * v1);\n    const denominator = T2 - T1;\n    \n    let newFF;\n    if (numerator >= 0 && denominator > 0) {\n      const forwardVol = Math.sqrt(numerator / denominator);\n      newFF = ((v1 / forwardVol) - 1) * 100;\n    } else {\n      newFF = parseFloat(result.forwardFactor);\n    }\n    \n    if (isCallSpread) {\n      setCallPriceSlider(newPrice);\n      setAdjustedFFCall(newFF);\n    } else {\n      setPutPriceSlider(newPrice);\n      setAdjustedFFPut(newFF);\n    }\n  };\n\n  const calculateResults = () => {\n    try {\n      const d1 = new Date(date1);\n      const d2 = new Date(date2);\n      \n      if (d2 <= d1) {\n        setResult({ error: 'Expiration 2 muss nach Expiration 1 liegen' });\n        return;\n      }\n\n      // Berechne verbleibende Zeit mit Berücksichtigung der NY-Schließzeit (16:00 EST = 22:00 Berlin)\n      const now = new Date();\n      const d1_16NY = new Date(d1);\n      d1_16NY.setHours(22, 0, 0, 0); // 16:00 EST = 22:00 Berlin (CET)\n      \n      const d2_16NY = new Date(d2);\n      d2_16NY.setHours(22, 0, 0, 0); // 16:00 EST = 22:00 Berlin (CET)\n\n      // Berechne verbleibende Tage mit Dezimalgenauigkeit (keine Rundung)\n      const msPerDay = 24 * 60 * 60 * 1000;\n      const daysToExp1 = (d1_16NY - now) / msPerDay;\n      const daysToExp2 = (d2_16NY - now) / msPerDay;\n\n      if (daysToExp1 <= 0 || daysToExp2 <= 0) {\n        setResult({ error: 'Ablaufdatum liegt in der Vergangenheit' });\n        return;\n      }\n\n      // Zeitberechnung in Jahren - KEINE Rundung!\n      const T1 = daysToExp1 / 365;\n      const T2 = daysToExp2 / 365;\n\n      const v1 = parseFloat(iv1) / 100;\n      const v2 = parseFloat(iv2) / 100;\n      const S = parseFloat(spotPrice);\n      const K = parseFloat(strikePrice);\n      const r = parseFloat(riskFreeRate) / 100;\n      const q = parseFloat(dividend) / 100;\n\n      if (v1 <= 0 || v2 <= 0 || S <= 0 || K <= 0) {\n        setResult({ error: 'Bitte überprüfe deine Eingaben' });\n        return;\n      }\n\n      const numerator = (T2 * v2 * v2) - (T1 * v1 * v1);\n      const denominator = T2 - T1;\n      \n      if (numerator < 0) {\n        setResult({ error: 'Ungültige IV Kombination - Forward Vol wäre imaginär' });\n        return;\n      }\n      \n      const forwardVol = Math.sqrt(numerator / denominator);\n      const forwardVolPct = forwardVol * 100;\n      const forwardFactor = (v1 / forwardVol) - 1;\n\n      const callT1 = getOptionPrice(S, K, T1, r, v1, q, true);\n      const callT2 = getOptionPrice(S, K, T2, r, v2, q, true);\n      const callCalendarSpread = callT2 - callT1;\n\n      const putT1 = getOptionPrice(S, K, T1, r, v1, q, false);\n      const putT2 = getOptionPrice(S, K, T2, r, v2, q, false);\n      const putCalendarSpread = putT2 - putT1;\n\n      // FF = 30%\n      const targetForwardFactor30 = 0.30;\n      const requiredForwardVol30 = v1 / (1 + targetForwardFactor30);\n      const iv2Squared30 = (requiredForwardVol30 * requiredForwardVol30 * (T2 - T1) + T1 * v1 * v1) / T2;\n      const requiredIV230 = Math.sqrt(Math.max(0, iv2Squared30));\n      \n      const callT2At30 = getOptionPrice(S, K, T2, r, requiredIV230, q, true);\n      const maxCallCalendarPrice30 = callT2At30 - callT1;\n      \n      const putT2At30 = getOptionPrice(S, K, T2, r, requiredIV230, q, false);\n      const maxPutCalendarPrice30 = putT2At30 - putT1;\n\n      // FF = 0%\n      const targetForwardFactor0 = 0;\n      const requiredForwardVol0 = v1 / (1 + targetForwardFactor0);\n      const iv2Squared0 = (requiredForwardVol0 * requiredForwardVol0 * (T2 - T1) + T1 * v1 * v1) / T2;\n      const requiredIV20 = Math.sqrt(Math.max(0, iv2Squared0));\n      \n      const callT2At0 = getOptionPrice(S, K, T2, r, requiredIV20, q, true);\n      const callCalendarSpreadAt0 = callT2At0 - callT1;\n      \n      const putT2At0 = getOptionPrice(S, K, T2, r, requiredIV20, q, false);\n      const putCalendarSpreadAt0 = putT2At0 - putT1;\n\n      const newResult = {\n        forwardVolPct: parseFloat(forwardVolPct).toFixed(2),\n        forwardFactor: (parseFloat(forwardFactor) * 100).toFixed(2),\n        daysToExp1: parseFloat(daysToExp1).toFixed(2),\n        daysToExp2: parseFloat(daysToExp2).toFixed(2),\n        callT1: parseFloat(callT1).toFixed(2),\n        callT2: parseFloat(callT2).toFixed(2),\n        callCalendarSpread: parseFloat(callCalendarSpread).toFixed(2),\n        putT1: parseFloat(putT1).toFixed(2),\n        putT2: parseFloat(putT2).toFixed(2),\n        putCalendarSpread: parseFloat(putCalendarSpread).toFixed(2),\n        maxCallCalendarPrice30: Math.max(0, parseFloat(maxCallCalendarPrice30)).toFixed(2),\n        maxPutCalendarPrice30: Math.max(0, parseFloat(maxPutCalendarPrice30)).toFixed(2),\n        callCalendarSpreadAt0: parseFloat(callCalendarSpreadAt0).toFixed(2),\n        putCalendarSpreadAt0: parseFloat(putCalendarSpreadAt0).toFixed(2),\n        error: null,\n        timestamp: new Date().toLocaleString('de-DE')\n      };\n\n      setResult(newResult);\n      \n      const historyEntry = {\n        ticker: ticker || 'N/A',\n        date: date1,\n        ff: parseFloat(newResult.forwardFactor),\n        callSpreadCurrent: newResult.callCalendarSpread,\n        putSpreadCurrent: newResult.putCalendarSpread,\n        callSpreadFF30: newResult.maxCallCalendarPrice30,\n        putSpreadFF30: newResult.maxPutCalendarPrice30,\n        callSpreadFF0: newResult.callCalendarSpreadAt0,\n        putSpreadFF0: newResult.putCalendarSpreadAt0,\n        timestamp: newResult.timestamp\n      };\n      setTradeHistory([historyEntry, ...tradeHistory.slice(0, 9)]);\n\n    } catch (err) {\n      setResult({ error: 'Fehler bei der Berechnung: ' + err.message });\n    }\n  };\n\n\n  const getFFColor = (ff) => {\n    const ffNum = parseFloat(ff);\n    if (ffNum >= 30) return 'bg-green-100 border-green-500 text-green-900';\n    if (ffNum >= 16) return 'bg-yellow-100 border-yellow-500 text-yellow-900';\n    return darkMode ? 'bg-gray-700 border-gray-600 text-gray-300' : 'bg-gray-50 border-gray-300 text-gray-900';\n  };\n\n\n  const exportCSV = () => {\n    if (!result || result.error) return;\n    \n    const csv = [\n      ['Calendar Spread Trade'],\n      ['Datum', new Date().toLocaleString('de-DE')],\n      [],\n      ['Expiration 1', date1],\n      ['Expiration 2', date2],\n      ['IV Exp 1', iv1 + '%'],\n      ['IV Exp 2', iv2 + '%'],\n      ['Aktienkurs', spotPrice],\n      ['Strike', strikePrice],\n      [],\n      ['Forward Volatility', result.forwardVolPct + '%'],\n      ['Forward Faktor', result.forwardFactor + '%'],\n      ['Call Calendar Spread', result.callCalendarSpread],\n      ['Put Calendar Spread', result.putCalendarSpread],\n      ['Max Call für FF +30%', result.maxCallCalendarPrice30],\n      ['Max Put für FF +30%', result.maxPutCalendarPrice30]\n    ].map(row => row.join(',')).join('\\n');\n\n    const blob = new Blob([csv], { type: 'text/csv' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `calendar-trade-${new Date().toISOString().split('T')[0]}.csv`;\n    a.click();\n  };\n\n  // Auto-calculate when parameters change\n  useEffect(() => {\n    // Only auto-calculate if we have all required values\n    if (date1 && date2 && iv1 && iv2 && spotPrice && strikePrice) {\n      const timeoutId = setTimeout(() => {\n        calculateResults();\n      }, 500); // Debounce for 500ms\n\n      return () => clearTimeout(timeoutId);\n    }\n  }, [date1, date2, iv1, iv2, spotPrice, strikePrice, riskFreeRate, dividend, pricingModel]);\n\n  // Debug: Log when recommended spreads change\n  useEffect(() => {\n    console.log('Recommended spreads updated:', recommendedSpreads.length, 'spreads');\n    if (recommendedSpreads.length > 0) {\n      console.log('First spread:', recommendedSpreads[0]);\n    }\n  }, [recommendedSpreads]);\n\n  // Check if earnings overlaps with strategy dates\n  useEffect(() => {\n    if (!nextEarningsDate || !date1 || !date2) {\n      setEarningsConflict(null);\n      return;\n    }\n\n    const earningsDate = new Date(nextEarningsDate);\n    const strategyStart = new Date(date1);\n    const strategyEnd = new Date(date2);\n\n    // Check if earnings falls within strategy window (inclusive)\n    if (earningsDate >= strategyStart && earningsDate <= strategyEnd) {\n      const daysUntilEarnings = Math.ceil((earningsDate - new Date()) / (1000 * 60 * 60 * 24));\n      setEarningsConflict({\n        date: nextEarningsDate,\n        timing: earningsTime,\n        daysAway: daysUntilEarnings\n      });\n    } else {\n      setEarningsConflict(null);\n    }\n  }, [nextEarningsDate, earningsTime, date1, date2]);\n\n  const bgClass = darkMode ? 'bg-gray-900' : 'bg-gradient-to-br from-blue-50 to-indigo-100';\n  const cardClass = darkMode ? 'bg-gray-800 text-white' : 'bg-white text-gray-900';\n  const borderClass = darkMode ? 'border-gray-700' : 'border-gray-200';\n\n  return (\n    <div className={`min-h-screen ${bgClass} p-6`}>\n      <div className=\"max-w-[1800px] mx-auto\">\n        <div className={`${cardClass} rounded-lg shadow-lg p-8`}>\n          <div className=\"flex justify-between items-center mb-8\">\n            <div>\n              <div className=\"flex items-center gap-3 mb-2\">\n                <h1 className=\"text-4xl font-bold\">Calendar Spread Calculator</h1>\n                <span className={`px-3 py-1 rounded-full text-xs font-semibold ${\n                  darkMode ? 'bg-yellow-900 text-yellow-200' : 'bg-yellow-200 text-yellow-800'\n                }`}>\n                  v1.0 BETA\n                </span>\n              </div>\n              <p className={darkMode ? 'text-gray-400' : 'text-gray-600'}>Forward Volatility, Forward Factor & Calendar Spread Pricing</p>\n            </div>\n            <div className=\"flex gap-3\">\n              <select\n                value={pricingModel}\n                onChange={(e) => setPricingModel(e.target.value)}\n                className={`px-4 py-2 rounded-lg font-semibold ${\n                  darkMode\n                    ? 'bg-gray-700 border border-gray-600 text-white'\n                    : 'bg-white border border-blue-300 text-gray-900'\n                }`}\n              >\n                <option value=\"blackscholes\">Black-Scholes</option>\n                <option value=\"black76\">Black-76</option>\n                <option value=\"binomial\">Binomial</option>\n              </select>\n              <button\n                onClick={() => setDarkMode(!darkMode)}\n                className={`p-2 rounded-lg ${darkMode ? 'bg-gray-700 text-yellow-400' : 'bg-gray-200 text-gray-800'}`}\n              >\n                {darkMode ? <Sun size={24} /> : <Moon size={24} />}\n              </button>\n            </div>\n          </div>\n\n          {/* User Profile Selector */}\n          <div className=\"flex items-center justify-between mb-6\">\n            <div className=\"flex items-center gap-3\">\n              <span className=\"text-sm opacity-75\">User:</span>\n              <div className=\"flex gap-2\">\n                {['Nils', 'Mr. FF'].map((user) => (\n                  <button\n                    key={user}\n                    onClick={() => {\n                      setCurrentUser(user);\n                      localStorage.setItem('currentUser', user);\n                    }}\n                    className={`px-4 py-2 rounded-lg font-semibold transition-all ${\n                      currentUser === user\n                        ? darkMode\n                          ? 'bg-blue-600 text-white'\n                          : 'bg-blue-500 text-white'\n                        : darkMode\n                          ? 'bg-gray-700 hover:bg-gray-600 text-gray-300'\n                          : 'bg-gray-200 hover:bg-gray-300 text-gray-700'\n                    }`}\n                  >\n                    {user}\n                  </button>\n                ))}\n              </div>\n            </div>\n            <div className=\"text-sm opacity-50\">\n              Welcome, {currentUser}!\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-1 lg:grid-cols-7 gap-6\">\n            <div className=\"lg:col-span-1 space-y-4\">\n              <h2 className=\"text-lg font-bold mb-4\">Parameters</h2>\n\n              <div>\n                <label className=\"block text-sm font-semibold mb-2\">Polygon.io API Key</label>\n                <input\n                  type=\"password\"\n                  value={apiKey}\n                  onChange={(e) => setApiKey(e.target.value)}\n                  className={`w-full px-4 py-2 border-2 rounded-lg focus:outline-none ${\n                    darkMode\n                      ? 'bg-gray-700 border-gray-600 focus:border-blue-400'\n                      : 'bg-white border-blue-300 focus:border-blue-500'\n                  }`}\n                  placeholder=\"Paste your Polygon.io API key\"\n                />\n                <a\n                  href=\"https://polygon.io/dashboard/signup\"\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  className=\"text-xs text-blue-500 hover:underline mt-1 block\"\n                >\n                  Get free API key → (End-of-Day data)\n                </a>\n              </div>\n\n\n              <div className=\"relative\">\n                <label className=\"block text-sm font-semibold mb-2\">Ticker Symbol</label>\n                <div className=\"flex gap-2\">\n                  <div className=\"flex-1 relative\">\n                    <input\n                      type=\"text\"\n                      value={ticker}\n                      onChange={(e) => handleTickerChange(e.target.value)}\n                      onFocus={() => {\n                        if (ticker.length > 0) {\n                          handleTickerChange(ticker);\n                        }\n                      }}\n                      onBlur={() => {\n                        // Delay to allow click on dropdown\n                        setTimeout(() => setShowTickerDropdown(false), 200);\n                      }}\n                      onKeyDown={(e) => {\n                        if (e.key === 'Enter') {\n                          setShowTickerDropdown(false);\n                          fetchOptionData(ticker);\n                        } else if (e.key === 'Escape') {\n                          setShowTickerDropdown(false);\n                        } else if (e.key === 'ArrowDown') {\n                          if (ticker.length > 0) {\n                            handleTickerChange(ticker);\n                          }\n                        }\n                      }}\n                      className={`w-full px-4 py-2 border-2 rounded-lg focus:outline-none ${\n                        darkMode\n                          ? 'bg-gray-700 border-gray-600 focus:border-blue-400'\n                          : 'bg-white border-blue-300 focus:border-blue-500'\n                      }`}\n                      placeholder=\"e.g. AAPL, SPY, TSLA...\"\n                      disabled={loading}\n                    />\n                    {showTickerDropdown && filteredTickers.length > 0 && (\n                      <div className={`absolute z-50 w-full mt-1 max-h-64 overflow-y-auto rounded-lg shadow-lg border-2 ${\n                        darkMode\n                          ? 'bg-gray-800 border-gray-600'\n                          : 'bg-white border-gray-300'\n                      }`}>\n                        {filteredTickers.map((stock) => (\n                          <button\n                            key={stock.symbol}\n                            onClick={() => selectTicker(stock.symbol)}\n                            className={`w-full text-left px-4 py-2 hover:bg-opacity-80 transition-colors ${\n                              darkMode\n                                ? 'hover:bg-gray-700 text-white'\n                                : 'hover:bg-gray-100 text-gray-900'\n                            }`}\n                          >\n                            <div className=\"font-bold\">{stock.symbol}</div>\n                            <div className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>\n                              {stock.name}\n                            </div>\n                          </button>\n                        ))}\n                      </div>\n                    )}\n                  </div>\n                  <button\n                    onClick={() => fetchOptionData(ticker)}\n                    disabled={loading}\n                    className={`px-4 py-2 rounded-lg font-semibold transition-all ${\n                      loading\n                        ? 'bg-gray-400 cursor-not-allowed'\n                        : darkMode\n                        ? 'bg-slate-600 hover:bg-slate-700 text-white'\n                        : 'bg-slate-500 hover:bg-slate-600 text-white'\n                    }`}\n                  >\n                    {loading ? '...' : 'Load'}\n                  </button>\n                </div>\n                {loadError && (\n                  <p className=\"text-red-500 text-xs mt-1\">{loadError}</p>\n                )}\n                {loading && (\n                  <p className={`text-xs mt-1 ${darkMode ? 'text-blue-400' : 'text-blue-600'}`}>\n                    Loading stock data...\n                  </p>\n                )}\n                \n                {/* Recent Tickers */}\n                {recentTickers.length > 0 && (\n                  <div className=\"mt-2\">\n                    <p className=\"text-xs opacity-75 mb-1\">Recent:</p>\n                    <div className=\"flex flex-wrap gap-1\">\n                      {recentTickers.map((recentTicker) => (\n                        <button\n                          key={recentTicker}\n                          onClick={() => {\n                            setTicker(recentTicker);\n                            fetchOptionData(recentTicker);\n                          }}\n                          className={`px-2 py-1 text-xs rounded font-medium transition-colors ${\n                            darkMode\n                              ? 'bg-gray-700 hover:bg-gray-600 text-gray-200'\n                              : 'bg-gray-200 hover:bg-gray-300 text-gray-700'\n                          }`}\n                        >\n                          {recentTicker}\n                        </button>\n                      ))}\n                    </div>\n                  </div>\n                )}\n\n                <button\n                  onClick={loadDemoData}\n                  className={`w-full mt-2 px-4 py-2 rounded-lg font-semibold text-xs ${\n                    darkMode\n                      ? 'bg-green-700 hover:bg-green-800 text-white'\n                      : 'bg-green-500 hover:bg-green-600 text-white'\n                  }`}\n                >\n                  Load Demo Data (SPY)\n                </button>\n\n                {/* Market Info Display */}\n                {(marketCap !== null || avgOptionsVolume !== null || nextEarningsDate !== null) && (\n                  <div className={`mt-3 p-3 rounded-lg border-2 ${\n                    darkMode\n                      ? 'bg-gray-700 border-gray-600'\n                      : 'bg-blue-50 border-blue-200'\n                  }`}>\n                    <p className=\"text-xs font-semibold mb-2\">Market Info</p>\n                    <div className=\"grid grid-cols-2 gap-2 text-xs\">\n                      {marketCap !== null && (\n                        <div>\n                          <p className=\"opacity-75\">Market Cap</p>\n                          <p className=\"font-bold\">\n                            ${(marketCap / 1e9).toFixed(2)}B\n                          </p>\n                        </div>\n                      )}\n                      {avgOptionsVolume !== null && (\n                        <div>\n                          <p className=\"opacity-75\">Total Opt Vol (20d)</p>\n                          <p className=\"font-bold\">\n                            {avgOptionsVolume.toLocaleString()}\n                          </p>\n                        </div>\n                      )}\n                    </div>\n                    {nextEarningsDate !== null && (\n                      <div className={`mt-2 p-2 rounded border ${\n                        darkMode\n                          ? 'bg-yellow-900 border-yellow-600'\n                          : 'bg-yellow-100 border-yellow-400'\n                      }`}>\n                        <p className=\"text-xs font-semibold mb-1\">📊 Next Earnings</p>\n                        <p className=\"font-bold\">\n                          {new Date(nextEarningsDate).toLocaleDateString('en-US', { \n                            weekday: 'short', \n                            year: 'numeric', \n                            month: 'short', \n                            day: 'numeric' \n                          })}\n                        </p>\n                        {earningsTime && (\n                          <p className=\"text-xs opacity-75 mt-1\">\n                            {earningsTime}\n                          </p>\n                        )}\n                        {(() => {\n                          const daysAway = Math.floor((new Date(nextEarningsDate) - new Date()) / (1000 * 60 * 60 * 24));\n                          return (\n                            <p className=\"text-xs opacity-75 mt-1\">\n                              {daysAway > 0 \n                                ? `${daysAway} days away` \n                                : daysAway === 0 \n                                  ? 'Today!' \n                                  : `${Math.abs(daysAway)} days ago`}\n                            </p>\n                          );\n                        })()}\n                      </div>\n                    )}\n                  </div>\n                )}\n\n                {/* Earnings Overlap Warning */}\n                {earningsConflict && (\n                  <div className={`mt-3 p-3 rounded-lg border-2 ${\n                    darkMode\n                      ? 'bg-red-900 border-red-600'\n                      : 'bg-red-50 border-red-400'\n                  }`}>\n                    <p className=\"text-xs font-semibold mb-1\">⚠️ Earnings During Strategy</p>\n                    <p className=\"text-xs\">\n                      Earnings on <span className=\"font-bold\">{new Date(earningsConflict.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}</span> falls within your selected dates.\n                    </p>\n                    {earningsConflict.timing && (\n                      <p className=\"text-xs opacity-75 mt-1\">\n                        {earningsConflict.timing}\n                      </p>\n                    )}\n                    <p className=\"text-xs opacity-75 mt-1\">\n                      {earningsConflict.daysAway > 0 \n                        ? `${earningsConflict.daysAway} days away` \n                        : earningsConflict.daysAway === 0 \n                          ? 'Today!' \n                          : `${Math.abs(earningsConflict.daysAway)} days ago`}\n                    </p>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"relative\">\n                <label className=\"block text-sm font-semibold mb-2\">Expiration 1</label>\n                <select\n                  value={date1}\n                  onChange={(e) => {\n                    setDate1(e.target.value);\n                    updateIVForDate(e.target.value, true);\n                  }}\n                  className={`w-full px-4 py-2 border-2 rounded-lg ${\n                    darkMode\n                      ? 'bg-gray-700 border-gray-600 text-white'\n                      : 'bg-white border-blue-300 text-gray-900'\n                  }`}\n                >\n                  {availableExpirations.length > 0 ? (\n                    availableExpirations.map(date => {\n                      const dte = calculateDTE(date);\n                      return (\n                        <option key={date} value={date}>\n                          {new Date(date).toLocaleDateString('en-US', { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' })} ({dte} DTE)\n                        </option>\n                      );\n                    })\n                  ) : (\n                    <option value={date1}>{new Date(date1).toLocaleDateString('en-US')}</option>\n                  )}\n                </select>\n              </div>\n\n              <div className=\"relative\">\n                <label className=\"block text-sm font-semibold mb-2\">Expiration 2</label>\n                <select\n                  value={date2}\n                  onChange={(e) => {\n                    setDate2(e.target.value);\n                    updateIVForDate(e.target.value, false);\n                  }}\n                  className={`w-full px-4 py-2 border-2 rounded-lg ${\n                    darkMode\n                      ? 'bg-gray-700 border-gray-600 text-white'\n                      : 'bg-white border-blue-300 text-gray-900'\n                  }`}\n                >\n                  {availableExpirations.length > 0 ? (\n                    availableExpirations.map(date => {\n                      const dte = calculateDTE(date);\n                      return (\n                        <option key={date} value={date}>\n                          {new Date(date).toLocaleDateString('en-US', { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' })} ({dte} DTE)\n                        </option>\n                      );\n                    })\n                  ) : (\n                    <option value={date2}>{new Date(date2).toLocaleDateString('en-US')}</option>\n                  )}\n                </select>\n              </div>\n\n              {[\n                { label: 'IV Exp 1 (%)', value: iv1, setter: setIv1 },\n                { label: 'IV Exp 2 (%)', value: iv2, setter: setIv2 },\n                { label: 'Stock Price', value: spotPrice, setter: setSpotPrice },\n                { label: 'Strike', value: strikePrice, setter: setStrikePrice },\n                { label: 'Risk-Free Rate (%)', value: riskFreeRate, setter: setRiskFreeRate },\n                { label: 'Dividend (%)', value: dividend, setter: setDividend }\n              ].map((field, idx) => (\n                <div key={idx}>\n                  <label className=\"block text-sm font-semibold mb-2\">{field.label}</label>\n                  <input\n                    type=\"number\"\n                    value={field.value}\n                    onChange={(e) => field.setter(e.target.value)}\n                    className={`w-full px-4 py-2 border-2 rounded-lg focus:outline-none ${\n                      darkMode\n                        ? 'bg-gray-700 border-gray-600 focus:border-blue-400'\n                        : 'bg-white border-blue-300 focus:border-blue-500'\n                    }`}\n                    step=\"0.01\"\n                  />\n                </div>\n              ))}\n\n              <button\n                onClick={calculateResults}\n                className=\"w-full bg-gradient-to-r from-blue-500 to-indigo-600 text-white font-bold py-3 rounded-lg hover:shadow-lg transition-all transform hover:scale-105\"\n              >\n                Calculate\n              </button>\n            </div>\n\n            <div className=\"lg:col-span-5 space-y-4\">\n              {result && !result.error && (\n                <div className={`sticky top-0 z-40 px-4 py-2 rounded-lg shadow-md flex items-center justify-between ${\n                  darkMode ? 'bg-gray-800' : 'bg-white'\n                }`}>\n                  <div className=\"flex items-center gap-4\">\n                    {ticker && (\n                      <div className=\"flex items-center gap-2\">\n                        <img\n                          src={`https://img.logokit.com/ticker/${ticker}?token=pk_fr93b6bfb5c425f6e3db62&format=png`}\n                          alt={ticker}\n                          className=\"w-8 h-8 rounded-lg object-contain\"\n                          onError={(e) => {\n                            // Fallback to colored circle with letter if logo fails\n                            e.target.style.display = 'none';\n                            e.target.nextElementSibling.style.display = 'flex';\n                          }}\n                        />\n                        <div className={`w-8 h-8 rounded-full hidden items-center justify-center font-bold text-white ${\n                          ticker[0] <= 'F' ? 'bg-blue-500' :\n                          ticker[0] <= 'L' ? 'bg-purple-500' :\n                          ticker[0] <= 'R' ? 'bg-green-500' :\n                          ticker[0] <= 'W' ? 'bg-orange-500' : 'bg-red-500'\n                        }`}>\n                          {ticker[0]}\n                        </div>\n                        <div className=\"flex flex-col\">\n                          <div className=\"flex items-baseline gap-2\">\n                        <span className=\"font-bold\">{ticker}</span>\n                            {spotPrice && (\n                              <span className={`text-lg font-semibold ${darkMode ? 'text-blue-400' : 'text-blue-600'}`}>\n                                ${parseFloat(spotPrice).toFixed(2)}\n                              </span>\n                            )}\n                          </div>\n                          <span className=\"text-[10px] opacity-50\">Options data 15 min delayed, stock price last close</span>\n                        </div>\n                      </div>\n                    )}\n                    <div>\n                      <span className=\"text-xs opacity-75\">Forward Vol:</span>\n                      <span className=\"ml-2 text-lg font-bold text-green-600\">{result.forwardVolPct}%</span>\n                    </div>\n                    <div className={`px-3 py-1 rounded ${\n                      parseFloat(result.forwardFactor) >= 30\n                        ? 'bg-green-100 text-green-900'\n                        : parseFloat(result.forwardFactor) >= 16\n                        ? 'bg-yellow-100 text-yellow-900'\n                        : darkMode ? 'bg-gray-700 text-gray-300' : 'bg-gray-100 text-gray-900'\n                    }`}>\n                      <span className=\"text-xs opacity-75\">FF:</span>\n                      <span className=\"ml-2 text-xl font-bold\">{result.forwardFactor}%</span>\n                    </div>\n                  </div>\n                  <div className=\"text-xs opacity-75\">\n                    {result.daysToExp1}-{result.daysToExp2} DTE\n                  </div>\n                </div>\n              )}\n\n              {/* Recommended Calendar Spreads */}\n              {(scanningForSpreads || recommendedSpreads.length > 0) && (\n                <div className={`border-2 ${borderClass} p-4 rounded-lg ${\n                  darkMode ? 'bg-slate-800' : 'bg-slate-50'\n                }`}>\n                  <div className=\"flex justify-between items-center mb-3\">\n                    <p className=\"font-semibold text-lg\">\n                      📊 Recommended Calendar Spreads\n                      {ticker && ` for ${ticker}`}\n                    </p>\n                    {scanningForSpreads && (\n                      <span className={`text-xs ${darkMode ? 'text-blue-400' : 'text-blue-600'}`}>\n                        Scanning...\n                      </span>\n                    )}\n                  </div>\n\n                  {/* Filter Toggle */}\n                  <div className=\"flex items-center gap-2 mb-3 pb-3 border-b border-opacity-30\" style={{ borderColor: darkMode ? '#ffffff40' : '#00000020' }}>\n                    <label className=\"flex items-center gap-2 cursor-pointer\">\n                      <input\n                        type=\"checkbox\"\n                        checked={hidePostEarningsSpreads}\n                        onChange={(e) => {\n                          setHidePostEarningsSpreads(e.target.checked);\n                          // Re-trigger scan with new filter\n                          setTimeout(() => scanCalendarSpreads(), 100);\n                        }}\n                        className=\"w-4 h-4 rounded\"\n                      />\n                      <span className=\"text-sm\">\n                        Hide post-earnings front expirations\n                      </span>\n                    </label>\n                    <span className=\"text-xs opacity-50\" title=\"For pure forward volatility plays, avoid spreads where the front leg expires after earnings\">\n                      ℹ️\n                    </span>\n                  </div>\n\n                  {/* Liquidity Filters */}\n                  <div className=\"flex items-center gap-4 mb-3 pb-3 border-b border-opacity-30\" style={{ borderColor: darkMode ? '#ffffff40' : '#00000020' }}>\n                    <div className=\"flex items-center gap-2\">\n                      <label className=\"text-sm\">Min Open Interest:</label>\n                      <input\n                        type=\"number\"\n                        value={minOpenInterest}\n                        onChange={(e) => setMinOpenInterest(parseInt(e.target.value) || 0)}\n                        className={`w-20 px-2 py-1 text-xs rounded border ${\n                          darkMode \n                            ? 'bg-slate-700 border-slate-600 text-white placeholder-slate-400' \n                            : 'bg-white border-gray-300 text-gray-900 placeholder-gray-500'\n                        }`}\n                        placeholder=\"0\"\n                      />\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <label className=\"text-sm\">Min Volume:</label>\n                      <input\n                        type=\"number\"\n                        value={minVolume}\n                        onChange={(e) => setMinVolume(parseInt(e.target.value) || 0)}\n                        className={`w-20 px-2 py-1 text-xs rounded border ${\n                          darkMode \n                            ? 'bg-slate-700 border-slate-600 text-white placeholder-slate-400' \n                            : 'bg-white border-gray-300 text-gray-900 placeholder-gray-500'\n                        }`}\n                        placeholder=\"0\"\n                      />\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <label className=\"text-sm\">Max DTE Gap:</label>\n                      <input\n                        type=\"number\"\n                        value={maxDTEGap}\n                        onChange={(e) => setMaxDTEGap(parseInt(e.target.value) || 0)}\n                        className={`w-20 px-2 py-1 text-xs rounded border ${\n                          darkMode \n                            ? 'bg-slate-700 border-slate-600 text-white placeholder-slate-400' \n                            : 'bg-white border-gray-300 text-gray-900 placeholder-gray-500'\n                        }`}\n                        placeholder=\"200\"\n                      />\n                    </div>\n                    <button\n                      onClick={() => {\n                        // Just re-filter existing data, don't re-scan\n                        setRecommendedSpreads(prevSpreads => {\n                          let filtered = prevSpreads;\n                          \n                          if (hidePostEarningsSpreads) {\n                            filtered = filtered.filter(s => !s.isPostEarnings);\n                          }\n                          \n                          if (minOpenInterest > 0 || minVolume > 0) {\n                            filtered = filtered.filter(s => {\n                              const callOIMeets = (s.callOpenInterest1 >= minOpenInterest && s.callOpenInterest2 >= minOpenInterest);\n                              const putOIMeets = (s.putOpenInterest1 >= minOpenInterest && s.putOpenInterest2 >= minOpenInterest);\n                              const callVolMeets = (s.callVolume1 >= minVolume && s.callVolume2 >= minVolume);\n                              const putVolMeets = (s.putVolume1 >= minVolume && s.putVolume2 >= minVolume);\n                              \n                              return (callOIMeets && callVolMeets) || (putOIMeets && putVolMeets);\n                            });\n                          }\n                          \n                          if (maxDTEGap > 0) {\n                            filtered = filtered.filter(s => {\n                              const dteGap = s.dte2 - s.dte1;\n                              return dteGap <= maxDTEGap;\n                            });\n                          }\n                          \n                          return filtered;\n                        });\n                      }}\n                      className=\"px-3 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors\"\n                    >\n                      Apply Filters\n                    </button>\n                  </div>\n\n                  {scanningForSpreads ? (\n                    <p className=\"text-sm opacity-75\">Analyzing expiration combinations...</p>\n                  ) : recommendedSpreads.length > 0 ? (\n                    <div className=\"space-y-2 max-h-96 overflow-y-auto\">\n                      {recommendedSpreads.map((spread, idx) => (\n                        <button\n                          key={idx}\n                          onClick={() => {\n                            setDate1(spread.date1);\n                            setDate2(spread.date2);\n                            setIv1(spread.iv1);\n                            setIv2(spread.iv2);\n                            setStrikePrice(spread.strike.toString());\n                          }}\n                          className={`w-full text-left p-3 rounded transition-all hover:scale-[1.02] ${\n                            spread.ff === '∞'\n                              ? darkMode ? 'bg-red-900 hover:bg-red-800' : 'bg-red-100 hover:bg-red-200'\n                              : parseFloat(spread.ff) >= 30\n                              ? darkMode ? 'bg-slate-800 hover:bg-slate-700' : 'bg-slate-100 hover:bg-slate-200'\n                              : parseFloat(spread.ff) >= 16\n                              ? darkMode ? 'bg-yellow-900 hover:bg-yellow-800' : 'bg-yellow-100 hover:bg-yellow-200'\n                              : darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-100 hover:bg-gray-200'\n                          }`}\n                        >\n                          <div className=\"flex justify-between items-center\">\n                            <div>\n                              <span className=\"font-bold text-lg\">#{idx + 1}</span>\n                              <span className=\"ml-3 font-semibold\">\n                                {new Date(spread.date1).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })} → {new Date(spread.date2).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                              </span>\n                              <span className=\"ml-2 text-xs opacity-75\">\n                                ({Math.floor(spread.dte1)} → {Math.floor(spread.dte2)} DTE)\n                              </span>\n                              {spread.isPostEarnings && (\n                                <span className=\"ml-2 px-2 py-0.5 text-[10px] font-semibold rounded bg-orange-500 text-white\" title=\"Front expiration is after earnings\">\n                                  POST-📊\n                                </span>\n                              )}\n                            </div>\n                            <div className=\"text-right\">\n                              <div className=\"text-2xl font-bold\">\n                                FF: {spread.ff === '∞' ? '∞' : `${spread.ff.toFixed(2)}%`}\n                              </div>\n                              <div className=\"text-sm font-semibold mb-2\">\n                                <div className=\"flex justify-between\">\n                                  <span>Call: ${spread.callSpread}</span>\n                                  <span>Put: ${spread.putSpread}</span>\n                              </div>\n                              </div>\n                              <div className=\"text-sm font-bold mb-1\">\n                                <div className=\"flex justify-between\">\n                                  <span className=\"text-blue-600\">Call OI: {spread.callOpenInterest1} → {spread.callOpenInterest2}</span>\n                                  <span className=\"text-red-600\">Put OI: {spread.putOpenInterest1} → {spread.putOpenInterest2}</span>\n                                </div>\n                              </div>\n                              <div className=\"text-sm font-bold\">\n                                <div className=\"flex justify-between\">\n                                  <span className=\"text-blue-500\">Call Vol: {spread.callVolume1} → {spread.callVolume2}</span>\n                                  <span className=\"text-red-500\">Put Vol: {spread.putVolume1} → {spread.putVolume2}</span>\n                                </div>\n                              </div>\n                              <button\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  addSpreadToWatchlist(spread);\n                                }}\n                                className=\"mt-2 px-2 py-1 text-[10px] bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors\"\n                                title=\"Add to Watchlist\"\n                              >\n                                + Watch\n                              </button>\n                            </div>\n                          </div>\n                          <div className=\"text-xs mt-2 opacity-75 flex gap-4\">\n                            <span>IV: {spread.iv1}% → {spread.iv2}%</span>\n                            <span>Strike: ${spread.strike}</span>\n                          </div>\n                        </button>\n                      ))}\n                    </div>\n                  ) : (\n                    <p className=\"text-sm opacity-75\">No spreads found</p>\n                  )}\n\n                  <button\n                    onClick={scanCalendarSpreads}\n                    disabled={scanningForSpreads || !ticker || !apiKey}\n                    className={`w-full mt-3 px-4 py-2 rounded-lg font-semibold text-sm transition-all ${\n                      scanningForSpreads || !ticker || !apiKey\n                        ? 'bg-gray-400 cursor-not-allowed'\n                        : darkMode\n                        ? 'bg-slate-600 hover:bg-slate-700 text-white'\n                        : 'bg-slate-500 hover:bg-slate-600 text-white'\n                    }`}\n                  >\n                    {scanningForSpreads ? 'Scanning...' : 'Rescan for Best Spreads'}\n                  </button>\n                </div>\n              )}\n\n              {/* Market-Wide FF Scanner */}\n              <div className={`border-2 ${borderClass} p-4 rounded-lg ${\n                darkMode ? 'bg-indigo-900' : 'bg-indigo-50'\n              }`}>\n                <div className=\"flex justify-between items-center mb-3\">\n                  <p className=\"font-semibold text-lg\">\n                    🔍 Market Scanner: Top FF Opportunities\n                  </p>\n                  <button\n                    onClick={fetchMarketScan}\n                    disabled={loadingMarketScan}\n                    className={`text-xs px-3 py-1 rounded transition-all ${\n                      loadingMarketScan\n                        ? 'bg-gray-400 cursor-not-allowed text-white'\n                        : 'bg-indigo-500 hover:bg-indigo-600 text-white'\n                    }`}\n                  >\n                    {loadingMarketScan ? 'Scanning...' : 'Start Market Scan'}\n                  </button>\n                </div>\n                \n                {lastMarketScan && (\n                  <p className=\"text-xs opacity-75 mb-3\">\n                    Last scan: {new Date(lastMarketScan).toLocaleString()}\n                  </p>\n                )}\n                \n                {loadingMarketScan && (\n                  <div className=\"text-center py-4\">\n                    <p className=\"text-sm opacity-75\">Scanning market for best FF opportunities...</p>\n                    <p className=\"text-xs opacity-50 mt-1\">This may take 2-5 minutes</p>\n                  </div>\n                )}\n                \n                {!loadingMarketScan && marketScanResults.length > 0 && (\n                  <div className=\"space-y-2 max-h-96 overflow-y-auto\">\n                    {marketScanResults.slice(0, 20).map((stock, idx) => (\n                      <button\n                        key={idx}\n                        onClick={() => {\n                          setTicker(stock.symbol);\n                          fetchOptionData(stock.symbol);\n                        }}\n                        className={`w-full text-left p-3 rounded transition-all hover:scale-[1.01] ${\n                          parseFloat(stock.bestFF) >= 30\n                            ? darkMode ? 'bg-slate-800 hover:bg-slate-700' : 'bg-slate-100 hover:bg-slate-200'\n                            : parseFloat(stock.bestFF) >= 20\n                            ? darkMode ? 'bg-yellow-900 hover:bg-yellow-800' : 'bg-yellow-100 hover:bg-yellow-200'\n                            : darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-100 hover:bg-gray-200'\n                        }`}\n                      >\n                        <div className=\"flex justify-between items-center\">\n                          <div>\n                            <span className=\"font-bold\">#{idx + 1} {stock.symbol}</span>\n                            <span className=\"ml-2 text-xs opacity-75\">{stock.name}</span>\n                            {stock.hasEarnings && (\n                              <span className=\"ml-2 px-1.5 py-0.5 text-[10px] font-semibold rounded bg-yellow-500 text-black\" title=\"Has upcoming earnings\">\n                                📊\n                              </span>\n                            )}\n                          </div>\n                          <div className=\"text-right\">\n                            <div className=\"text-xl font-bold\">FF: {stock.bestFF}%</div>\n                            <div className=\"text-xs opacity-75\">${stock.price?.toFixed(2)}</div>\n                          </div>\n                        </div>\n                        <div className=\"text-xs mt-1 opacity-75 flex gap-3\">\n                          <span>MC: ${(stock.marketCap / 1e9).toFixed(1)}B</span>\n                          {stock.spread && (\n                            <span>{stock.spread.exp1} → {stock.spread.exp2}</span>\n                          )}\n                        </div>\n                      </button>\n                    ))}\n                  </div>\n                )}\n                \n                {!loadingMarketScan && marketScanResults.length === 0 && lastMarketScan && (\n                  <p className=\"text-sm opacity-75 text-center py-4\">\n                    No opportunities found. Try running a market scan.\n                  </p>\n                )}\n              </div>\n\n              {result && (\n                <>\n                  {result.error ? (\n                    <div className={`border-2 border-red-500 p-6 rounded-lg ${darkMode ? 'bg-red-900 text-red-100' : 'bg-red-50 text-red-900'}`}>\n                      <p className=\"font-semibold\">{result.error}</p>\n                    </div>\n                  ) : (\n                    <>\n                      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\n                        <div className={`border-2 border-slate-500 p-4 rounded-lg ${darkMode ? 'bg-slate-800 text-slate-100' : 'bg-slate-50 text-slate-900'}`}>\n                          <p className=\"text-xs mb-1 opacity-75\">Forward Volatility</p>\n                          <p className=\"text-3xl font-bold\">{result.forwardVolPct}%</p>\n                          <p className=\"text-xs mt-2 opacity-75\">{result.daysToExp1}-{result.daysToExp2} DTE</p>\n                        </div>\n\n                        <div className={`border-4 p-4 rounded-lg ${getFFColor(result.forwardFactor)}`}>\n                          <p className=\"text-xs mb-1 opacity-75\">Forward Faktor</p>\n                          <p className=\"text-3xl font-bold\">{result.forwardFactor}%</p>\n                          <p className=\"text-xs mt-2 opacity-75\">\n                            {parseFloat(result.forwardFactor) >= 30 ? '✓ Excellent' : parseFloat(result.forwardFactor) >= 16 ? '✓ Good' : 'Below threshold'}\n                          </p>\n                        </div>\n                      </div>\n\n                      {/* Große Box mit Preisen */}\n                      <div className={`border-4 border-red-600 p-6 rounded-lg ${darkMode ? 'bg-red-900 text-red-100' : 'bg-red-50 text-red-900'}`}>\n                        <p className=\"text-lg font-bold mb-4\">TARGET PRICE FOR FF 30%</p>\n                        <div className=\"grid grid-cols-2 gap-6\">\n                          <div className=\"border-2 border-red-400 p-4 rounded\">\n                            <p className=\"text-sm font-semibold mb-2\">CALL SPREAD</p>\n                            <div className=\"text-center\">\n                              <p className=\"text-5xl font-bold text-red-600\">${result.maxCallCalendarPrice30}</p>\n                              <p className=\"text-xs opacity-75 mt-2\">Max Entry Price</p>\n                            </div>\n                          </div>\n\n                          <div className=\"border-2 border-red-400 p-4 rounded\">\n                            <p className=\"text-sm font-semibold mb-2\">PUT SPREAD</p>\n                            <div className=\"text-center\">\n                              <p className=\"text-5xl font-bold text-red-600\">${result.maxPutCalendarPrice30}</p>\n                              <p className=\"text-xs opacity-75 mt-2\">Max Entry Price</p>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n\n                      {/* Große Box mit aktuellen Preisen */}\n                      <div className={`border-4 border-blue-600 p-6 rounded-lg ${darkMode ? 'bg-blue-900 text-blue-100' : 'bg-blue-50 text-blue-900'}`}>\n                        <p className=\"text-lg font-bold mb-4\">CURRENT CALENDAR SPREADS</p>\n                        <div className=\"grid grid-cols-2 gap-6\">\n                          <div className=\"border-2 border-blue-400 p-4 rounded\">\n                            <p className=\"text-sm font-semibold mb-2\">CALL SPREAD</p>\n                            <div className=\"space-y-1\">\n                              <div className=\"flex justify-between\">\n                                <span>Current Price:</span>\n                                <span className=\"font-bold text-2xl text-blue-600\">${result.callCalendarSpread}</span>\n                              </div>\n                              <div className=\"flex justify-between text-xs opacity-75\">\n                                <span>For FF 0%:</span>\n                                <span className=\"font-semibold\">${result.callCalendarSpreadAt0}</span>\n                              </div>\n                            </div>\n                          </div>\n\n                          <div className=\"border-2 border-pink-400 p-4 rounded\">\n                            <p className=\"text-sm font-semibold mb-2\">PUT SPREAD</p>\n                            <div className=\"space-y-1\">\n                              <div className=\"flex justify-between\">\n                                <span>Current Price:</span>\n                                <span className=\"font-bold text-2xl text-pink-600\">${result.putCalendarSpread}</span>\n                              </div>\n                              <div className=\"flex justify-between text-xs opacity-75\">\n                                <span>For FF 0%:</span>\n                                <span className=\"font-semibold\">${result.putCalendarSpreadAt0}</span>\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n\n                      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\n                        <div className={`border-2 border-blue-500 p-4 rounded-lg ${darkMode ? 'bg-blue-900 text-blue-100' : 'bg-blue-50 text-blue-900'}`}>\n                          <p className=\"font-semibold mb-3\">Call Calendar Spread</p>\n                          <div className=\"grid grid-cols-3 gap-2 text-sm mb-3\">\n                            <div>\n                              <p className=\"text-xs opacity-75\">Front (T1)</p>\n                              <p className=\"font-bold\">${result.callT1}</p>\n                              {volumeCallT1 !== null && (\n                                <p className=\"text-xs opacity-60\">Vol: {volumeCallT1.toLocaleString()}</p>\n                              )}\n                              {oiCallT1 !== null && (\n                                <p className=\"text-xs opacity-60\">OI: {oiCallT1.toLocaleString()}</p>\n                              )}\n                            </div>\n                            <div>\n                              <p className=\"text-xs opacity-75\">Back (T2)</p>\n                              <p className=\"font-bold\">${result.callT2}</p>\n                              {volumeCallT2 !== null && (\n                                <p className=\"text-xs opacity-60\">Vol: {volumeCallT2.toLocaleString()}</p>\n                              )}\n                              {oiCallT2 !== null && (\n                                <p className=\"text-xs opacity-60\">OI: {oiCallT2.toLocaleString()}</p>\n                              )}\n                            </div>\n                            <div>\n                              <p className=\"text-xs opacity-75\">Spread</p>\n                              <p className=\"font-bold text-lg\">${result.callCalendarSpread}</p>\n                            </div>\n                          </div>\n                          <div className={`p-2 rounded text-xs opacity-75 mb-3`}>Max für FF +30%: <span className=\"font-bold\">${result.maxCallCalendarPrice30}</span></div>\n                          \n                          <div className=\"space-y-2\">\n                            <p className=\"text-xs font-semibold\">Preis-Simulator</p>\n                            <input\n                              type=\"range\"\n                              min=\"0\"\n                              max={parseFloat(result.callCalendarSpread) * 4}\n                              step=\"0.01\"\n                              defaultValue={result.callCalendarSpread}\n                              onChange={(e) => handlePriceSlider(parseFloat(e.target.value), true)}\n                              className=\"w-full h-2 bg-blue-300 rounded-lg appearance-none cursor-pointer\"\n                            />\n                            <div className=\"flex justify-between text-xs\">\n                              <span>${(parseFloat(result.maxCallCalendarPrice30)).toFixed(2)} (FF 30%)</span>\n                              <span className=\"font-bold\">${callPriceSlider !== null ? callPriceSlider.toFixed(2) : result.callCalendarSpread}</span>\n                              <span>${(parseFloat(result.callCalendarSpread) * 4).toFixed(2)} (max)</span>\n                            </div>\n                            {callPriceSlider !== null && adjustedFFCall !== null && (\n                              <div className={`p-2 rounded text-center text-sm font-bold border-2 ${\n                                adjustedFFCall >= 30 ? 'border-green-500 bg-green-200' : \n                                adjustedFFCall >= 16 ? 'border-yellow-500 bg-yellow-200' : \n                                'border-gray-400 bg-gray-200'\n                              }`}>\n                                Angepasster FF: {adjustedFFCall.toFixed(2)}%\n                              </div>\n                            )}\n                          </div>\n                        </div>\n\n                        <div className={`border-2 border-pink-500 p-4 rounded-lg ${darkMode ? 'bg-pink-900 text-pink-100' : 'bg-pink-50 text-pink-900'}`}>\n                          <p className=\"font-semibold mb-3\">Put Calendar Spread</p>\n                          <div className=\"grid grid-cols-3 gap-2 text-sm mb-3\">\n                            <div>\n                              <p className=\"text-xs opacity-75\">Front (T1)</p>\n                              <p className=\"font-bold\">${result.putT1}</p>\n                            </div>\n                            <div>\n                              <p className=\"text-xs opacity-75\">Back (T2)</p>\n                              <p className=\"font-bold\">${result.putT2}</p>\n                            </div>\n                            <div>\n                              <p className=\"text-xs opacity-75\">Spread</p>\n                              <p className=\"font-bold text-lg\">${result.putCalendarSpread}</p>\n                            </div>\n                          </div>\n                          <div className={`p-2 rounded text-xs opacity-75 mb-3`}>Max für FF +30%: <span className=\"font-bold\">${result.maxPutCalendarPrice30}</span></div>\n                          \n                          <div className=\"space-y-2\">\n                            <p className=\"text-xs font-semibold\">Preis-Simulator</p>\n                            <input\n                              type=\"range\"\n                              min=\"0\"\n                              max={parseFloat(result.putCalendarSpread) * 4}\n                              step=\"0.01\"\n                              defaultValue={result.putCalendarSpread}\n                              onChange={(e) => handlePriceSlider(parseFloat(e.target.value), false)}\n                              className=\"w-full h-2 bg-pink-300 rounded-lg appearance-none cursor-pointer\"\n                            />\n                            <div className=\"flex justify-between text-xs\">\n                              <span>${(parseFloat(result.maxPutCalendarPrice30)).toFixed(2)} (FF 30%)</span>\n                              <span className=\"font-bold\">${putPriceSlider !== null ? putPriceSlider.toFixed(2) : result.putCalendarSpread}</span>\n                              <span>${(parseFloat(result.putCalendarSpread) * 4).toFixed(2)} (max)</span>\n                            </div>\n                            {putPriceSlider !== null && adjustedFFPut !== null && (\n                              <div className={`p-2 rounded text-center text-sm font-bold border-2 ${\n                                adjustedFFPut >= 30 ? 'border-green-500 bg-green-200' : \n                                adjustedFFPut >= 16 ? 'border-yellow-500 bg-yellow-200' : \n                                'border-gray-400 bg-gray-200'\n                              }`}>\n                                Angepasster FF: {adjustedFFPut.toFixed(2)}%\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                      </div>\n\n                      <button\n                        onClick={exportCSV}\n                        className=\"w-full bg-slate-600 hover:bg-slate-700 text-white font-bold py-2 rounded-lg flex items-center justify-center gap-2\"\n                      >\n                        <Download size={20} /> Ergebnis als CSV exportieren\n                      </button>\n\n                      {tradeHistory.length > 0 && (\n                        <div className={`border-2 ${borderClass} p-4 rounded-lg`}>\n                          <p className=\"font-semibold mb-3\">Trade History (letzte 10)</p>\n                          <div className=\"text-sm space-y-2 max-h-96 overflow-y-auto\">\n                            {tradeHistory.map((trade, idx) => (\n                              <div key={idx} className={`p-3 rounded ${\n                                parseFloat(trade.ff) >= 30\n                                  ? darkMode ? 'bg-slate-800' : 'bg-slate-100'\n                                  : parseFloat(trade.ff) >= 16\n                                  ? darkMode ? 'bg-yellow-900' : 'bg-yellow-100'\n                                  : darkMode ? 'bg-gray-700' : 'bg-gray-100'\n                              }`}>\n                                <div className=\"flex items-center gap-2 font-semibold mb-2\">\n                                  {trade.ticker && trade.ticker !== 'N/A' && (\n                                    <>\n                                      <img\n                                        src={`https://img.logokit.com/ticker/${trade.ticker}?token=pk_fr93b6bfb5c425f6e3db62&format=png`}\n                                        alt={trade.ticker}\n                                        className=\"w-6 h-6 rounded object-contain\"\n                                        onError={(e) => {\n                                          e.target.style.display = 'none';\n                                          e.target.nextElementSibling.style.display = 'flex';\n                                        }}\n                                      />\n                                      <div className={`w-6 h-6 rounded-full hidden items-center justify-center text-xs font-bold text-white ${\n                                        trade.ticker[0] <= 'F' ? 'bg-blue-500' :\n                                        trade.ticker[0] <= 'L' ? 'bg-purple-500' :\n                                        trade.ticker[0] <= 'R' ? 'bg-green-500' :\n                                        trade.ticker[0] <= 'W' ? 'bg-orange-500' : 'bg-red-500'\n                                      }`}>\n                                        {trade.ticker[0]}\n                                      </div>\n                                    </>\n                                  )}\n                                  <span>{trade.ticker} - {trade.date} | FF: {trade.ff.toFixed(2)}%</span>\n                                </div>\n                                <div className=\"text-xs mt-1 space-y-1\">\n                                  <div>Aktuell: Call ${parseFloat(trade.callSpreadCurrent).toFixed(4)} | Put ${parseFloat(trade.putSpreadCurrent).toFixed(4)}</div>\n                                  <div>@ FF 30%: Call ${parseFloat(trade.callSpreadFF30).toFixed(4)} | Put ${parseFloat(trade.putSpreadFF30).toFixed(4)}</div>\n                                  <div>@ FF 0%: Call ${parseFloat(trade.callSpreadFF0).toFixed(4)} | Put ${parseFloat(trade.putSpreadFF0).toFixed(4)}</div>\n                                </div>\n                              </div>\n                            ))}\n                          </div>\n                        </div>\n                      )}\n                    </>\n                  )}\n                </>\n              )}\n            </div>\n\n            {/* Watchlist Sidebar */}\n            <div className=\"lg:col-span-1 space-y-4\">\n              <h2 className=\"text-lg font-bold mb-4\">Watchlist</h2>\n              \n              {watchlist.length === 0 ? (\n                <div className={`p-4 rounded-lg border-2 ${\n                  darkMode ? 'bg-gray-800 border-gray-700' : 'bg-gray-50 border-gray-200'\n                }`}>\n                  <p className=\"text-sm opacity-75 text-center\">\n                    Scan tickers to build your watchlist\n                  </p>\n          </div>\n              ) : (\n                <div className=\"space-y-2\">\n                  {watchlist.map((item, idx) => (\n                    <div\n                      key={idx}\n                      className={`w-full text-left p-3 rounded-lg border-2 transition-all hover:scale-[1.02] ${\n                        item.type === 'spread'\n                          ? darkMode\n                            ? 'bg-slate-800 border-slate-600'\n                            : 'bg-slate-50 border-slate-200'\n                          : ticker === item.symbol\n                          ? darkMode\n                            ? 'bg-blue-900 border-blue-500'\n                            : 'bg-blue-50 border-blue-500'\n                          : darkMode\n                            ? 'bg-gray-800 border-gray-700 hover:bg-gray-700'\n                            : 'bg-gray-50 border-gray-200 hover:bg-gray-100'\n                      }`}\n                    >\n                      {item.type === 'spread' ? (\n                        // Calendar Spread Watchlist Item\n                        <div>\n                          <div className=\"flex items-center gap-2 mb-2\">\n                            <span className=\"text-xs font-semibold bg-slate-500 text-white px-2 py-0.5 rounded\">\n                              SPREAD\n                            </span>\n                            <span className=\"font-bold\">{item.symbol}</span>\n        </div>\n                          \n                          <div className=\"text-sm mb-2\">\n                            {new Date(item.date1).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })} → {new Date(item.date2).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n      </div>\n                          \n                          <div className=\"flex items-center justify-between\">\n                            <div>\n                              <div className=\"text-xs opacity-75\">FF</div>\n                              <div className={`text-lg font-bold ${\n                                parseFloat(item.ff) >= 30\n                                  ? 'text-green-500'\n                                  : parseFloat(item.ff) >= 16\n                                  ? 'text-yellow-500'\n                                  : 'text-gray-500'\n                              }`}>\n                                {item.ff}%\n                              </div>\n                            </div>\n                            <div className=\"text-right\">\n                              <div className=\"text-xs opacity-75\">Strike</div>\n                              <div className=\"text-sm font-bold\">${item.strike}</div>\n                            </div>\n                          </div>\n                          \n                          <div className=\"text-xs mt-2 opacity-75 flex gap-2\">\n                            <span>IV: {item.iv1}% → {item.iv2}%</span>\n                            <span>DTE: {item.dte1} → {item.dte2}</span>\n                          </div>\n                        </div>\n                      ) : (\n                        // Stock Watchlist Item\n                        <button\n                          onClick={() => {\n                            setTicker(item.symbol);\n                            fetchOptionData(item.symbol);\n                          }}\n                          className=\"w-full text-left\"\n                        >\n                          <div className=\"flex items-center gap-2 mb-2\">\n                            <img\n                              src={`https://img.logokit.com/ticker/${item.symbol}?token=pk_fr93b6bfb5c425f6e3db62&format=png`}\n                              alt={item.symbol}\n                              className=\"w-6 h-6 rounded object-contain\"\n                              onError={(e) => {\n                                e.target.style.display = 'none';\n                              }}\n                            />\n                            <span className=\"font-bold\">{item.symbol}</span>\n                            {item.hasEarnings && (\n                              <span className=\"px-1.5 py-0.5 text-[10px] font-semibold rounded bg-yellow-500 text-black\" title=\"Has upcoming earnings\">\n                                📊\n                              </span>\n                            )}\n                          </div>\n                          \n                          {item.price && (\n                            <div className=\"text-sm mb-1\">\n                              ${parseFloat(item.price).toFixed(2)}\n                            </div>\n                          )}\n                          \n                          <div className=\"flex items-center justify-between\">\n                            <div>\n                              <div className=\"text-xs opacity-75\">Best FF</div>\n                              <div className={`text-lg font-bold ${\n                                parseFloat(item.bestFF) >= 30\n                                  ? 'text-green-500'\n                                  : parseFloat(item.bestFF) >= 16\n                                  ? 'text-yellow-500'\n                                  : 'text-gray-500'\n                              }`}>\n                                {item.bestFF}%\n                              </div>\n                            </div>\n                            \n                            {item.hasEarnings && item.earningsDate && (\n                              <div className=\"text-right\">\n                                <div className=\"text-xs opacity-75\">Earnings</div>\n                                <div className=\"text-xs font-semibold\">\n                                  {new Date(item.earningsDate).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                                </div>\n                              </div>\n                            )}\n                          </div>\n                        </button>\n                      )}\n                      \n                      <div className=\"text-[10px] opacity-50 mt-2\">\n                        {new Date(item.lastUpdated).toLocaleDateString('en-US', { month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' })}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n              \n              {watchlist.length > 0 && (\n                <button\n                  onClick={() => {\n                    setWatchlist([]);\n                    localStorage.removeItem('watchlist');\n                  }}\n                  className={`w-full px-3 py-2 text-xs rounded transition-all ${\n                    darkMode\n                      ? 'bg-gray-700 hover:bg-gray-600 text-gray-300'\n                      : 'bg-gray-200 hover:bg-gray-300 text-gray-700'\n                  }`}\n                >\n                  Clear Watchlist\n                </button>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Changelog */}\n      <div className=\"mt-12 max-w-[1800px] mx-auto px-6\">\n        <div className={`${cardClass} rounded-lg shadow-lg p-6`}>\n          <h2 className=\"text-2xl font-bold mb-4\">📝 Changelog</h2>\n          <div className=\"space-y-4\">\n            <div className=\"border-l-4 border-blue-500 pl-4\">\n              <h3 className=\"font-semibold text-blue-600\">Latest Updates</h3>\n              <ul className=\"text-sm mt-2 space-y-1\">\n                <li>• <strong>Enhanced Watchlist:</strong> Now supports both stocks and calendar spreads</li>\n                <li>• <strong>User Profiles:</strong> Separate watchlists for Nils and Mr. FF</li>\n                <li>• <strong>Market Scanner:</strong> On-demand scan for best FF opportunities (≥$500M market cap)</li>\n                <li>• <strong>Total Options Volume:</strong> Now shows complete options volume (puts + calls, all strikes)</li>\n                <li>• <strong>Post-Earnings Filter:</strong> Hide spreads with front expiration after earnings</li>\n                <li>• <strong>Wider Layout:</strong> Optimized for larger screens (1800px max-width)</li>\n              </ul>\n            </div>\n            \n            <div className=\"border-l-4 border-green-500 pl-4\">\n              <h3 className=\"font-semibold text-green-600\">Previous Features</h3>\n              <ul className=\"text-sm mt-2 space-y-1\">\n                <li>• <strong>Forward Volatility Calculator:</strong> Black-Scholes based FF calculations</li>\n                <li>• <strong>Earnings Integration:</strong> Finnhub API for upcoming earnings dates</li>\n                <li>• <strong>Calendar Spread Scanner:</strong> Automated spread recommendations</li>\n                <li>• <strong>Real-time Data:</strong> Polygon.io integration for live options data</li>\n                <li>• <strong>Dark Mode:</strong> Toggle between light and dark themes</li>\n                <li>• <strong>Recent Tickers:</strong> Quick access to recently viewed stocks</li>\n              </ul>\n            </div>\n            \n            <div className=\"border-l-4 border-purple-500 pl-4\">\n              <h3 className=\"font-semibold text-purple-600\">Technical Details</h3>\n              <ul className=\"text-sm mt-2 space-y-1\">\n                <li>• <strong>Built with:</strong> React, Tailwind CSS, Vercel Serverless Functions</li>\n                <li>• <strong>Data Sources:</strong> Polygon.io (options), Finnhub (earnings), Yahoo Finance (prices)</li>\n                <li>• <strong>Storage:</strong> LocalStorage for user preferences and watchlists</li>\n                <li>• <strong>Performance:</strong> 4-hour caching for market scans, non-blocking UI</li>\n                <li>• <strong>Forward Volatility:</strong> Based on SSRN research paper methodology</li>\n              </ul>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <Analytics /> \n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}